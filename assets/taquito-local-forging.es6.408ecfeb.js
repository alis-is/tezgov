import{P as I,d as Ut,e as kt,f as Gt,b as Ct,I as Kt,g as ft,h as lt,i as ut,v as Zt,V as $t,p as ht}from"./taquito-utils.es6.d10e4807.js";var Vt=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Ye=Math.ceil,ne=Math.floor,j="[BigNumber Error] ",nt=j+"Number primitive has more than 15 significant digits: ",te=1e14,N=14,je=9007199254740991,ze=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],fe=1e7,$=1e9;function At(e){var r,f,g,d=T.prototype={constructor:T,toString:null,valueOf:null},_=new T(1),P=20,R=4,S=-7,K=21,oe=-1e7,ee=1e7,pe=!1,Te=1,ae=0,Ke={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},de="0123456789abcdefghijklmnopqrstuvwxyz",Ze=!0;function T(t,n){var o,h,c,l,p,i,a,A,u=this;if(!(u instanceof T))return new T(t,n);if(n==null){if(t&&t._isBigNumber===!0){u.s=t.s,!t.c||t.e>ee?u.c=u.e=null:t.e<oe?u.c=[u.e=0]:(u.e=t.e,u.c=t.c.slice());return}if((i=typeof t=="number")&&t*0==0){if(u.s=1/t<0?(t=-t,-1):1,t===~~t){for(l=0,p=t;p>=10;p/=10,l++);l>ee?u.c=u.e=null:(u.e=l,u.c=[t]);return}A=String(t)}else{if(!Vt.test(A=String(t)))return g(u,A,i);u.s=A.charCodeAt(0)==45?(A=A.slice(1),-1):1}(l=A.indexOf("."))>-1&&(A=A.replace(".","")),(p=A.search(/e/i))>0?(l<0&&(l=p),l+=+A.slice(p+1),A=A.substring(0,p)):l<0&&(l=A.length)}else{if(k(n,2,de.length,"Base"),n==10&&Ze)return u=new T(t),z(u,P+u.e+1,R);if(A=String(t),i=typeof t=="number"){if(t*0!=0)return g(u,A,i,n);if(u.s=1/t<0?(A=A.slice(1),-1):1,T.DEBUG&&A.replace(/^0\.0*|\./,"").length>15)throw Error(nt+t)}else u.s=A.charCodeAt(0)===45?(A=A.slice(1),-1):1;for(o=de.slice(0,n),l=p=0,a=A.length;p<a;p++)if(o.indexOf(h=A.charAt(p))<0){if(h=="."){if(p>l){l=a;continue}}else if(!c&&(A==A.toUpperCase()&&(A=A.toLowerCase())||A==A.toLowerCase()&&(A=A.toUpperCase()))){c=!0,p=-1,l=0;continue}return g(u,String(t),i,n)}i=!1,A=f(A,n,10,u.s),(l=A.indexOf("."))>-1?A=A.replace(".",""):l=A.length}for(p=0;A.charCodeAt(p)===48;p++);for(a=A.length;A.charCodeAt(--a)===48;);if(A=A.slice(p,++a)){if(a-=p,i&&T.DEBUG&&a>15&&(t>je||t!==ne(t)))throw Error(nt+u.s*t);if((l=l-p-1)>ee)u.c=u.e=null;else if(l<oe)u.c=[u.e=0];else{if(u.e=l,u.c=[],p=(l+1)%N,l<0&&(p+=N),p<a){for(p&&u.c.push(+A.slice(0,p)),a-=N;p<a;)u.c.push(+A.slice(p,p+=N));p=N-(A=A.slice(p)).length}else p-=a;for(;p--;A+="0");u.c.push(+A)}}else u.c=[u.e=0]}T.clone=At,T.ROUND_UP=0,T.ROUND_DOWN=1,T.ROUND_CEIL=2,T.ROUND_FLOOR=3,T.ROUND_HALF_UP=4,T.ROUND_HALF_DOWN=5,T.ROUND_HALF_EVEN=6,T.ROUND_HALF_CEIL=7,T.ROUND_HALF_FLOOR=8,T.EUCLID=9,T.config=T.set=function(t){var n,o;if(t!=null)if(typeof t=="object"){if(t.hasOwnProperty(n="DECIMAL_PLACES")&&(o=t[n],k(o,0,$,n),P=o),t.hasOwnProperty(n="ROUNDING_MODE")&&(o=t[n],k(o,0,8,n),R=o),t.hasOwnProperty(n="EXPONENTIAL_AT")&&(o=t[n],o&&o.pop?(k(o[0],-$,0,n),k(o[1],0,$,n),S=o[0],K=o[1]):(k(o,-$,$,n),S=-(K=o<0?-o:o))),t.hasOwnProperty(n="RANGE"))if(o=t[n],o&&o.pop)k(o[0],-$,-1,n),k(o[1],1,$,n),oe=o[0],ee=o[1];else if(k(o,-$,$,n),o)oe=-(ee=o<0?-o:o);else throw Error(j+n+" cannot be zero: "+o);if(t.hasOwnProperty(n="CRYPTO"))if(o=t[n],o===!!o)if(o)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))pe=o;else throw pe=!o,Error(j+"crypto unavailable");else pe=o;else throw Error(j+n+" not true or false: "+o);if(t.hasOwnProperty(n="MODULO_MODE")&&(o=t[n],k(o,0,9,n),Te=o),t.hasOwnProperty(n="POW_PRECISION")&&(o=t[n],k(o,0,$,n),ae=o),t.hasOwnProperty(n="FORMAT"))if(o=t[n],typeof o=="object")Ke=o;else throw Error(j+n+" not an object: "+o);if(t.hasOwnProperty(n="ALPHABET"))if(o=t[n],typeof o=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(o))Ze=o.slice(0,10)=="0123456789",de=o;else throw Error(j+n+" invalid: "+o)}else throw Error(j+"Object expected: "+t);return{DECIMAL_PLACES:P,ROUNDING_MODE:R,EXPONENTIAL_AT:[S,K],RANGE:[oe,ee],CRYPTO:pe,MODULO_MODE:Te,POW_PRECISION:ae,FORMAT:Ke,ALPHABET:de}},T.isBigNumber=function(t){if(!t||t._isBigNumber!==!0)return!1;if(!T.DEBUG)return!0;var n,o,h=t.c,c=t.e,l=t.s;e:if({}.toString.call(h)=="[object Array]"){if((l===1||l===-1)&&c>=-$&&c<=$&&c===ne(c)){if(h[0]===0){if(c===0&&h.length===1)return!0;break e}if(n=(c+1)%N,n<1&&(n+=N),String(h[0]).length==n){for(n=0;n<h.length;n++)if(o=h[n],o<0||o>=te||o!==ne(o))break e;if(o!==0)return!0}}}else if(h===null&&c===null&&(l===null||l===1||l===-1))return!0;throw Error(j+"Invalid BigNumber: "+t)},T.maximum=T.max=function(){return rt(arguments,d.lt)},T.minimum=T.min=function(){return rt(arguments,d.gt)},T.random=function(){var t=9007199254740992,n=Math.random()*t&2097151?function(){return ne(Math.random()*t)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(o){var h,c,l,p,i,a=0,A=[],u=new T(_);if(o==null?o=P:k(o,0,$),p=Ye(o/N),pe)if(crypto.getRandomValues){for(h=crypto.getRandomValues(new Uint32Array(p*=2));a<p;)i=h[a]*131072+(h[a+1]>>>11),i>=9e15?(c=crypto.getRandomValues(new Uint32Array(2)),h[a]=c[0],h[a+1]=c[1]):(A.push(i%1e14),a+=2);a=p/2}else if(crypto.randomBytes){for(h=crypto.randomBytes(p*=7);a<p;)i=(h[a]&31)*281474976710656+h[a+1]*1099511627776+h[a+2]*4294967296+h[a+3]*16777216+(h[a+4]<<16)+(h[a+5]<<8)+h[a+6],i>=9e15?crypto.randomBytes(7).copy(h,a):(A.push(i%1e14),a+=7);a=p/7}else throw pe=!1,Error(j+"crypto unavailable");if(!pe)for(;a<p;)i=n(),i<9e15&&(A[a++]=i%1e14);for(p=A[--a],o%=N,p&&o&&(i=ze[N-o],A[a]=ne(p/i)*i);A[a]===0;A.pop(),a--);if(a<0)A=[l=0];else{for(l=-1;A[0]===0;A.splice(0,1),l-=N);for(a=1,i=A[0];i>=10;i/=10,a++);a<N&&(l-=N-a)}return u.e=l,u.c=A,u}}(),T.sum=function(){for(var t=1,n=arguments,o=new T(n[0]);t<n.length;)o=o.plus(n[t++]);return o},f=function(){var t="0123456789";function n(o,h,c,l){for(var p,i=[0],a,A=0,u=o.length;A<u;){for(a=i.length;a--;i[a]*=h);for(i[0]+=l.indexOf(o.charAt(A++)),p=0;p<i.length;p++)i[p]>c-1&&(i[p+1]==null&&(i[p+1]=0),i[p+1]+=i[p]/c|0,i[p]%=c)}return i.reverse()}return function(o,h,c,l,p){var i,a,A,u,E,m,O,w,G=o.indexOf("."),Z=P,L=R;for(G>=0&&(u=ae,ae=0,o=o.replace(".",""),w=new T(h),m=w.pow(o.length-G),ae=u,w.c=n(ie(W(m.c),m.e,"0"),10,c,t),w.e=w.c.length),O=n(o,h,c,p?(i=de,t):(i=t,de)),A=u=O.length;O[--u]==0;O.pop());if(!O[0])return i.charAt(0);if(G<0?--A:(m.c=O,m.e=A,m.s=l,m=r(m,w,Z,L,c),O=m.c,E=m.r,A=m.e),a=A+Z+1,G=O[a],u=c/2,E=E||a<0||O[a+1]!=null,E=L<4?(G!=null||E)&&(L==0||L==(m.s<0?3:2)):G>u||G==u&&(L==4||E||L==6&&O[a-1]&1||L==(m.s<0?8:7)),a<1||!O[0])o=E?ie(i.charAt(1),-Z,i.charAt(0)):i.charAt(0);else{if(O.length=a,E)for(--c;++O[--a]>c;)O[a]=0,a||(++A,O=[1].concat(O));for(u=O.length;!O[--u];);for(G=0,o="";G<=u;o+=i.charAt(O[G++]));o=ie(o,A,i.charAt(0))}return o}}(),r=function(){function t(h,c,l){var p,i,a,A,u=0,E=h.length,m=c%fe,O=c/fe|0;for(h=h.slice();E--;)a=h[E]%fe,A=h[E]/fe|0,p=O*a+A*m,i=m*a+p%fe*fe+u,u=(i/l|0)+(p/fe|0)+O*A,h[E]=i%l;return u&&(h=[u].concat(h)),h}function n(h,c,l,p){var i,a;if(l!=p)a=l>p?1:-1;else for(i=a=0;i<l;i++)if(h[i]!=c[i]){a=h[i]>c[i]?1:-1;break}return a}function o(h,c,l,p){for(var i=0;l--;)h[l]-=i,i=h[l]<c[l]?1:0,h[l]=i*p+h[l]-c[l];for(;!h[0]&&h.length>1;h.splice(0,1));}return function(h,c,l,p,i){var a,A,u,E,m,O,w,G,Z,L,b,F,be,Fe,Xe,re,_e,q=h.s==c.s?1:-1,Y=h.c,C=c.c;if(!Y||!Y[0]||!C||!C[0])return new T(!h.s||!c.s||(Y?C&&Y[0]==C[0]:!C)?NaN:Y&&Y[0]==0||!C?q*0:q/0);for(G=new T(q),Z=G.c=[],A=h.e-c.e,q=l+A+1,i||(i=te,A=v(h.e/N)-v(c.e/N),q=q/N|0),u=0;C[u]==(Y[u]||0);u++);if(C[u]>(Y[u]||0)&&A--,q<0)Z.push(1),E=!0;else{for(Fe=Y.length,re=C.length,u=0,q+=2,m=ne(i/(C[0]+1)),m>1&&(C=t(C,m,i),Y=t(Y,m,i),re=C.length,Fe=Y.length),be=re,L=Y.slice(0,re),b=L.length;b<re;L[b++]=0);_e=C.slice(),_e=[0].concat(_e),Xe=C[0],C[1]>=i/2&&Xe++;do{if(m=0,a=n(C,L,re,b),a<0){if(F=L[0],re!=b&&(F=F*i+(L[1]||0)),m=ne(F/Xe),m>1)for(m>=i&&(m=i-1),O=t(C,m,i),w=O.length,b=L.length;n(O,L,w,b)==1;)m--,o(O,re<w?_e:C,w,i),w=O.length,a=1;else m==0&&(a=m=1),O=C.slice(),w=O.length;if(w<b&&(O=[0].concat(O)),o(L,O,b,i),b=L.length,a==-1)for(;n(C,L,re,b)<1;)m++,o(L,re<b?_e:C,b,i),b=L.length}else a===0&&(m++,L=[0]);Z[u++]=m,L[0]?L[b++]=Y[be]||0:(L=[Y[be]],b=1)}while((be++<Fe||L[0]!=null)&&q--);E=L[0]!=null,Z[0]||Z.splice(0,1)}if(i==te){for(u=1,q=Z[0];q>=10;q/=10,u++);z(G,l+(G.e=u+A*N-1)+1,p,E)}else G.e=A,G.r=+E;return G}}();function $e(t,n,o,h){var c,l,p,i,a;if(o==null?o=R:k(o,0,8),!t.c)return t.toString();if(c=t.c[0],p=t.e,n==null)a=W(t.c),a=h==1||h==2&&(p<=S||p>=K)?He(a,p):ie(a,p,"0");else if(t=z(new T(t),n,o),l=t.e,a=W(t.c),i=a.length,h==1||h==2&&(n<=l||l<=S)){for(;i<n;a+="0",i++);a=He(a,l)}else if(n-=p,a=ie(a,l,"0"),l+1>i){if(--n>0)for(a+=".";n--;a+="0");}else if(n+=l-i,n>0)for(l+1==i&&(a+=".");n--;a+="0");return t.s<0&&c?"-"+a:a}function rt(t,n){for(var o,h=1,c=new T(t[0]);h<t.length;h++)if(o=new T(t[h]),o.s)n.call(c,o)&&(c=o);else{c=o;break}return c}function Ve(t,n,o){for(var h=1,c=n.length;!n[--c];n.pop());for(c=n[0];c>=10;c/=10,h++);return(o=h+o*N-1)>ee?t.c=t.e=null:o<oe?t.c=[t.e=0]:(t.e=o,t.c=n),t}g=function(){var t=/^(-?)0([xbo])(?=\w[\w.]*$)/i,n=/^([^.]+)\.$/,o=/^\.([^.]+)$/,h=/^-?(Infinity|NaN)$/,c=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(l,p,i,a){var A,u=i?p:p.replace(c,"");if(h.test(u))l.s=isNaN(u)?null:u<0?-1:1;else{if(!i&&(u=u.replace(t,function(E,m,O){return A=(O=O.toLowerCase())=="x"?16:O=="b"?2:8,!a||a==A?m:E}),a&&(A=a,u=u.replace(n,"$1").replace(o,"0.$1")),p!=u))return new T(u,A);if(T.DEBUG)throw Error(j+"Not a"+(a?" base "+a:"")+" number: "+p);l.s=null}l.c=l.e=null}}();function z(t,n,o,h){var c,l,p,i,a,A,u,E=t.c,m=ze;if(E){e:{for(c=1,i=E[0];i>=10;i/=10,c++);if(l=n-c,l<0)l+=N,p=n,a=E[A=0],u=a/m[c-p-1]%10|0;else if(A=Ye((l+1)/N),A>=E.length)if(h){for(;E.length<=A;E.push(0));a=u=0,c=1,l%=N,p=l-N+1}else break e;else{for(a=i=E[A],c=1;i>=10;i/=10,c++);l%=N,p=l-N+c,u=p<0?0:a/m[c-p-1]%10|0}if(h=h||n<0||E[A+1]!=null||(p<0?a:a%m[c-p-1]),h=o<4?(u||h)&&(o==0||o==(t.s<0?3:2)):u>5||u==5&&(o==4||h||o==6&&(l>0?p>0?a/m[c-p]:0:E[A-1])%10&1||o==(t.s<0?8:7)),n<1||!E[0])return E.length=0,h?(n-=t.e+1,E[0]=m[(N-n%N)%N],t.e=-n||0):E[0]=t.e=0,t;if(l==0?(E.length=A,i=1,A--):(E.length=A+1,i=m[N-l],E[A]=p>0?ne(a/m[c-p]%m[p])*i:0),h)for(;;)if(A==0){for(l=1,p=E[0];p>=10;p/=10,l++);for(p=E[0]+=i,i=1;p>=10;p/=10,i++);l!=i&&(t.e++,E[0]==te&&(E[0]=1));break}else{if(E[A]+=i,E[A]!=te)break;E[A--]=0,i=1}for(l=E.length;E[--l]===0;E.pop());}t.e>ee?t.c=t.e=null:t.e<oe&&(t.c=[t.e=0])}return t}function se(t){var n,o=t.e;return o===null?t.toString():(n=W(t.c),n=o<=S||o>=K?He(n,o):ie(n,o,"0"),t.s<0?"-"+n:n)}return d.absoluteValue=d.abs=function(){var t=new T(this);return t.s<0&&(t.s=1),t},d.comparedTo=function(t,n){return Ee(this,new T(t,n))},d.decimalPlaces=d.dp=function(t,n){var o,h,c,l=this;if(t!=null)return k(t,0,$),n==null?n=R:k(n,0,8),z(new T(l),t+l.e+1,n);if(!(o=l.c))return null;if(h=((c=o.length-1)-v(this.e/N))*N,c=o[c])for(;c%10==0;c/=10,h--);return h<0&&(h=0),h},d.dividedBy=d.div=function(t,n){return r(this,new T(t,n),P,R)},d.dividedToIntegerBy=d.idiv=function(t,n){return r(this,new T(t,n),0,1)},d.exponentiatedBy=d.pow=function(t,n){var o,h,c,l,p,i,a,A,u,E=this;if(t=new T(t),t.c&&!t.isInteger())throw Error(j+"Exponent not an integer: "+se(t));if(n!=null&&(n=new T(n)),i=t.e>14,!E.c||!E.c[0]||E.c[0]==1&&!E.e&&E.c.length==1||!t.c||!t.c[0])return u=new T(Math.pow(+se(E),i?2-De(t):+se(t))),n?u.mod(n):u;if(a=t.s<0,n){if(n.c?!n.c[0]:!n.s)return new T(NaN);h=!a&&E.isInteger()&&n.isInteger(),h&&(E=E.mod(n))}else{if(t.e>9&&(E.e>0||E.e<-1||(E.e==0?E.c[0]>1||i&&E.c[1]>=24e7:E.c[0]<8e13||i&&E.c[0]<=9999975e7)))return l=E.s<0&&De(t)?-0:0,E.e>-1&&(l=1/l),new T(a?1/l:l);ae&&(l=Ye(ae/N+2))}for(i?(o=new T(.5),a&&(t.s=1),A=De(t)):(c=Math.abs(+se(t)),A=c%2),u=new T(_);;){if(A){if(u=u.times(E),!u.c)break;l?u.c.length>l&&(u.c.length=l):h&&(u=u.mod(n))}if(c){if(c=ne(c/2),c===0)break;A=c%2}else if(t=t.times(o),z(t,t.e+1,1),t.e>14)A=De(t);else{if(c=+se(t),c===0)break;A=c%2}E=E.times(E),l?E.c&&E.c.length>l&&(E.c.length=l):h&&(E=E.mod(n))}return h?u:(a&&(u=_.div(u)),n?u.mod(n):l?z(u,ae,R,p):u)},d.integerValue=function(t){var n=new T(this);return t==null?t=R:k(t,0,8),z(n,n.e+1,t)},d.isEqualTo=d.eq=function(t,n){return Ee(this,new T(t,n))===0},d.isFinite=function(){return!!this.c},d.isGreaterThan=d.gt=function(t,n){return Ee(this,new T(t,n))>0},d.isGreaterThanOrEqualTo=d.gte=function(t,n){return(n=Ee(this,new T(t,n)))===1||n===0},d.isInteger=function(){return!!this.c&&v(this.e/N)>this.c.length-2},d.isLessThan=d.lt=function(t,n){return Ee(this,new T(t,n))<0},d.isLessThanOrEqualTo=d.lte=function(t,n){return(n=Ee(this,new T(t,n)))===-1||n===0},d.isNaN=function(){return!this.s},d.isNegative=function(){return this.s<0},d.isPositive=function(){return this.s>0},d.isZero=function(){return!!this.c&&this.c[0]==0},d.minus=function(t,n){var o,h,c,l,p=this,i=p.s;if(t=new T(t,n),n=t.s,!i||!n)return new T(NaN);if(i!=n)return t.s=-n,p.plus(t);var a=p.e/N,A=t.e/N,u=p.c,E=t.c;if(!a||!A){if(!u||!E)return u?(t.s=-n,t):new T(E?p:NaN);if(!u[0]||!E[0])return E[0]?(t.s=-n,t):new T(u[0]?p:R==3?-0:0)}if(a=v(a),A=v(A),u=u.slice(),i=a-A){for((l=i<0)?(i=-i,c=u):(A=a,c=E),c.reverse(),n=i;n--;c.push(0));c.reverse()}else for(h=(l=(i=u.length)<(n=E.length))?i:n,i=n=0;n<h;n++)if(u[n]!=E[n]){l=u[n]<E[n];break}if(l&&(c=u,u=E,E=c,t.s=-t.s),n=(h=E.length)-(o=u.length),n>0)for(;n--;u[o++]=0);for(n=te-1;h>i;){if(u[--h]<E[h]){for(o=h;o&&!u[--o];u[o]=n);--u[o],u[h]+=te}u[h]-=E[h]}for(;u[0]==0;u.splice(0,1),--A);return u[0]?Ve(t,u,A):(t.s=R==3?-1:1,t.c=[t.e=0],t)},d.modulo=d.mod=function(t,n){var o,h,c=this;return t=new T(t,n),!c.c||!t.s||t.c&&!t.c[0]?new T(NaN):!t.c||c.c&&!c.c[0]?new T(c):(Te==9?(h=t.s,t.s=1,o=r(c,t,0,3),t.s=h,o.s*=h):o=r(c,t,0,Te),t=c.minus(o.times(t)),!t.c[0]&&Te==1&&(t.s=c.s),t)},d.multipliedBy=d.times=function(t,n){var o,h,c,l,p,i,a,A,u,E,m,O,w,G,Z,L=this,b=L.c,F=(t=new T(t,n)).c;if(!b||!F||!b[0]||!F[0])return!L.s||!t.s||b&&!b[0]&&!F||F&&!F[0]&&!b?t.c=t.e=t.s=null:(t.s*=L.s,!b||!F?t.c=t.e=null:(t.c=[0],t.e=0)),t;for(h=v(L.e/N)+v(t.e/N),t.s*=L.s,a=b.length,E=F.length,a<E&&(w=b,b=F,F=w,c=a,a=E,E=c),c=a+E,w=[];c--;w.push(0));for(G=te,Z=fe,c=E;--c>=0;){for(o=0,m=F[c]%Z,O=F[c]/Z|0,p=a,l=c+p;l>c;)A=b[--p]%Z,u=b[p]/Z|0,i=O*A+u*m,A=m*A+i%Z*Z+w[l]+o,o=(A/G|0)+(i/Z|0)+O*u,w[l--]=A%G;w[l]=o}return o?++h:w.splice(0,1),Ve(t,w,h)},d.negated=function(){var t=new T(this);return t.s=-t.s||null,t},d.plus=function(t,n){var o,h=this,c=h.s;if(t=new T(t,n),n=t.s,!c||!n)return new T(NaN);if(c!=n)return t.s=-n,h.minus(t);var l=h.e/N,p=t.e/N,i=h.c,a=t.c;if(!l||!p){if(!i||!a)return new T(c/0);if(!i[0]||!a[0])return a[0]?t:new T(i[0]?h:c*0)}if(l=v(l),p=v(p),i=i.slice(),c=l-p){for(c>0?(p=l,o=a):(c=-c,o=i),o.reverse();c--;o.push(0));o.reverse()}for(c=i.length,n=a.length,c-n<0&&(o=a,a=i,i=o,n=c),c=0;n;)c=(i[--n]=i[n]+a[n]+c)/te|0,i[n]=te===i[n]?0:i[n]%te;return c&&(i=[c].concat(i),++p),Ve(t,i,p)},d.precision=d.sd=function(t,n){var o,h,c,l=this;if(t!=null&&t!==!!t)return k(t,1,$),n==null?n=R:k(n,0,8),z(new T(l),t,n);if(!(o=l.c))return null;if(c=o.length-1,h=c*N+1,c=o[c]){for(;c%10==0;c/=10,h--);for(c=o[0];c>=10;c/=10,h++);}return t&&l.e+1>h&&(h=l.e+1),h},d.shiftedBy=function(t){return k(t,-je,je),this.times("1e"+t)},d.squareRoot=d.sqrt=function(){var t,n,o,h,c,l=this,p=l.c,i=l.s,a=l.e,A=P+4,u=new T("0.5");if(i!==1||!p||!p[0])return new T(!i||i<0&&(!p||p[0])?NaN:p?l:1/0);if(i=Math.sqrt(+se(l)),i==0||i==1/0?(n=W(p),(n.length+a)%2==0&&(n+="0"),i=Math.sqrt(+n),a=v((a+1)/2)-(a<0||a%2),i==1/0?n="5e"+a:(n=i.toExponential(),n=n.slice(0,n.indexOf("e")+1)+a),o=new T(n)):o=new T(i+""),o.c[0]){for(a=o.e,i=a+A,i<3&&(i=0);;)if(c=o,o=u.times(c.plus(r(l,c,A,1))),W(c.c).slice(0,i)===(n=W(o.c)).slice(0,i))if(o.e<a&&--i,n=n.slice(i-3,i+1),n=="9999"||!h&&n=="4999"){if(!h&&(z(c,c.e+P+2,0),c.times(c).eq(l))){o=c;break}A+=4,i+=4,h=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(z(o,o.e+P+2,1),t=!o.times(o).eq(l));break}}return z(o,o.e+P+1,R,t)},d.toExponential=function(t,n){return t!=null&&(k(t,0,$),t++),$e(this,t,n,1)},d.toFixed=function(t,n){return t!=null&&(k(t,0,$),t=t+this.e+1),$e(this,t,n)},d.toFormat=function(t,n,o){var h,c=this;if(o==null)t!=null&&n&&typeof n=="object"?(o=n,n=null):t&&typeof t=="object"?(o=t,t=n=null):o=Ke;else if(typeof o!="object")throw Error(j+"Argument not an object: "+o);if(h=c.toFixed(t,n),c.c){var l,p=h.split("."),i=+o.groupSize,a=+o.secondaryGroupSize,A=o.groupSeparator||"",u=p[0],E=p[1],m=c.s<0,O=m?u.slice(1):u,w=O.length;if(a&&(l=i,i=a,a=l,w-=l),i>0&&w>0){for(l=w%i||i,u=O.substr(0,l);l<w;l+=i)u+=A+O.substr(l,i);a>0&&(u+=A+O.slice(l)),m&&(u="-"+u)}h=E?u+(o.decimalSeparator||"")+((a=+o.fractionGroupSize)?E.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(o.fractionGroupSeparator||"")):E):u}return(o.prefix||"")+h+(o.suffix||"")},d.toFraction=function(t){var n,o,h,c,l,p,i,a,A,u,E,m,O=this,w=O.c;if(t!=null&&(i=new T(t),!i.isInteger()&&(i.c||i.s!==1)||i.lt(_)))throw Error(j+"Argument "+(i.isInteger()?"out of range: ":"not an integer: ")+se(i));if(!w)return new T(O);for(n=new T(_),A=o=new T(_),h=a=new T(_),m=W(w),l=n.e=m.length-O.e-1,n.c[0]=ze[(p=l%N)<0?N+p:p],t=!t||i.comparedTo(n)>0?l>0?n:A:i,p=ee,ee=1/0,i=new T(m),a.c[0]=0;u=r(i,n,0,1),c=o.plus(u.times(h)),c.comparedTo(t)!=1;)o=h,h=c,A=a.plus(u.times(c=A)),a=c,n=i.minus(u.times(c=n)),i=c;return c=r(t.minus(o),h,0,1),a=a.plus(c.times(A)),o=o.plus(c.times(h)),a.s=A.s=O.s,l=l*2,E=r(A,h,l,R).minus(O).abs().comparedTo(r(a,o,l,R).minus(O).abs())<1?[A,h]:[a,o],ee=p,E},d.toNumber=function(){return+se(this)},d.toPrecision=function(t,n){return t!=null&&k(t,1,$),$e(this,t,n,2)},d.toString=function(t){var n,o=this,h=o.s,c=o.e;return c===null?h?(n="Infinity",h<0&&(n="-"+n)):n="NaN":(t==null?n=c<=S||c>=K?He(W(o.c),c):ie(W(o.c),c,"0"):t===10&&Ze?(o=z(new T(o),P+c+1,R),n=ie(W(o.c),o.e,"0")):(k(t,2,de.length,"Base"),n=f(ie(W(o.c),c,"0"),10,t,h,!0)),h<0&&o.c[0]&&(n="-"+n)),n},d.valueOf=d.toJSON=function(){return se(this)},d._isBigNumber=!0,d[Symbol.toStringTag]="BigNumber",d[Symbol.for("nodejs.util.inspect.custom")]=d.valueOf,e!=null&&T.set(e),T}function v(e){var r=e|0;return e>0||e===r?r:r-1}function W(e){for(var r,f,g=1,d=e.length,_=e[0]+"";g<d;){for(r=e[g++]+"",f=N-r.length;f--;r="0"+r);_+=r}for(d=_.length;_.charCodeAt(--d)===48;);return _.slice(0,d+1||1)}function Ee(e,r){var f,g,d=e.c,_=r.c,P=e.s,R=r.s,S=e.e,K=r.e;if(!P||!R)return null;if(f=d&&!d[0],g=_&&!_[0],f||g)return f?g?0:-R:P;if(P!=R)return P;if(f=P<0,g=S==K,!d||!_)return g?0:!d^f?1:-1;if(!g)return S>K^f?1:-1;for(R=(S=d.length)<(K=_.length)?S:K,P=0;P<R;P++)if(d[P]!=_[P])return d[P]>_[P]^f?1:-1;return S==K?0:S>K^f?1:-1}function k(e,r,f,g){if(e<r||e>f||e!==ne(e))throw Error(j+(g||"Argument")+(typeof e=="number"?e<r||e>f?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function De(e){var r=e.c.length-1;return v(e.e/N)==r&&e.c[r]%2!=0}function He(e,r){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(r<0?"e":"e+")+r}function ie(e,r,f){var g,d;if(r<0){for(d=f+".";++r;d+=f);e=d+e}else if(g=e.length,++r>g){for(d=f,r-=g;--r;d+=f);e+=d}else r<g&&(e=e.slice(0,r)+"."+e.slice(r));return e}var Pe=At();const ot=e=>e.reduce((r,f)=>r+f.toString(16).padStart(2,"0"),""),x=(e,r=8)=>e.toString(16).padStart(r,"0"),Ge=31;var s;(function(e){e.SECRET="secret",e.RAW="raw",e.TZ1="tz1",e.BRANCH="branch",e.ZARITH="zarith",e.PUBLIC_KEY="public_key",e.PKH="pkh",e.DELEGATE="delegate",e.SCRIPT="script",e.BALLOT_STATEMENT="ballotStmt",e.PROPOSAL="proposal",e.PROPOSAL_ARR="proposalArr",e.INT32="int32",e.INT16="int16",e.PARAMETERS="parameters",e.ADDRESS="address",e.VALUE="value",e.MANAGER="manager",e.BLOCK_PAYLOAD_HASH="blockPayloadHash",e.ENTRYPOINT="entrypoint",e.OPERATION="operation",e.OP_ACTIVATE_ACCOUNT="activate_account",e.OP_DELEGATION="delegation",e.OP_TRANSACTION="transaction",e.OP_ORIGINATION="origination",e.OP_BALLOT="ballot",e.OP_ENDORSEMENT="endorsement",e.OP_SEED_NONCE_REVELATION="seed_nonce_revelation",e.OP_REVEAL="reveal",e.OP_PROPOSALS="proposals",e.OP_REGISTER_GLOBAL_CONSTANT="register_global_constant",e.OP_TRANSFER_TICKET="transfer_ticket",e.OP_TX_ROLLUP_ORIGINATION="tx_rollup_origination",e.OP_TX_ROLLUP_SUBMIT_BATCH="tx_rollup_submit_batch",e.BURN_LIMIT="burn_limit",e.TX_ROLLUP_ORIGINATION_PARAM="tx_rollup_origination_param",e.TX_ROLLUP_ID="tx_rollup_id",e.TX_ROLLUP_BATCH_CONTENT="tx_rollup_batch_content"})(s||(s={}));const ce={"00":"parameter","01":"storage","02":"code","03":"False","04":"Elt","05":"Left","06":"None","07":"Pair","08":"Right","09":"Some","0a":"True","0b":"Unit","0c":"PACK","0d":"UNPACK","0e":"BLAKE2B","0f":"SHA256",10:"SHA512",11:"ABS",12:"ADD",13:"AMOUNT",14:"AND",15:"BALANCE",16:"CAR",17:"CDR",18:"CHECK_SIGNATURE",19:"COMPARE","1a":"CONCAT","1b":"CONS","1c":"CREATE_ACCOUNT","1d":"CREATE_CONTRACT","1e":"IMPLICIT_ACCOUNT","1f":"DIP",20:"DROP",21:"DUP",22:"EDIV",23:"EMPTY_MAP",24:"EMPTY_SET",25:"EQ",26:"EXEC",27:"FAILWITH",28:"GE",29:"GET","2a":"GT","2b":"HASH_KEY","2c":"IF","2d":"IF_CONS","2e":"IF_LEFT","2f":"IF_NONE",30:"INT",31:"LAMBDA",32:"LE",33:"LEFT",34:"LOOP",35:"LSL",36:"LSR",37:"LT",38:"MAP",39:"MEM","3a":"MUL","3b":"NEG","3c":"NEQ","3d":"NIL","3e":"NONE","3f":"NOT",40:"NOW",41:"OR",42:"PAIR",43:"PUSH",44:"RIGHT",45:"SIZE",46:"SOME",47:"SOURCE",48:"SENDER",49:"SELF","4a":"STEPS_TO_QUOTA","4b":"SUB","4c":"SWAP","4d":"TRANSFER_TOKENS","4e":"SET_DELEGATE","4f":"UNIT",50:"UPDATE",51:"XOR",52:"ITER",53:"LOOP_LEFT",54:"ADDRESS",55:"CONTRACT",56:"ISNAT",57:"CAST",58:"RENAME",59:"bool","5a":"contract","5b":"int","5c":"key","5d":"key_hash","5e":"lambda","5f":"list",60:"map",61:"big_map",62:"nat",63:"option",64:"or",65:"pair",66:"set",67:"signature",68:"string",69:"bytes","6a":"mutez","6b":"timestamp","6c":"unit","6d":"operation","6e":"address","6f":"SLICE",70:"DIG",71:"DUG",72:"EMPTY_BIG_MAP",73:"APPLY",74:"chain_id",75:"CHAIN_ID",76:"LEVEL",77:"SELF_ADDRESS",78:"never",79:"NEVER","7a":"UNPAIR","7b":"VOTING_POWER","7c":"TOTAL_VOTING_POWER","7d":"KECCAK","7e":"SHA3","7f":"PAIRING_CHECK",80:"bls12_381_g1",81:"bls12_381_g2",82:"bls12_381_fr",83:"sapling_state",84:"sapling_transaction",85:"SAPLING_EMPTY_STATE",86:"SAPLING_VERIFY_UPDATE",87:"ticket",88:"TICKET",89:"READ_TICKET","8a":"SPLIT_TICKET","8b":"JOIN_TICKETS","8c":"GET_AND_UPDATE","8d":"chest","8e":"chest_key","8f":"OPEN_CHEST",90:"VIEW",91:"view",92:"constant",93:"SUB_MUTEZ"},Ft=(()=>{const e={};return Object.keys(ce).forEach(r=>{e[ce[r]]=r}),e})(),qe={4:"activate_account",107:"reveal",110:"delegation",108:"transaction",109:"origination",6:"ballot",21:"endorsement",1:"seed_nonce_revelation",5:"proposals",111:"register_global_constant",150:"tx_rollup_origination",151:"tx_rollup_submit_batch",158:"transfer_ticket"},st=(()=>{const e={};return Object.keys(qe).forEach(r=>{const f=typeof r=="string"?parseInt(r,10):r;e[qe[f]]=x(f,2)}),e})(),Me={"00":"default","01":"root","02":"do","03":"set_delegate","04":"remove_delegate"},Ue=(()=>{const e={};return Object.keys(Me).forEach(r=>{e[Me[r]]=r}),e})();class Xt extends Error{constructor(r){super(r),this.message=r,this.name="InvalidBlockHashError"}}class it extends Error{constructor(r){super(r),this.message=r,this.name="InvalidOperationSchemaError"}}class We extends Error{constructor(r){super(`Oversized entrypoint: ${r}. The maximum length of entrypoint is ${Ge}`),this.entrypoint=r,this.name="OversizedEntryPointError"}}class Yt extends Error{constructor(r){super(`The ballot value '${r}' is invalid`),this.ballotValue=r,this.name="InvalidBallotValueError"}}class jt extends Error{constructor(r){super(`Failed to decode ballot value ${r}`),this.ballotValue=r,this.name="DecodeBallotValueError"}}class pt extends Error{constructor(r){super(`The hex string '${r}' is invalid`),this.hexString=r,this.name="InvalidHexStringError"}}class dt extends Error{constructor(r){super(`Failed to encode michelson value '${r}'`),this.value=r,this.name="UnexpectedMichelsonValueError"}}class gt extends Error{constructor(r){super(r),this.message=r,this.name="OperationDecodingError"}}class zt extends Error{constructor(r){super(r),this.message=r,this.name="OperationEncodingError"}}class qt extends Error{constructor(r){super(`The operation '${r}' is unsupported`),this.op=r,this.name="UnsupportedOperationError"}}class X{constructor(r,f=0){this.arr=r,this.offset=f}static fromHexString(r){const f=r.toLowerCase();if(/^(([a-f]|\d){2})*$/.test(f)){const g=new Uint8Array((f.match(/([a-z]|\d){2}/g)||[]).map(d=>parseInt(d,16)));return new X(g)}else throw new pt(f)}consume(r){const f=this.arr.subarray(this.offset,this.offset+r);return this.offset+=r,f}get(r){return this.arr[this.offset+r]}length(){return this.arr.length-this.offset}}const Et=e=>"prim"in e,Tt=e=>"bytes"in e&&typeof e.bytes=="string",_t=e=>"string"in e&&typeof e.string=="string",Pt=e=>"int"in e&&typeof e.int=="string",Wt=e=>{const r=ge(e.code),f=ge(e.storage);return`${x(r.length/2,8)}${r}${x(f.length/2,8)}${f}`},vt=e=>{const r=V(e),f=V(e);return{code:ue(new X(r)),storage:ue(new X(f))}},ge=e=>{if(Array.isArray(e)){const r=e.map(g=>ge(g)).join(""),f=r.length/2;return`02${x(f)}${r}`}else{if(Et(e))return Qt(e);if(Tt(e))return mt(e);if(_t(e))return Rt(e);if(Pt(e))return St(e)}throw new dt(e)},ue=e=>{const r=e.consume(1);switch(r[0]){case 10:return Ot(e);case 1:return Nt(e);case 0:return It(e);case 2:{const f=new X(V(e)),g=[];for(;f.length()>0;)g.push(ue(f));return g}default:return Jt(e,r)}},V=(e,r=4)=>{const f=e.consume(r),g=parseInt(Buffer.from(f).toString("hex"),16);return e.consume(g)},mt=e=>{if(!/^([A-Fa-f0-9]{2})*$/.test(e.bytes))throw new pt(e.bytes);const r=e.bytes.length/2;return`0a${x(r)}${e.bytes}`},Ot=e=>{const r=V(e);return{bytes:Buffer.from(r).toString("hex")}},Rt=e=>{const r=Buffer.from(e.string,"utf8").toString("hex"),f=r.length/2;return`01${x(f)}${r}`},Nt=e=>{const r=V(e);return{string:Buffer.from(r).toString("utf8")}},St=({int:e})=>{const r=new Pe(e,10),f=r.toString(2)[0]==="-"?"1":"0",g=r.toString(2).replace(/-/g,""),d=g.length<=6?6:(g.length-6)%7?g.length+7-(g.length-6)%7:g.length,P=g.padStart(d,"0").match(/\d{6,7}/g).reverse();return P[0]=f+P[0],`00${P.map((S,K)=>parseInt((K===P.length-1?"0":"1")+S,2).toString(16).padStart(2,"0")).join("")}`},It=e=>{let r=e.consume(1)[0];const f=[],g=1<<7;for(;r&g;)f.push(r),r=e.consume(1)[0];f.push(r);const d=!!(1<<6&f[0]);f[0]=f[0]&127;const _=f.map((R,S)=>R.toString(2).slice(S===0?-6:-7).padStart(S===0?6:7,"0")).reverse();let P=new Pe(_.join(""),2);return d&&(P=P.times(-1)),{int:P.toFixed()}},Qt=e=>{const r=+Array.isArray(e.annots),f=Array.isArray(e.args)?e.args.length:0,g=x(Math.min(2*f+r+3,9),2),d=Ft[e.prim];let _=(e.args||[]).map(R=>ge(R)).join("");const P=Array.isArray(e.annots)?Lt(e.annots):"";return e.prim==="LAMBDA"&&f&&(_=x(_.length/2)+_+x(0)),(e.prim==="pair"||e.prim==="Pair")&&f>2&&(_=P===""?x(_.length/2)+_+x(0):x(_.length/2)+_),e.prim==="view"&&e.args&&(_=x(_.length/2)+_+x(0)),`${g}${d}${_}${P}`},Jt=(e,r)=>{const f=(r[0]-3)%2===1;let g=Math.floor((r[0]-3)/2);const d=e.consume(1)[0].toString(16).padStart(2,"0"),_={prim:ce[d]};if(ce[d]==="LAMBDA"&&e.consume(4),ce[d]==="view")return g!=0?er(e,_):_;let P,R;(ce[d]==="pair"||ce[d]==="Pair")&&g>2&&(P=tr(e),g=0,R=ke(e));const S=new Array(g).fill(0).map(()=>ue(e));return ce[d]==="LAMBDA"&&e.consume(4),P?_.args=P:S.length&&(_.args=S),R&&R[0]!==""?_.annots=R:f&&(_.annots=ke(e)),_},er=(e,r)=>(e.consume(4),r.args=new Array(4).fill(0).map(()=>ue(e)),e.consume(4),r),tr=e=>{const r=new X(V(e)),f=[];for(;r.length()>0;)f.push(ue(r));return f},Lt=e=>{const r=e.map(g=>Buffer.from(g,"utf8").toString("hex")).join("20"),f=r.length/2;return`${x(f)}${r}`},ke=e=>{const r=e.consume(4),f=parseInt(Buffer.from(r).toString("hex"),16),g=e.consume(f);return Buffer.from(g).toString("hex").split("20").map(_=>Buffer.from(_,"hex").toString("utf8"))},Q=e=>r=>Ut(Buffer.from(kt(r,ht[e]))),J=e=>r=>{const f=r.consume(Gt[e]);return Ct(f,ht[e])},rr=J(I.TZ1),nr=J(I.B),ve=e=>{const r=e.consume(1);if(r[0]===0)return J(I.TZ1)(e);if(r[0]===1)return J(I.TZ2)(e);if(r[0]===2)return J(I.TZ3)(e)},or=Q(I.B),sr=Q(I.TZ1),ct=e=>e?"ff":"00",wt=e=>Q(I.P)(e),xt=e=>J(I.P)(e),ir=e=>{const r=[];for(e.consume(4);e.length()>0;)r.push(xt(e));return r},cr=e=>x(32*e.length)+e.map(r=>wt(r)).join(""),ar=e=>{switch(e){case"yay":return"00";case"nay":return"01";case"pass":return"02";default:throw new Yt(e)}},fr=e=>{const r=e.consume(1);switch(r[0]){case 0:return"yay";case 1:return"nay";case 2:return"pass";default:throw new jt(r[0].toString())}},lr=e=>e?ct(!0)+Qe(e):ct(!1),ur=e=>{const r=parseInt(String(e),10),f=[];for(let g=0;g<4;g++){const d=(4-(g+1))*8;f.push((r&255<<d)>>d)}return Buffer.from(f).toString("hex")},hr=e=>{const r=e.consume(4);let f=0;for(let g=0;g<r.length;g++)f=f|r[g]<<(r.length-(g+1))*8;return f},Ar=e=>{const r=parseInt(String(e),10),f=[];for(let g=0;g<2;g++){const d=(2-(g+1))*8;f.push((r&255<<d)>>d)}return Buffer.from(f).toString("hex")},pr=e=>{const r=e.consume(2);let f=0;for(let g=0;g<r.length;g++)f=f|r[g]<<(r.length-(g+1))*8;return f},dr=e=>e.consume(1)[0]===255,gr=e=>{if(dr(e))return ve(e)},Qe=e=>{switch(e.substr(0,3)){case I.TZ1:return"00"+Q(I.TZ1)(e);case I.TZ2:return"01"+Q(I.TZ2)(e);case I.TZ3:return"02"+Q(I.TZ3)(e);default:throw new Kt(e)}},Er=e=>{switch(e.substr(0,4)){case I.EDPK:return"00"+Q(I.EDPK)(e);case I.SPPK:return"01"+Q(I.SPPK)(e);case I.P2PK:return"02"+Q(I.P2PK)(e);default:throw new ft(e)}},Tr=e=>{switch(e.substr(0,3)){case I.TZ1:case I.TZ2:case I.TZ3:return"00"+Qe(e);case I.KT1:return"01"+Q(I.KT1)(e)+"00";default:throw new lt(e)}},_r=e=>{switch(e.consume(1)[0]){case 0:return J(I.EDPK)(e);case 1:return J(I.SPPK)(e);case 2:return J(I.P2PK)(e);default:throw new ft(e.toString())}},Pr=e=>{switch(e.consume(1)[0]){case 0:return ve(e);case 1:{const f=J(I.KT1)(e);return e.consume(1),f}default:throw new lt(e.toString())}},Bt=e=>{const r=[];let f=new Pe(e,10);if(f.isNaN())throw new TypeError(`Invalid zarith number ${e}`);for(;;)if(f.lt(128)){f.lt(16)&&r.push("0"),r.push(f.toString(16));break}else{let g=f.mod(128);f=f.minus(g),f=f.dividedBy(128),g=g.plus(128),r.push(g.toString(16))}return r.join("")},yt=e=>{let r=0;for(;r<e.length()&&(e.get(r)&128)!==0;)r+=1;let f=new Pe(0);for(let g=r;g>=0;g-=1){const d=e.get(g)&127;f=f.multipliedBy(128),f=f.plus(d)}return e.consume(r+1),new Pe(f).toString()},bt=e=>{const r=x(e.consume(1)[0],2);if(r in Me)return Me[r];{const f=V(e,1),g=Buffer.from(f).toString("utf8");if(g.length>Ge)throw new We(g);return g}},mr=e=>{if(e.consume(1)[0]!==0){const f=bt(e),g=V(e),d=ue(new X(g));return{entrypoint:f,value:d}}},Or=e=>{if(e in Ue)return`${Ue[e]}`;if(e.length>Ge)throw new We(e);return`ff${ge({string:e}).slice(8)}`},Rr=e=>{if(!e||e.entrypoint==="default"&&"prim"in e.value&&e.value.prim==="Unit")return"00";const r=Or(e.entrypoint),f=ge(e.value),g=(f.length/2).toString(16).padStart(8,"0");return`ff${r}${g}${f}`},Nr=e=>{const r=ge(e);return`${x(r.length/2)}${r}`},Sr=e=>{const r=V(e);return ue(new X(r))},Ir=Q(I.VH),Lr=J(I.VH),Ce={branch:s.BRANCH,contents:[s.OPERATION]},Oe={pkh:s.TZ1,secret:s.SECRET},Re={source:s.PKH,fee:s.ZARITH,counter:s.ZARITH,gas_limit:s.ZARITH,storage_limit:s.ZARITH,public_key:s.PUBLIC_KEY},Ne={source:s.PKH,fee:s.ZARITH,counter:s.ZARITH,gas_limit:s.ZARITH,storage_limit:s.ZARITH,delegate:s.DELEGATE},Se={source:s.PKH,fee:s.ZARITH,counter:s.ZARITH,gas_limit:s.ZARITH,storage_limit:s.ZARITH,amount:s.ZARITH,destination:s.ADDRESS,parameters:s.PARAMETERS},Ie={source:s.PKH,fee:s.ZARITH,counter:s.ZARITH,gas_limit:s.ZARITH,storage_limit:s.ZARITH,balance:s.ZARITH,delegate:s.DELEGATE,script:s.SCRIPT},Le={source:s.PKH,period:s.INT32,proposal:s.PROPOSAL,ballot:s.BALLOT_STATEMENT},we={slot:s.INT16,level:s.INT32,round:s.INT32,block_payload_hash:s.BLOCK_PAYLOAD_HASH},xe={level:s.INT32,nonce:s.RAW},Be={source:s.PKH,period:s.INT32,proposals:s.PROPOSAL_ARR},ye={source:s.PKH,fee:s.ZARITH,counter:s.ZARITH,gas_limit:s.ZARITH,storage_limit:s.ZARITH,value:s.VALUE},Dt=e=>r=>{if(!(r.kind in e)||!(r.kind in st))throw new ut(r.kind);return st[r.kind]+e[r.kind](r)},Ht=e=>r=>{const f=r.consume(1),g=qe[f[0]];if(g===void 0)throw new qt(f[0].toString());const d=e[g](r);if(typeof d!="object")throw new gt("Decoded invalid operation");return Object.assign({kind:g},d)},M=e=>r=>f=>Object.keys(r).reduce((d,_)=>{const P=r[_];if(f&&Array.isArray(P)){const R=e[P[0]],S=f[_];if(!Array.isArray(S))throw new zt(`Expected value to be Array ${JSON.stringify(S)}`);return d+S.reduce((K,oe)=>K+R(oe),"")}else{const R=e[P];return d+R(f[_])}},""),U=e=>r=>f=>Object.keys(r).reduce((d,_)=>{const P=r[_];if(Array.isArray(P)){const R=e[P[0]],S=[],K=f.length();for(;f.length()>0;)if(S.push(R(f)),K===f.length())throw new gt("Unable to decode value");return Object.assign(Object.assign({},d),{[_]:S})}else{const R=e[P],S=R(f);return typeof S<"u"?Object.assign(Object.assign({},d),{[_]:S}):Object.assign({},d)}},{}),D={[s.SECRET]:e=>ot(e.consume(20)),[s.RAW]:e=>ot(e.consume(32)),[s.TZ1]:rr,[s.BRANCH]:nr,[s.ZARITH]:yt,[s.PUBLIC_KEY]:_r,[s.PKH]:ve,[s.DELEGATE]:gr,[s.INT32]:hr,[s.SCRIPT]:vt,[s.BALLOT_STATEMENT]:fr,[s.PROPOSAL]:xt,[s.PROPOSAL_ARR]:ir,[s.PARAMETERS]:mr,[s.ADDRESS]:Pr,[s.VALUE]:Sr,[s.INT16]:pr,[s.BLOCK_PAYLOAD_HASH]:Lr};D[s.OPERATION]=Ht(D);D[s.OP_ACTIVATE_ACCOUNT]=e=>U(D)(Oe)(e);D[s.OP_DELEGATION]=e=>U(D)(Ne)(e);D[s.OP_TRANSACTION]=e=>U(D)(Se)(e);D[s.OP_ORIGINATION]=e=>U(D)(Ie)(e);D[s.OP_BALLOT]=e=>U(D)(Le)(e);D[s.OP_ENDORSEMENT]=e=>U(D)(we)(e);D[s.OP_SEED_NONCE_REVELATION]=e=>U(D)(xe)(e);D[s.OP_PROPOSALS]=e=>U(D)(Be)(e);D[s.OP_REVEAL]=e=>U(D)(Re)(e);D[s.OP_REGISTER_GLOBAL_CONSTANT]=e=>U(D)(ye)(e);D[s.MANAGER]=U(D)(Ce);const H={[s.SECRET]:e=>e,[s.RAW]:e=>e,[s.TZ1]:sr,[s.BRANCH]:or,[s.ZARITH]:Bt,[s.PUBLIC_KEY]:Er,[s.PKH]:Qe,[s.DELEGATE]:lr,[s.SCRIPT]:Wt,[s.BALLOT_STATEMENT]:ar,[s.PROPOSAL]:wt,[s.PROPOSAL_ARR]:cr,[s.INT32]:ur,[s.PARAMETERS]:Rr,[s.ADDRESS]:Tr,[s.VALUE]:Nr,[s.INT16]:Ar,[s.BLOCK_PAYLOAD_HASH]:Ir};H[s.OPERATION]=Dt(H);H[s.OP_ACTIVATE_ACCOUNT]=e=>M(H)(Oe)(e);H[s.OP_DELEGATION]=e=>M(H)(Ne)(e);H[s.OP_TRANSACTION]=e=>M(H)(Se)(e);H[s.OP_ORIGINATION]=e=>M(H)(Ie)(e);H[s.OP_BALLOT]=e=>M(H)(Le)(e);H[s.OP_ENDORSEMENT]=e=>M(H)(we)(e);H[s.OP_SEED_NONCE_REVELATION]=e=>M(H)(xe)(e);H[s.OP_PROPOSALS]=e=>M(H)(Be)(e);H[s.OP_REVEAL]=e=>M(H)(Re)(e);H[s.OP_REGISTER_GLOBAL_CONSTANT]=e=>M(H)(ye)(e);H[s.MANAGER]=M(H)(Ce);const Je={source:s.PKH,fee:s.ZARITH,counter:s.ZARITH,gas_limit:s.ZARITH,storage_limit:s.ZARITH,ticket_contents:s.VALUE,ticket_ty:s.VALUE,ticket_ticketer:s.ADDRESS,ticket_amount:s.ZARITH,destination:s.ADDRESS,entrypoint:s.ENTRYPOINT},et={source:s.PKH,fee:s.ZARITH,counter:s.ZARITH,gas_limit:s.ZARITH,storage_limit:s.ZARITH,tx_rollup_origination:s.TX_ROLLUP_ORIGINATION_PARAM},tt={source:s.PKH,fee:s.ZARITH,counter:s.ZARITH,gas_limit:s.ZARITH,storage_limit:s.ZARITH,rollup:s.TX_ROLLUP_ID,content:s.TX_ROLLUP_BATCH_CONTENT,burn_limit:s.BURN_LIMIT},Mt={activate_account:Oe,reveal:Re,delegation:Ne,transaction:Se,origination:Ie,ballot:Le,endorsement:we,seed_nonce_revelation:xe,proposals:Be,register_global_constant:ye,transfer_ticket:Je,tx_rollup_origination:et,tx_rollup_submit_batch:tt},wr=(e,r)=>r.filter(f=>!e.includes(f)),xr=(e,r)=>e.filter(f=>f!==r),Br=e=>Object.keys(Mt).includes(e),yr=e=>{const r=e.kind,f=Object.keys(e),g=xr(f,"kind"),d=Object.keys(Mt[r]);return wr(g,d)};var me;(function(e){e.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",e.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",e.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",e.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",e.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",e.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA",e.PsFLorena="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",e.PtGRANADs="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",e.PtHangz2="PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx",e.Psithaca2="Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A",e.PtJakart2="PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY",e.ProtoALpha="ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK"})(me||(me={}));const at={Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd:4,PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU:5,PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS:5,PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb:6,PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo:7,PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA:8,PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i:9,PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV:10,PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx:11,Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A:12,PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY:13,ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK:14};function br(e,r){return at[e]<at[r]}const le=Object.assign(Object.assign({},ce),{84:"sapling_transaction_deprecated",94:"tx_rollup_l2_address",95:"MIN_BLOCK_TIME",96:"sapling_transaction"}),Dr=(()=>{const e={};return Object.keys(le).forEach(r=>{e[le[r]]=r}),e})(),Hr=e=>{const r=he(e.code),f=he(e.storage);return`${x(r.length/2,8)}${r}${x(f.length/2,8)}${f}`},Mr=e=>{const r=V(e),f=V(e);return{code:Ae(new X(r)),storage:Ae(new X(f))}},he=e=>{if(Array.isArray(e)){const r=e.map(g=>he(g)).join(""),f=r.length/2;return`02${x(f)}${r}`}else{if(Et(e))return Ur(e);if(Tt(e))return mt(e);if(_t(e))return Rt(e);if(Pt(e))return St(e)}throw new dt("Unexpected value")},Ae=e=>{const r=e.consume(1);switch(r[0]){case 10:return Ot(e);case 1:return Nt(e);case 0:return It(e);case 2:{const f=new X(V(e)),g=[];for(;f.length()>0;)g.push(Ae(f));return g}default:return kr(e,r)}},Ur=e=>{const r=+Array.isArray(e.annots),f=Array.isArray(e.args)?e.args.length:0,g=x(Math.min(2*f+r+3,9),2),d=Dr[e.prim];let _=(e.args||[]).map(R=>he(R)).join("");const P=Array.isArray(e.annots)?Lt(e.annots):"";return e.prim==="LAMBDA"&&f&&(_=x(_.length/2)+_+x(0)),(e.prim==="pair"||e.prim==="Pair")&&f>2&&(_=P===""?x(_.length/2)+_+x(0):x(_.length/2)+_),e.prim==="view"&&e.args&&(_=x(_.length/2)+_+x(0)),`${g}${d}${_}${P}`},kr=(e,r)=>{const f=(r[0]-3)%2===1;let g=Math.floor((r[0]-3)/2);const d=e.consume(1)[0].toString(16).padStart(2,"0"),_={prim:le[d]};if(le[d]==="LAMBDA"&&e.consume(4),le[d]==="view")return g!=0?Gr(e,_):_;let P,R;(le[d]==="pair"||le[d]==="Pair")&&g>2&&(P=Cr(e),g=0,R=ke(e));const S=new Array(g).fill(0).map(()=>Ae(e));return le[d]==="LAMBDA"&&e.consume(4),P?_.args=P:S.length&&(_.args=S),R&&R[0]!==""?_.annots=R:f&&(_.annots=ke(e)),_},Gr=(e,r)=>(e.consume(4),r.args=new Array(4).fill(0).map(()=>Ae(e)),e.consume(4),r),Cr=e=>{const r=new X(V(e)),f=[];for(;r.length()>0;)f.push(Ae(r));return f},Kr=e=>{if(e.consume(1)[0]!==0){const f=bt(e),g=V(e),d=Ae(new X(g));return{entrypoint:f,value:d}}},Zr=e=>{const r=V(e);return Ae(new X(r))},$r=e=>{if(e in Ue)return`${Ue[e]}`;if(e.length>Ge)throw new We(e);return`ff${he({string:e}).slice(8)}`},Vr=e=>`${he({string:e}).slice(2)}`,Fr=e=>{const r=V(e);return Buffer.from(r).toString("utf8")},Xr=e=>{if(!e||e.entrypoint==="default"&&"prim"in e.value&&e.value.prim==="Unit")return"00";const r=$r(e.entrypoint),f=he(e.value),g=(f.length/2).toString(16).padStart(8,"0");return`ff${r}${g}${f}`},Yr=e=>{const r=he(e);return`${x(r.length/2)}${r}`},jr=e=>"",zr=e=>({}),qr=Q(I.TXR1),Wr=J(I.TXR1),vr=e=>`${x(e.length/2)}${e}`,Qr=e=>{const r=V(e);return Buffer.from(r).toString("hex")},Jr=e=>e?`ff${Bt(e)}`:"00",en=e=>{const r=e.consume(1);if(Buffer.from(r).toString("hex")!=="00")return yt(e)},B=Object.assign(Object.assign({},H),{[s.SCRIPT]:Hr,[s.PARAMETERS]:Xr,[s.VALUE]:Yr,[s.ENTRYPOINT]:Vr,[s.TX_ROLLUP_ORIGINATION_PARAM]:jr,[s.TX_ROLLUP_ID]:qr,[s.TX_ROLLUP_BATCH_CONTENT]:vr,[s.BURN_LIMIT]:Jr});B[s.OPERATION]=Dt(B);B[s.OP_ACTIVATE_ACCOUNT]=e=>M(B)(Oe)(e);B[s.OP_DELEGATION]=e=>M(B)(Ne)(e);B[s.OP_TRANSACTION]=e=>M(B)(Se)(e);B[s.OP_ORIGINATION]=e=>M(B)(Ie)(e);B[s.OP_BALLOT]=e=>M(B)(Le)(e);B[s.OP_ENDORSEMENT]=e=>M(B)(we)(e);B[s.OP_SEED_NONCE_REVELATION]=e=>M(B)(xe)(e);B[s.OP_PROPOSALS]=e=>M(B)(Be)(e);B[s.OP_REVEAL]=e=>M(B)(Re)(e);B[s.OP_REGISTER_GLOBAL_CONSTANT]=e=>M(B)(ye)(e);B[s.OP_TRANSFER_TICKET]=e=>M(B)(Je)(e);B[s.OP_TX_ROLLUP_ORIGINATION]=e=>M(B)(et)(e);B[s.OP_TX_ROLLUP_SUBMIT_BATCH]=e=>M(B)(tt)(e);B[s.MANAGER]=M(B)(Ce);const y=Object.assign(Object.assign({},D),{[s.SCRIPT]:Mr,[s.PARAMETERS]:Kr,[s.VALUE]:Zr,[s.ENTRYPOINT]:Fr,[s.TX_ROLLUP_ORIGINATION_PARAM]:zr,[s.TX_ROLLUP_ID]:Wr,[s.TX_ROLLUP_BATCH_CONTENT]:Qr,[s.BURN_LIMIT]:en});y[s.OPERATION]=Ht(y);y[s.OP_ACTIVATE_ACCOUNT]=e=>U(y)(Oe)(e);y[s.OP_DELEGATION]=e=>U(y)(Ne)(e);y[s.OP_TRANSACTION]=e=>U(y)(Se)(e);y[s.OP_ORIGINATION]=e=>U(y)(Ie)(e);y[s.OP_BALLOT]=e=>U(y)(Le)(e);y[s.OP_ENDORSEMENT]=e=>U(y)(we)(e);y[s.OP_SEED_NONCE_REVELATION]=e=>U(y)(xe)(e);y[s.OP_PROPOSALS]=e=>U(y)(Be)(e);y[s.OP_REVEAL]=e=>U(y)(Re)(e);y[s.OP_REGISTER_GLOBAL_CONSTANT]=e=>U(y)(ye)(e);y[s.OP_TRANSFER_TICKET]=e=>U(y)(Je)(e);y[s.OP_TX_ROLLUP_ORIGINATION]=e=>U(y)(et)(e);y[s.OP_TX_ROLLUP_SUBMIT_BATCH]=e=>U(y)(tt)(e);y[s.MANAGER]=U(y)(Ce);const tn=me.Psithaca2;function rn(e,r){return r===me.Psithaca2||br(r,me.Psithaca2)?{encoder:H[e],decoder:f=>{const g=X.fromHexString(f);return D[e](g)}}:{encoder:B[e],decoder:f=>{const g=X.fromHexString(f);return y[e](g)}}}class nn{constructor(r=tn){this.protocolHash=r,this.codec=rn(s.MANAGER,this.protocolHash)}forge(r){if(Zt(r.branch)!==$t.VALID)throw new Xt(`The block hash ${r.branch} is invalid`);for(const g of r.contents){if(!Br(g.kind))throw new ut(g.kind);const d=yr(g);if(d.length===1){if(g.kind==="delegation"&&d[0]==="delegate")continue;if(g.kind==="origination"&&d[0]==="delegate")continue;if(g.kind==="transaction"&&d[0]==="parameters")continue;if(g.kind==="tx_rollup_submit_batch"&&d[0]==="burn_limit")continue;throw new it(`Missing properties: ${d.join(", ").toString()}`)}else if(d.length>1)throw new it(`Missing properties: ${d.join(", ").toString()}`)}const f=this.codec.encoder(r).toLowerCase();return Promise.resolve(f)}parse(r){return Promise.resolve(this.codec.decoder(r))}}const sn=new nn;export{Pe as B,nn as L,sn as l};
