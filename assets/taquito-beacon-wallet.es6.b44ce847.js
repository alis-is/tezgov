import{D as m,P as y}from"./DAppClient.a4cfd41c.js";import{c as v,a as p,b as w}from"./taquito.es6.61e4432c.js";import"./index.011cf840.js";import"./main.1aec21e3.js";import"./taquito-utils.es6.f2deb219.js";function r(a,e,t,i){function o(s){return s instanceof t?s:new t(function(c){c(s)})}return new(t||(t=Promise))(function(s,c){function h(n){try{l(i.next(n))}catch(d){c(d)}}function f(n){try{l(i.throw(n))}catch(d){c(d)}}function l(n){n.done?s(n.value):o(n.value).then(h,f)}l((i=i.apply(a,e||[])).next())})}const D={commitHash:"6d90b3d5e616a6e9b9ad9dd8453b5068e7396fff",version:"13.0.1"};class u extends Error{constructor(){super("You need to initialize BeaconWallet by calling beaconWallet.requestPermissions first"),this.name="BeaconWalletNotInitialized"}}class P extends Error{constructor(e){super(`Required permissions scopes were not granted: ${e.join(",")}`),this.requiredScopes=e,this.name="MissingRequiredScopes"}}class L{constructor(e){this.client=new m(e)}validateRequiredScopesOrFail(e,t){const i=new Set(t);for(const o of e)i.has(o)&&i.delete(o);if(i.size>0)throw new P(Array.from(i))}requestPermissions(e){return r(this,void 0,void 0,function*(){yield this.client.requestPermissions(e)})}getPKH(){return r(this,void 0,void 0,function*(){const e=yield this.client.getActiveAccount();if(!e)throw new u;return e.address})}mapTransferParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield v(this.formatParameters(t)))})}mapOriginateParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield p(this.formatParameters(t)))})}mapDelegateParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield w(this.formatParameters(t)))})}formatParameters(e){return e.fee&&(e.fee=e.fee.toString()),e.storageLimit&&(e.storageLimit=e.storageLimit.toString()),e.gasLimit&&(e.gasLimit=e.gasLimit.toString()),e}removeDefaultParams(e,t){return e.fee||delete t.fee,e.storageLimit||delete t.storage_limit,e.gasLimit||delete t.gas_limit,t}sendOperations(e){return r(this,void 0,void 0,function*(){const t=yield this.client.getActiveAccount();if(!t)throw new u;const i=t.scopes;this.validateRequiredScopesOrFail(i,[y.OPERATION_REQUEST]);const{transactionHash:o}=yield this.client.requestOperation({operationDetails:e});return o})}disconnect(){return r(this,void 0,void 0,function*(){yield this.client.destroy()})}clearActiveAccount(){return r(this,void 0,void 0,function*(){yield this.client.setActiveAccount()})}}export{L as BeaconWallet,u as BeaconWalletNotInitialized,P as MissingRequiredScopes,D as VERSION};
