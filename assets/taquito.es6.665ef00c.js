import{K as ru}from"./main.08ae0a6c.js";import{v as pt,V as U,k as bt,l as xr,n as nu,o as zi,q as iu,r as $s,s as su,u as ou,P as j,c as ia,p as us,w as ks,e as ls,x as au,y as sa,f as cu,z as uu,b as lu,I as hs,A as oa,B as nr,C as hu,D as Pn,E as fu,F as aa,G as ca,H as ua,J as pu}from"./taquito-utils.es6.cecc5b7d.js";var la={exports:{}},fs={exports:{}},ha=function(t,e){return function(){for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];return t.apply(e,i)}},du=ha,lr=Object.prototype.toString;function ps(r){return Array.isArray(r)}function Wi(r){return typeof r>"u"}function gu(r){return r!==null&&!Wi(r)&&r.constructor!==null&&!Wi(r.constructor)&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function fa(r){return lr.call(r)==="[object ArrayBuffer]"}function mu(r){return lr.call(r)==="[object FormData]"}function yu(r){var t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&fa(r.buffer),t}function bu(r){return typeof r=="string"}function Eu(r){return typeof r=="number"}function pa(r){return r!==null&&typeof r=="object"}function Tn(r){if(lr.call(r)!=="[object Object]")return!1;var t=Object.getPrototypeOf(r);return t===null||t===Object.prototype}function vu(r){return lr.call(r)==="[object Date]"}function wu(r){return lr.call(r)==="[object File]"}function Au(r){return lr.call(r)==="[object Blob]"}function da(r){return lr.call(r)==="[object Function]"}function _u(r){return pa(r)&&da(r.pipe)}function Ou(r){return lr.call(r)==="[object URLSearchParams]"}function Ru(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function Su(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function ds(r,t){if(!(r===null||typeof r>"u"))if(typeof r!="object"&&(r=[r]),ps(r))for(var e=0,n=r.length;e<n;e++)t.call(null,r[e],e,r);else for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.call(null,r[i],i,r)}function Yi(){var r={};function t(i,s){Tn(r[s])&&Tn(i)?r[s]=Yi(r[s],i):Tn(i)?r[s]=Yi({},i):ps(i)?r[s]=i.slice():r[s]=i}for(var e=0,n=arguments.length;e<n;e++)ds(arguments[e],t);return r}function Pu(r,t,e){return ds(t,function(i,s){e&&typeof i=="function"?r[s]=du(i,e):r[s]=i}),r}function Tu(r){return r.charCodeAt(0)===65279&&(r=r.slice(1)),r}var Dt={isArray:ps,isArrayBuffer:fa,isBuffer:gu,isFormData:mu,isArrayBufferView:yu,isString:bu,isNumber:Eu,isObject:pa,isPlainObject:Tn,isUndefined:Wi,isDate:vu,isFile:wu,isBlob:Au,isFunction:da,isStream:_u,isURLSearchParams:Ou,isStandardBrowserEnv:Su,forEach:ds,merge:Yi,extend:Pu,trim:Ru,stripBOM:Tu},Or=Dt;function js(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var ga=function(t,e,n){if(!e)return t;var i;if(n)i=n(e);else if(Or.isURLSearchParams(e))i=e.toString();else{var s=[];Or.forEach(e,function(l,m){l===null||typeof l>"u"||(Or.isArray(l)?m=m+"[]":l=[l],Or.forEach(l,function(v){Or.isDate(v)?v=v.toISOString():Or.isObject(v)&&(v=JSON.stringify(v)),s.push(js(m)+"="+js(v))}))}),i=s.join("&")}if(i){var o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t},Iu=Dt;function ei(){this.handlers=[]}ei.prototype.use=function(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};ei.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};ei.prototype.forEach=function(t){Iu.forEach(this.handlers,function(n){n!==null&&t(n)})};var Nu=ei,xu=Dt,Lu=function(t,e){xu.forEach(t,function(i,s){s!==e&&s.toUpperCase()===e.toUpperCase()&&(t[e]=i,delete t[s])})},ma=function(t,e,n,i,s){return t.config=e,n&&(t.code=n),t.request=i,t.response=s,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t},ya={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gi,Vs;function ba(){if(Vs)return gi;Vs=1;var r=ma;return gi=function(e,n,i,s,o){var c=new Error(e);return r(c,n,i,s,o)},gi}var mi,Hs;function Cu(){if(Hs)return mi;Hs=1;var r=ba();return mi=function(e,n,i){var s=i.config.validateStatus;!i.status||!s||s(i.status)?e(i):n(r("Request failed with status code "+i.status,i.config,null,i.request,i))},mi}var yi,Us;function Mu(){if(Us)return yi;Us=1;var r=Dt;return yi=r.isStandardBrowserEnv()?function(){return{write:function(n,i,s,o,c,l){var m=[];m.push(n+"="+encodeURIComponent(i)),r.isNumber(s)&&m.push("expires="+new Date(s).toGMTString()),r.isString(o)&&m.push("path="+o),r.isString(c)&&m.push("domain="+c),l===!0&&m.push("secure"),document.cookie=m.join("; ")},read:function(n){var i=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),yi}var bi,Fs;function Bu(){return Fs||(Fs=1,bi=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}),bi}var Ei,Gs;function Du(){return Gs||(Gs=1,Ei=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}),Ei}var vi,Ks;function $u(){if(Ks)return vi;Ks=1;var r=Bu(),t=Du();return vi=function(n,i){return n&&!r(i)?t(n,i):i},vi}var wi,qs;function ku(){if(qs)return wi;qs=1;var r=Dt,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return wi=function(n){var i={},s,o,c;return n&&r.forEach(n.split(`
`),function(m){if(c=m.indexOf(":"),s=r.trim(m.substr(0,c)).toLowerCase(),o=r.trim(m.substr(c+1)),s){if(i[s]&&t.indexOf(s)>=0)return;s==="set-cookie"?i[s]=(i[s]?i[s]:[]).concat([o]):i[s]=i[s]?i[s]+", "+o:o}}),i},wi}var Ai,zs;function ju(){if(zs)return Ai;zs=1;var r=Dt;return Ai=r.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),i;function s(o){var c=o;return e&&(n.setAttribute("href",c),c=n.href),n.setAttribute("href",c),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return i=s(window.location.href),function(c){var l=r.isString(c)?s(c):c;return l.protocol===i.protocol&&l.host===i.host}}():function(){return function(){return!0}}(),Ai}var _i,Ws;function ri(){if(Ws)return _i;Ws=1;function r(t){this.message=t}return r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,_i=r,_i}var Oi,Ys;function Js(){if(Ys)return Oi;Ys=1;var r=Dt,t=Cu(),e=Mu(),n=ga,i=$u(),s=ku(),o=ju(),c=ba(),l=ya,m=ri();return Oi=function(v){return new Promise(function(T,D){var W=v.data,C=v.headers,L=v.responseType,_;function nt(){v.cancelToken&&v.cancelToken.unsubscribe(_),v.signal&&v.signal.removeEventListener("abort",_)}r.isFormData(W)&&delete C["Content-Type"];var B=new XMLHttpRequest;if(v.auth){var Ge=v.auth.username||"",Rt=v.auth.password?unescape(encodeURIComponent(v.auth.password)):"";C.Authorization="Basic "+btoa(Ge+":"+Rt)}var ht=i(v.baseURL,v.url);B.open(v.method.toUpperCase(),n(ht,v.params,v.paramsSerializer),!0),B.timeout=v.timeout;function h(){if(!!B){var u="getAllResponseHeaders"in B?s(B.getAllResponseHeaders()):null,b=!L||L==="text"||L==="json"?B.responseText:B.response,d={data:b,status:B.status,statusText:B.statusText,headers:u,config:v,request:B};t(function(O){T(O),nt()},function(O){D(O),nt()},d),B=null}}if("onloadend"in B?B.onloadend=h:B.onreadystatechange=function(){!B||B.readyState!==4||B.status===0&&!(B.responseURL&&B.responseURL.indexOf("file:")===0)||setTimeout(h)},B.onabort=function(){!B||(D(c("Request aborted",v,"ECONNABORTED",B)),B=null)},B.onerror=function(){D(c("Network Error",v,null,B)),B=null},B.ontimeout=function(){var b=v.timeout?"timeout of "+v.timeout+"ms exceeded":"timeout exceeded",d=v.transitional||l;v.timeoutErrorMessage&&(b=v.timeoutErrorMessage),D(c(b,v,d.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",B)),B=null},r.isStandardBrowserEnv()){var p=(v.withCredentials||o(ht))&&v.xsrfCookieName?e.read(v.xsrfCookieName):void 0;p&&(C[v.xsrfHeaderName]=p)}"setRequestHeader"in B&&r.forEach(C,function(b,d){typeof W>"u"&&d.toLowerCase()==="content-type"?delete C[d]:B.setRequestHeader(d,b)}),r.isUndefined(v.withCredentials)||(B.withCredentials=!!v.withCredentials),L&&L!=="json"&&(B.responseType=v.responseType),typeof v.onDownloadProgress=="function"&&B.addEventListener("progress",v.onDownloadProgress),typeof v.onUploadProgress=="function"&&B.upload&&B.upload.addEventListener("progress",v.onUploadProgress),(v.cancelToken||v.signal)&&(_=function(u){!B||(D(!u||u&&u.type?new m("canceled"):u),B.abort(),B=null)},v.cancelToken&&v.cancelToken.subscribe(_),v.signal&&(v.signal.aborted?_():v.signal.addEventListener("abort",_))),W||(W=null),B.send(W)})},Oi}var St=Dt,Xs=Lu,Vu=ma,Hu=ya,Uu={"Content-Type":"application/x-www-form-urlencoded"};function Zs(r,t){!St.isUndefined(r)&&St.isUndefined(r["Content-Type"])&&(r["Content-Type"]=t)}function Fu(){var r;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(r=Js()),r}function Gu(r,t,e){if(St.isString(r))try{return(t||JSON.parse)(r),St.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(r)}var ni={transitional:Hu,adapter:Fu(),transformRequest:[function(t,e){return Xs(e,"Accept"),Xs(e,"Content-Type"),St.isFormData(t)||St.isArrayBuffer(t)||St.isBuffer(t)||St.isStream(t)||St.isFile(t)||St.isBlob(t)?t:St.isArrayBufferView(t)?t.buffer:St.isURLSearchParams(t)?(Zs(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):St.isObject(t)||e&&e["Content-Type"]==="application/json"?(Zs(e,"application/json"),Gu(t)):t}],transformResponse:[function(t){var e=this.transitional||ni.transitional,n=e&&e.silentJSONParsing,i=e&&e.forcedJSONParsing,s=!n&&this.responseType==="json";if(s||i&&St.isString(t)&&t.length)try{return JSON.parse(t)}catch(o){if(s)throw o.name==="SyntaxError"?Vu(o,this,"E_JSON_PARSE"):o}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};St.forEach(["delete","get","head"],function(t){ni.headers[t]={}});St.forEach(["post","put","patch"],function(t){ni.headers[t]=St.merge(Uu)});var gs=ni,Ku=Dt,qu=gs,zu=function(t,e,n){var i=this||qu;return Ku.forEach(n,function(o){t=o.call(i,t,e)}),t},Ri,Qs;function Ea(){return Qs||(Qs=1,Ri=function(t){return!!(t&&t.__CANCEL__)}),Ri}var to=Dt,Si=zu,Wu=Ea(),Yu=gs,Ju=ri();function Pi(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Ju("canceled")}var Xu=function(t){Pi(t),t.headers=t.headers||{},t.data=Si.call(t,t.data,t.headers,t.transformRequest),t.headers=to.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),to.forEach(["delete","get","head","post","put","patch","common"],function(i){delete t.headers[i]});var e=t.adapter||Yu.adapter;return e(t).then(function(i){return Pi(t),i.data=Si.call(t,i.data,i.headers,t.transformResponse),i},function(i){return Wu(i)||(Pi(t),i&&i.response&&(i.response.data=Si.call(t,i.response.data,i.response.headers,t.transformResponse))),Promise.reject(i)})},$t=Dt,va=function(t,e){e=e||{};var n={};function i(y,v){return $t.isPlainObject(y)&&$t.isPlainObject(v)?$t.merge(y,v):$t.isPlainObject(v)?$t.merge({},v):$t.isArray(v)?v.slice():v}function s(y){if($t.isUndefined(e[y])){if(!$t.isUndefined(t[y]))return i(void 0,t[y])}else return i(t[y],e[y])}function o(y){if(!$t.isUndefined(e[y]))return i(void 0,e[y])}function c(y){if($t.isUndefined(e[y])){if(!$t.isUndefined(t[y]))return i(void 0,t[y])}else return i(void 0,e[y])}function l(y){if(y in e)return i(t[y],e[y]);if(y in t)return i(void 0,t[y])}var m={url:o,method:o,data:o,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:l};return $t.forEach(Object.keys(t).concat(Object.keys(e)),function(v){var P=m[v]||s,T=P(v);$t.isUndefined(T)&&P!==l||(n[v]=T)}),n},Ti,eo;function wa(){return eo||(eo=1,Ti={version:"0.26.1"}),Ti}var Zu=wa().version,ms={};["object","boolean","number","function","string","symbol"].forEach(function(r,t){ms[r]=function(n){return typeof n===r||"a"+(t<1?"n ":" ")+r}});var ro={};ms.transitional=function(t,e,n){function i(s,o){return"[Axios v"+Zu+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return function(s,o,c){if(t===!1)throw new Error(i(o," has been removed"+(e?" in "+e:"")));return e&&!ro[o]&&(ro[o]=!0,console.warn(i(o," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(s,o,c):!0}};function Qu(r,t,e){if(typeof r!="object")throw new TypeError("options must be an object");for(var n=Object.keys(r),i=n.length;i-- >0;){var s=n[i],o=t[s];if(o){var c=r[s],l=c===void 0||o(c,s,r);if(l!==!0)throw new TypeError("option "+s+" must be "+l);continue}if(e!==!0)throw Error("Unknown option "+s)}}var tl={assertOptions:Qu,validators:ms},Aa=Dt,el=ga,no=Nu,io=Xu,ii=va,_a=tl,Rr=_a.validators;function en(r){this.defaults=r,this.interceptors={request:new no,response:new no}}en.prototype.request=function(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=ii(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var n=e.transitional;n!==void 0&&_a.assertOptions(n,{silentJSONParsing:Rr.transitional(Rr.boolean),forcedJSONParsing:Rr.transitional(Rr.boolean),clarifyTimeoutError:Rr.transitional(Rr.boolean)},!1);var i=[],s=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(e)===!1||(s=s&&T.synchronous,i.unshift(T.fulfilled,T.rejected))});var o=[];this.interceptors.response.forEach(function(T){o.push(T.fulfilled,T.rejected)});var c;if(!s){var l=[io,void 0];for(Array.prototype.unshift.apply(l,i),l=l.concat(o),c=Promise.resolve(e);l.length;)c=c.then(l.shift(),l.shift());return c}for(var m=e;i.length;){var y=i.shift(),v=i.shift();try{m=y(m)}catch(P){v(P);break}}try{c=io(m)}catch(P){return Promise.reject(P)}for(;o.length;)c=c.then(o.shift(),o.shift());return c};en.prototype.getUri=function(t){return t=ii(this.defaults,t),el(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")};Aa.forEach(["delete","get","head","options"],function(t){en.prototype[t]=function(e,n){return this.request(ii(n||{},{method:t,url:e,data:(n||{}).data}))}});Aa.forEach(["post","put","patch"],function(t){en.prototype[t]=function(e,n,i){return this.request(ii(i||{},{method:t,url:e,data:n}))}});var rl=en,Ii,so;function nl(){if(so)return Ii;so=1;var r=ri();function t(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var n;this.promise=new Promise(function(o){n=o});var i=this;this.promise.then(function(s){if(!!i._listeners){var o,c=i._listeners.length;for(o=0;o<c;o++)i._listeners[o](s);i._listeners=null}}),this.promise.then=function(s){var o,c=new Promise(function(l){i.subscribe(l),o=l}).then(s);return c.cancel=function(){i.unsubscribe(o)},c},e(function(o){i.reason||(i.reason=new r(o),n(i.reason))})}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]},t.prototype.unsubscribe=function(n){if(!!this._listeners){var i=this._listeners.indexOf(n);i!==-1&&this._listeners.splice(i,1)}},t.source=function(){var n,i=new t(function(o){n=o});return{token:i,cancel:n}},Ii=t,Ii}var Ni,oo;function il(){return oo||(oo=1,Ni=function(t){return function(n){return t.apply(null,n)}}),Ni}var xi,ao;function sl(){if(ao)return xi;ao=1;var r=Dt;return xi=function(e){return r.isObject(e)&&e.isAxiosError===!0},xi}var co=Dt,ol=ha,In=rl,al=va,cl=gs;function Oa(r){var t=new In(r),e=ol(In.prototype.request,t);return co.extend(e,In.prototype,t),co.extend(e,t),e.create=function(i){return Oa(al(r,i))},e}var Oe=Oa(cl);Oe.Axios=In;Oe.Cancel=ri();Oe.CancelToken=nl();Oe.isCancel=Ea();Oe.VERSION=wa().version;Oe.all=function(t){return Promise.all(t)};Oe.spread=il();Oe.isAxiosError=sl();fs.exports=Oe;fs.exports.default=Oe;(function(r){r.exports=fs.exports})(la);const uo=ru(la.exports);function ul(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function c(y){try{m(n.next(y))}catch(v){o(v)}}function l(y){try{m(n.throw(y))}catch(v){o(v)}}function m(y){y.done?s(y.value):i(y.value).then(c,l)}m((n=n.apply(r,t||[])).next())})}var Yr;(function(r){r[r.CONTINUE=100]="CONTINUE",r[r.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",r[r.PROCESSING=102]="PROCESSING",r[r.OK=200]="OK",r[r.CREATED=201]="CREATED",r[r.ACCEPTED=202]="ACCEPTED",r[r.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",r[r.NO_CONTENT=204]="NO_CONTENT",r[r.RESET_CONTENT=205]="RESET_CONTENT",r[r.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",r[r.MULTI_STATUS=207]="MULTI_STATUS",r[r.ALREADY_REPORTED=208]="ALREADY_REPORTED",r[r.IM_USED=226]="IM_USED",r[r.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",r[r.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",r[r.FOUND=302]="FOUND",r[r.SEE_OTHER=303]="SEE_OTHER",r[r.NOT_MODIFIED=304]="NOT_MODIFIED",r[r.USE_PROXY=305]="USE_PROXY",r[r.SWITCH_PROXY=306]="SWITCH_PROXY",r[r.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",r[r.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",r[r.BAD_REQUEST=400]="BAD_REQUEST",r[r.UNAUTHORIZED=401]="UNAUTHORIZED",r[r.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",r[r.FORBIDDEN=403]="FORBIDDEN",r[r.NOT_FOUND=404]="NOT_FOUND",r[r.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",r[r.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",r[r.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",r[r.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",r[r.CONFLICT=409]="CONFLICT",r[r.GONE=410]="GONE",r[r.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",r[r.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",r[r.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",r[r.URI_TOO_LONG=414]="URI_TOO_LONG",r[r.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",r[r.RANGE_NOT_SATISFIABLE=416]="RANGE_NOT_SATISFIABLE",r[r.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",r[r.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",r[r.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",r[r.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",r[r.LOCKED=423]="LOCKED",r[r.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",r[r.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",r[r.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",r[r.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",r[r.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",r[r.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",r[r.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",r[r.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",r[r.BAD_GATEWAY=502]="BAD_GATEWAY",r[r.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",r[r.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",r[r.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",r[r.VARIANT_ALSO_NEGOTIATES=506]="VARIANT_ALSO_NEGOTIATES",r[r.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",r[r.LOOP_DETECTED=508]="LOOP_DETECTED",r[r.NOT_EXTENDED=510]="NOT_EXTENDED",r[r.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"})(Yr||(Yr={}));var Mn;(function(r){r.TEXT="text",r.JSON="json"})(Mn||(Mn={}));class si extends Error{constructor(t,e,n,i,s){super(t),this.message=t,this.status=e,this.statusText=n,this.body=i,this.url=s,this.name="HttpResponse"}}class ll extends Error{constructor(t){super(t),this.errorDetail=t,this.name="HttpRequestFailed"}}class hl{constructor(t=3e4){this.timeout=t}serialize(t){if(!t)return"";const e=[];for(const i in t)if(t.hasOwnProperty(i)&&typeof t[i]<"u"){const s=typeof t[i].toJSON=="function"?t[i].toJSON():t[i];if(s===null){e.push(encodeURIComponent(i));continue}if(Array.isArray(s)){s.forEach(o=>{e.push(encodeURIComponent(i)+"="+encodeURIComponent(o))});continue}e.push(encodeURIComponent(i)+"="+encodeURIComponent(s))}const n=e.join("&");return n?`?${n}`:""}createRequest({url:t,method:e,timeout:n=this.timeout,query:i,headers:s={},json:o=!0},c){return ul(this,void 0,void 0,function*(){let l,m;s["Content-Type"]||(s["Content-Type"]="application/json"),o?l=Mn.JSON:(l=Mn.TEXT,m=[y=>y]);try{return(yield uo.request({url:t+this.serialize(i),method:e!=null?e:"GET",headers:s,responseType:l,transformResponse:m,timeout:n,data:c})).data}catch(y){if(uo.isAxiosError(y)&&y.response){let v;throw typeof y.response.data=="object"?v=JSON.stringify(y.response.data):v=y.response.data,new si(`Http error response: (${y.response.status}) ${v}`,y.response.status,y.response.statusText,v,t+this.serialize(i))}else throw new ll(y)}})}}var fl=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Li=Math.ceil,oe=Math.floor,Bt="[BigNumber Error] ",lo=Bt+"Number primitive has more than 15 significant digits: ",Qt=1e14,k=14,Ci=9007199254740991,Mi=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Ke=1e7,_t=1e9;function Ra(r){var t,e,n,i=_.prototype={constructor:_,toString:null,valueOf:null},s=new _(1),o=20,c=4,l=-7,m=21,y=-1e7,v=1e7,P=!1,T=1,D=0,W={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},C="0123456789abcdefghijklmnopqrstuvwxyz",L=!0;function _(h,p){var u,b,d,w,O,E,a,f,g=this;if(!(g instanceof _))return new _(h,p);if(p==null){if(h&&h._isBigNumber===!0){g.s=h.s,!h.c||h.e>v?g.c=g.e=null:h.e<y?g.c=[g.e=0]:(g.e=h.e,g.c=h.c.slice());return}if((E=typeof h=="number")&&h*0==0){if(g.s=1/h<0?(h=-h,-1):1,h===~~h){for(w=0,O=h;O>=10;O/=10,w++);w>v?g.c=g.e=null:(g.e=w,g.c=[h]);return}f=String(h)}else{if(!fl.test(f=String(h)))return n(g,f,E);g.s=f.charCodeAt(0)==45?(f=f.slice(1),-1):1}(w=f.indexOf("."))>-1&&(f=f.replace(".","")),(O=f.search(/e/i))>0?(w<0&&(w=O),w+=+f.slice(O+1),f=f.substring(0,O)):w<0&&(w=f.length)}else{if(ft(p,2,C.length,"Base"),p==10&&L)return g=new _(h),Rt(g,o+g.e+1,c);if(f=String(h),E=typeof h=="number"){if(h*0!=0)return n(g,f,E,p);if(g.s=1/h<0?(f=f.slice(1),-1):1,_.DEBUG&&f.replace(/^0\.0*|\./,"").length>15)throw Error(lo+h)}else g.s=f.charCodeAt(0)===45?(f=f.slice(1),-1):1;for(u=C.slice(0,p),w=O=0,a=f.length;O<a;O++)if(u.indexOf(b=f.charAt(O))<0){if(b=="."){if(O>w){w=a;continue}}else if(!d&&(f==f.toUpperCase()&&(f=f.toLowerCase())||f==f.toLowerCase()&&(f=f.toUpperCase()))){d=!0,O=-1,w=0;continue}return n(g,String(h),E,p)}E=!1,f=e(f,p,10,g.s),(w=f.indexOf("."))>-1?f=f.replace(".",""):w=f.length}for(O=0;f.charCodeAt(O)===48;O++);for(a=f.length;f.charCodeAt(--a)===48;);if(f=f.slice(O,++a)){if(a-=O,E&&_.DEBUG&&a>15&&(h>Ci||h!==oe(h)))throw Error(lo+g.s*h);if((w=w-O-1)>v)g.c=g.e=null;else if(w<y)g.c=[g.e=0];else{if(g.e=w,g.c=[],O=(w+1)%k,w<0&&(O+=k),O<a){for(O&&g.c.push(+f.slice(0,O)),a-=k;O<a;)g.c.push(+f.slice(O,O+=k));O=k-(f=f.slice(O)).length}else O-=a;for(;O--;f+="0");g.c.push(+f)}}else g.c=[g.e=0]}_.clone=Ra,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(h){var p,u;if(h!=null)if(typeof h=="object"){if(h.hasOwnProperty(p="DECIMAL_PLACES")&&(u=h[p],ft(u,0,_t,p),o=u),h.hasOwnProperty(p="ROUNDING_MODE")&&(u=h[p],ft(u,0,8,p),c=u),h.hasOwnProperty(p="EXPONENTIAL_AT")&&(u=h[p],u&&u.pop?(ft(u[0],-_t,0,p),ft(u[1],0,_t,p),l=u[0],m=u[1]):(ft(u,-_t,_t,p),l=-(m=u<0?-u:u))),h.hasOwnProperty(p="RANGE"))if(u=h[p],u&&u.pop)ft(u[0],-_t,-1,p),ft(u[1],1,_t,p),y=u[0],v=u[1];else if(ft(u,-_t,_t,p),u)y=-(v=u<0?-u:u);else throw Error(Bt+p+" cannot be zero: "+u);if(h.hasOwnProperty(p="CRYPTO"))if(u=h[p],u===!!u)if(u)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))P=u;else throw P=!u,Error(Bt+"crypto unavailable");else P=u;else throw Error(Bt+p+" not true or false: "+u);if(h.hasOwnProperty(p="MODULO_MODE")&&(u=h[p],ft(u,0,9,p),T=u),h.hasOwnProperty(p="POW_PRECISION")&&(u=h[p],ft(u,0,_t,p),D=u),h.hasOwnProperty(p="FORMAT"))if(u=h[p],typeof u=="object")W=u;else throw Error(Bt+p+" not an object: "+u);if(h.hasOwnProperty(p="ALPHABET"))if(u=h[p],typeof u=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(u))L=u.slice(0,10)=="0123456789",C=u;else throw Error(Bt+p+" invalid: "+u)}else throw Error(Bt+"Object expected: "+h);return{DECIMAL_PLACES:o,ROUNDING_MODE:c,EXPONENTIAL_AT:[l,m],RANGE:[y,v],CRYPTO:P,MODULO_MODE:T,POW_PRECISION:D,FORMAT:W,ALPHABET:C}},_.isBigNumber=function(h){if(!h||h._isBigNumber!==!0)return!1;if(!_.DEBUG)return!0;var p,u,b=h.c,d=h.e,w=h.s;t:if({}.toString.call(b)=="[object Array]"){if((w===1||w===-1)&&d>=-_t&&d<=_t&&d===oe(d)){if(b[0]===0){if(d===0&&b.length===1)return!0;break t}if(p=(d+1)%k,p<1&&(p+=k),String(b[0]).length==p){for(p=0;p<b.length;p++)if(u=b[p],u<0||u>=Qt||u!==oe(u))break t;if(u!==0)return!0}}}else if(b===null&&d===null&&(w===null||w===1||w===-1))return!0;throw Error(Bt+"Invalid BigNumber: "+h)},_.maximum=_.max=function(){return B(arguments,i.lt)},_.minimum=_.min=function(){return B(arguments,i.gt)},_.random=function(){var h=9007199254740992,p=Math.random()*h&2097151?function(){return oe(Math.random()*h)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(u){var b,d,w,O,E,a=0,f=[],g=new _(s);if(u==null?u=o:ft(u,0,_t),O=Li(u/k),P)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(O*=2));a<O;)E=b[a]*131072+(b[a+1]>>>11),E>=9e15?(d=crypto.getRandomValues(new Uint32Array(2)),b[a]=d[0],b[a+1]=d[1]):(f.push(E%1e14),a+=2);a=O/2}else if(crypto.randomBytes){for(b=crypto.randomBytes(O*=7);a<O;)E=(b[a]&31)*281474976710656+b[a+1]*1099511627776+b[a+2]*4294967296+b[a+3]*16777216+(b[a+4]<<16)+(b[a+5]<<8)+b[a+6],E>=9e15?crypto.randomBytes(7).copy(b,a):(f.push(E%1e14),a+=7);a=O/7}else throw P=!1,Error(Bt+"crypto unavailable");if(!P)for(;a<O;)E=p(),E<9e15&&(f[a++]=E%1e14);for(O=f[--a],u%=k,O&&u&&(E=Mi[k-u],f[a]=oe(O/E)*E);f[a]===0;f.pop(),a--);if(a<0)f=[w=0];else{for(w=-1;f[0]===0;f.splice(0,1),w-=k);for(a=1,E=f[0];E>=10;E/=10,a++);a<k&&(w-=k-a)}return g.e=w,g.c=f,g}}(),_.sum=function(){for(var h=1,p=arguments,u=new _(p[0]);h<p.length;)u=u.plus(p[h++]);return u},e=function(){var h="0123456789";function p(u,b,d,w){for(var O,E=[0],a,f=0,g=u.length;f<g;){for(a=E.length;a--;E[a]*=b);for(E[0]+=w.indexOf(u.charAt(f++)),O=0;O<E.length;O++)E[O]>d-1&&(E[O+1]==null&&(E[O+1]=0),E[O+1]+=E[O]/d|0,E[O]%=d)}return E.reverse()}return function(u,b,d,w,O){var E,a,f,g,R,N,x,$,it=u.indexOf("."),dt=o,q=c;for(it>=0&&(g=D,D=0,u=u.replace(".",""),$=new _(b),N=$.pow(u.length-it),D=g,$.c=p(Re(qt(N.c),N.e,"0"),10,d,h),$.e=$.c.length),x=p(u,b,d,O?(E=C,h):(E=h,C)),f=g=x.length;x[--g]==0;x.pop());if(!x[0])return E.charAt(0);if(it<0?--f:(N.c=x,N.e=f,N.s=w,N=t(N,$,dt,q,d),x=N.c,R=N.r,f=N.e),a=f+dt+1,it=x[a],g=d/2,R=R||a<0||x[a+1]!=null,R=q<4?(it!=null||R)&&(q==0||q==(N.s<0?3:2)):it>g||it==g&&(q==4||R||q==6&&x[a-1]&1||q==(N.s<0?8:7)),a<1||!x[0])u=R?Re(E.charAt(1),-dt,E.charAt(0)):E.charAt(0);else{if(x.length=a,R)for(--d;++x[--a]>d;)x[a]=0,a||(++f,x=[1].concat(x));for(g=x.length;!x[--g];);for(it=0,u="";it<=g;u+=E.charAt(x[it++]));u=Re(u,f,E.charAt(0))}return u}}(),t=function(){function h(b,d,w){var O,E,a,f,g=0,R=b.length,N=d%Ke,x=d/Ke|0;for(b=b.slice();R--;)a=b[R]%Ke,f=b[R]/Ke|0,O=x*a+f*N,E=N*a+O%Ke*Ke+g,g=(E/w|0)+(O/Ke|0)+x*f,b[R]=E%w;return g&&(b=[g].concat(b)),b}function p(b,d,w,O){var E,a;if(w!=O)a=w>O?1:-1;else for(E=a=0;E<w;E++)if(b[E]!=d[E]){a=b[E]>d[E]?1:-1;break}return a}function u(b,d,w,O){for(var E=0;w--;)b[w]-=E,E=b[w]<d[w]?1:0,b[w]=E*O+b[w]-d[w];for(;!b[0]&&b.length>1;b.splice(0,1));}return function(b,d,w,O,E){var a,f,g,R,N,x,$,it,dt,q,et,Tt,En,pi,di,se,Gr,Kt=b.s==d.s?1:-1,Lt=b.c,gt=d.c;if(!Lt||!Lt[0]||!gt||!gt[0])return new _(!b.s||!d.s||(Lt?gt&&Lt[0]==gt[0]:!gt)?NaN:Lt&&Lt[0]==0||!gt?Kt*0:Kt/0);for(it=new _(Kt),dt=it.c=[],f=b.e-d.e,Kt=w+f+1,E||(E=Qt,f=Wt(b.e/k)-Wt(d.e/k),Kt=Kt/k|0),g=0;gt[g]==(Lt[g]||0);g++);if(gt[g]>(Lt[g]||0)&&f--,Kt<0)dt.push(1),R=!0;else{for(pi=Lt.length,se=gt.length,g=0,Kt+=2,N=oe(E/(gt[0]+1)),N>1&&(gt=h(gt,N,E),Lt=h(Lt,N,E),se=gt.length,pi=Lt.length),En=se,q=Lt.slice(0,se),et=q.length;et<se;q[et++]=0);Gr=gt.slice(),Gr=[0].concat(Gr),di=gt[0],gt[1]>=E/2&&di++;do{if(N=0,a=p(gt,q,se,et),a<0){if(Tt=q[0],se!=et&&(Tt=Tt*E+(q[1]||0)),N=oe(Tt/di),N>1)for(N>=E&&(N=E-1),x=h(gt,N,E),$=x.length,et=q.length;p(x,q,$,et)==1;)N--,u(x,se<$?Gr:gt,$,E),$=x.length,a=1;else N==0&&(a=N=1),x=gt.slice(),$=x.length;if($<et&&(x=[0].concat(x)),u(q,x,et,E),et=q.length,a==-1)for(;p(gt,q,se,et)<1;)N++,u(q,se<et?Gr:gt,et,E),et=q.length}else a===0&&(N++,q=[0]);dt[g++]=N,q[0]?q[et++]=Lt[En]||0:(q=[Lt[En]],et=1)}while((En++<pi||q[0]!=null)&&Kt--);R=q[0]!=null,dt[0]||dt.splice(0,1)}if(E==Qt){for(g=1,Kt=dt[0];Kt>=10;Kt/=10,g++);Rt(it,w+(it.e=g+f*k-1)+1,O,R)}else it.e=f,it.r=+R;return it}}();function nt(h,p,u,b){var d,w,O,E,a;if(u==null?u=c:ft(u,0,8),!h.c)return h.toString();if(d=h.c[0],O=h.e,p==null)a=qt(h.c),a=b==1||b==2&&(O<=l||O>=m)?wn(a,O):Re(a,O,"0");else if(h=Rt(new _(h),p,u),w=h.e,a=qt(h.c),E=a.length,b==1||b==2&&(p<=w||w<=l)){for(;E<p;a+="0",E++);a=wn(a,w)}else if(p-=O,a=Re(a,w,"0"),w+1>E){if(--p>0)for(a+=".";p--;a+="0");}else if(p+=w-E,p>0)for(w+1==E&&(a+=".");p--;a+="0");return h.s<0&&d?"-"+a:a}function B(h,p){for(var u,b=1,d=new _(h[0]);b<h.length;b++)if(u=new _(h[b]),u.s)p.call(d,u)&&(d=u);else{d=u;break}return d}function Ge(h,p,u){for(var b=1,d=p.length;!p[--d];p.pop());for(d=p[0];d>=10;d/=10,b++);return(u=b+u*k-1)>v?h.c=h.e=null:u<y?h.c=[h.e=0]:(h.e=u,h.c=p),h}n=function(){var h=/^(-?)0([xbo])(?=\w[\w.]*$)/i,p=/^([^.]+)\.$/,u=/^\.([^.]+)$/,b=/^-?(Infinity|NaN)$/,d=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(w,O,E,a){var f,g=E?O:O.replace(d,"");if(b.test(g))w.s=isNaN(g)?null:g<0?-1:1;else{if(!E&&(g=g.replace(h,function(R,N,x){return f=(x=x.toLowerCase())=="x"?16:x=="b"?2:8,!a||a==f?N:R}),a&&(f=a,g=g.replace(p,"$1").replace(u,"0.$1")),O!=g))return new _(g,f);if(_.DEBUG)throw Error(Bt+"Not a"+(a?" base "+a:"")+" number: "+O);w.s=null}w.c=w.e=null}}();function Rt(h,p,u,b){var d,w,O,E,a,f,g,R=h.c,N=Mi;if(R){t:{for(d=1,E=R[0];E>=10;E/=10,d++);if(w=p-d,w<0)w+=k,O=p,a=R[f=0],g=a/N[d-O-1]%10|0;else if(f=Li((w+1)/k),f>=R.length)if(b){for(;R.length<=f;R.push(0));a=g=0,d=1,w%=k,O=w-k+1}else break t;else{for(a=E=R[f],d=1;E>=10;E/=10,d++);w%=k,O=w-k+d,g=O<0?0:a/N[d-O-1]%10|0}if(b=b||p<0||R[f+1]!=null||(O<0?a:a%N[d-O-1]),b=u<4?(g||b)&&(u==0||u==(h.s<0?3:2)):g>5||g==5&&(u==4||b||u==6&&(w>0?O>0?a/N[d-O]:0:R[f-1])%10&1||u==(h.s<0?8:7)),p<1||!R[0])return R.length=0,b?(p-=h.e+1,R[0]=N[(k-p%k)%k],h.e=-p||0):R[0]=h.e=0,h;if(w==0?(R.length=f,E=1,f--):(R.length=f+1,E=N[k-w],R[f]=O>0?oe(a/N[d-O]%N[O])*E:0),b)for(;;)if(f==0){for(w=1,O=R[0];O>=10;O/=10,w++);for(O=R[0]+=E,E=1;O>=10;O/=10,E++);w!=E&&(h.e++,R[0]==Qt&&(R[0]=1));break}else{if(R[f]+=E,R[f]!=Qt)break;R[f--]=0,E=1}for(w=R.length;R[--w]===0;R.pop());}h.e>v?h.c=h.e=null:h.e<y&&(h.c=[h.e=0])}return h}function ht(h){var p,u=h.e;return u===null?h.toString():(p=qt(h.c),p=u<=l||u>=m?wn(p,u):Re(p,u,"0"),h.s<0?"-"+p:p)}return i.absoluteValue=i.abs=function(){var h=new _(this);return h.s<0&&(h.s=1),h},i.comparedTo=function(h,p){return Sr(this,new _(h,p))},i.decimalPlaces=i.dp=function(h,p){var u,b,d,w=this;if(h!=null)return ft(h,0,_t),p==null?p=c:ft(p,0,8),Rt(new _(w),h+w.e+1,p);if(!(u=w.c))return null;if(b=((d=u.length-1)-Wt(this.e/k))*k,d=u[d])for(;d%10==0;d/=10,b--);return b<0&&(b=0),b},i.dividedBy=i.div=function(h,p){return t(this,new _(h,p),o,c)},i.dividedToIntegerBy=i.idiv=function(h,p){return t(this,new _(h,p),0,1)},i.exponentiatedBy=i.pow=function(h,p){var u,b,d,w,O,E,a,f,g,R=this;if(h=new _(h),h.c&&!h.isInteger())throw Error(Bt+"Exponent not an integer: "+ht(h));if(p!=null&&(p=new _(p)),E=h.e>14,!R.c||!R.c[0]||R.c[0]==1&&!R.e&&R.c.length==1||!h.c||!h.c[0])return g=new _(Math.pow(+ht(R),E?2-vn(h):+ht(h))),p?g.mod(p):g;if(a=h.s<0,p){if(p.c?!p.c[0]:!p.s)return new _(NaN);b=!a&&R.isInteger()&&p.isInteger(),b&&(R=R.mod(p))}else{if(h.e>9&&(R.e>0||R.e<-1||(R.e==0?R.c[0]>1||E&&R.c[1]>=24e7:R.c[0]<8e13||E&&R.c[0]<=9999975e7)))return w=R.s<0&&vn(h)?-0:0,R.e>-1&&(w=1/w),new _(a?1/w:w);D&&(w=Li(D/k+2))}for(E?(u=new _(.5),a&&(h.s=1),f=vn(h)):(d=Math.abs(+ht(h)),f=d%2),g=new _(s);;){if(f){if(g=g.times(R),!g.c)break;w?g.c.length>w&&(g.c.length=w):b&&(g=g.mod(p))}if(d){if(d=oe(d/2),d===0)break;f=d%2}else if(h=h.times(u),Rt(h,h.e+1,1),h.e>14)f=vn(h);else{if(d=+ht(h),d===0)break;f=d%2}R=R.times(R),w?R.c&&R.c.length>w&&(R.c.length=w):b&&(R=R.mod(p))}return b?g:(a&&(g=s.div(g)),p?g.mod(p):w?Rt(g,D,c,O):g)},i.integerValue=function(h){var p=new _(this);return h==null?h=c:ft(h,0,8),Rt(p,p.e+1,h)},i.isEqualTo=i.eq=function(h,p){return Sr(this,new _(h,p))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(h,p){return Sr(this,new _(h,p))>0},i.isGreaterThanOrEqualTo=i.gte=function(h,p){return(p=Sr(this,new _(h,p)))===1||p===0},i.isInteger=function(){return!!this.c&&Wt(this.e/k)>this.c.length-2},i.isLessThan=i.lt=function(h,p){return Sr(this,new _(h,p))<0},i.isLessThanOrEqualTo=i.lte=function(h,p){return(p=Sr(this,new _(h,p)))===-1||p===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(h,p){var u,b,d,w,O=this,E=O.s;if(h=new _(h,p),p=h.s,!E||!p)return new _(NaN);if(E!=p)return h.s=-p,O.plus(h);var a=O.e/k,f=h.e/k,g=O.c,R=h.c;if(!a||!f){if(!g||!R)return g?(h.s=-p,h):new _(R?O:NaN);if(!g[0]||!R[0])return R[0]?(h.s=-p,h):new _(g[0]?O:c==3?-0:0)}if(a=Wt(a),f=Wt(f),g=g.slice(),E=a-f){for((w=E<0)?(E=-E,d=g):(f=a,d=R),d.reverse(),p=E;p--;d.push(0));d.reverse()}else for(b=(w=(E=g.length)<(p=R.length))?E:p,E=p=0;p<b;p++)if(g[p]!=R[p]){w=g[p]<R[p];break}if(w&&(d=g,g=R,R=d,h.s=-h.s),p=(b=R.length)-(u=g.length),p>0)for(;p--;g[u++]=0);for(p=Qt-1;b>E;){if(g[--b]<R[b]){for(u=b;u&&!g[--u];g[u]=p);--g[u],g[b]+=Qt}g[b]-=R[b]}for(;g[0]==0;g.splice(0,1),--f);return g[0]?Ge(h,g,f):(h.s=c==3?-1:1,h.c=[h.e=0],h)},i.modulo=i.mod=function(h,p){var u,b,d=this;return h=new _(h,p),!d.c||!h.s||h.c&&!h.c[0]?new _(NaN):!h.c||d.c&&!d.c[0]?new _(d):(T==9?(b=h.s,h.s=1,u=t(d,h,0,3),h.s=b,u.s*=b):u=t(d,h,0,T),h=d.minus(u.times(h)),!h.c[0]&&T==1&&(h.s=d.s),h)},i.multipliedBy=i.times=function(h,p){var u,b,d,w,O,E,a,f,g,R,N,x,$,it,dt,q=this,et=q.c,Tt=(h=new _(h,p)).c;if(!et||!Tt||!et[0]||!Tt[0])return!q.s||!h.s||et&&!et[0]&&!Tt||Tt&&!Tt[0]&&!et?h.c=h.e=h.s=null:(h.s*=q.s,!et||!Tt?h.c=h.e=null:(h.c=[0],h.e=0)),h;for(b=Wt(q.e/k)+Wt(h.e/k),h.s*=q.s,a=et.length,R=Tt.length,a<R&&($=et,et=Tt,Tt=$,d=a,a=R,R=d),d=a+R,$=[];d--;$.push(0));for(it=Qt,dt=Ke,d=R;--d>=0;){for(u=0,N=Tt[d]%dt,x=Tt[d]/dt|0,O=a,w=d+O;w>d;)f=et[--O]%dt,g=et[O]/dt|0,E=x*f+g*N,f=N*f+E%dt*dt+$[w]+u,u=(f/it|0)+(E/dt|0)+x*g,$[w--]=f%it;$[w]=u}return u?++b:$.splice(0,1),Ge(h,$,b)},i.negated=function(){var h=new _(this);return h.s=-h.s||null,h},i.plus=function(h,p){var u,b=this,d=b.s;if(h=new _(h,p),p=h.s,!d||!p)return new _(NaN);if(d!=p)return h.s=-p,b.minus(h);var w=b.e/k,O=h.e/k,E=b.c,a=h.c;if(!w||!O){if(!E||!a)return new _(d/0);if(!E[0]||!a[0])return a[0]?h:new _(E[0]?b:d*0)}if(w=Wt(w),O=Wt(O),E=E.slice(),d=w-O){for(d>0?(O=w,u=a):(d=-d,u=E),u.reverse();d--;u.push(0));u.reverse()}for(d=E.length,p=a.length,d-p<0&&(u=a,a=E,E=u,p=d),d=0;p;)d=(E[--p]=E[p]+a[p]+d)/Qt|0,E[p]=Qt===E[p]?0:E[p]%Qt;return d&&(E=[d].concat(E),++O),Ge(h,E,O)},i.precision=i.sd=function(h,p){var u,b,d,w=this;if(h!=null&&h!==!!h)return ft(h,1,_t),p==null?p=c:ft(p,0,8),Rt(new _(w),h,p);if(!(u=w.c))return null;if(d=u.length-1,b=d*k+1,d=u[d]){for(;d%10==0;d/=10,b--);for(d=u[0];d>=10;d/=10,b++);}return h&&w.e+1>b&&(b=w.e+1),b},i.shiftedBy=function(h){return ft(h,-Ci,Ci),this.times("1e"+h)},i.squareRoot=i.sqrt=function(){var h,p,u,b,d,w=this,O=w.c,E=w.s,a=w.e,f=o+4,g=new _("0.5");if(E!==1||!O||!O[0])return new _(!E||E<0&&(!O||O[0])?NaN:O?w:1/0);if(E=Math.sqrt(+ht(w)),E==0||E==1/0?(p=qt(O),(p.length+a)%2==0&&(p+="0"),E=Math.sqrt(+p),a=Wt((a+1)/2)-(a<0||a%2),E==1/0?p="5e"+a:(p=E.toExponential(),p=p.slice(0,p.indexOf("e")+1)+a),u=new _(p)):u=new _(E+""),u.c[0]){for(a=u.e,E=a+f,E<3&&(E=0);;)if(d=u,u=g.times(d.plus(t(w,d,f,1))),qt(d.c).slice(0,E)===(p=qt(u.c)).slice(0,E))if(u.e<a&&--E,p=p.slice(E-3,E+1),p=="9999"||!b&&p=="4999"){if(!b&&(Rt(d,d.e+o+2,0),d.times(d).eq(w))){u=d;break}f+=4,E+=4,b=1}else{(!+p||!+p.slice(1)&&p.charAt(0)=="5")&&(Rt(u,u.e+o+2,1),h=!u.times(u).eq(w));break}}return Rt(u,u.e+o+1,c,h)},i.toExponential=function(h,p){return h!=null&&(ft(h,0,_t),h++),nt(this,h,p,1)},i.toFixed=function(h,p){return h!=null&&(ft(h,0,_t),h=h+this.e+1),nt(this,h,p)},i.toFormat=function(h,p,u){var b,d=this;if(u==null)h!=null&&p&&typeof p=="object"?(u=p,p=null):h&&typeof h=="object"?(u=h,h=p=null):u=W;else if(typeof u!="object")throw Error(Bt+"Argument not an object: "+u);if(b=d.toFixed(h,p),d.c){var w,O=b.split("."),E=+u.groupSize,a=+u.secondaryGroupSize,f=u.groupSeparator||"",g=O[0],R=O[1],N=d.s<0,x=N?g.slice(1):g,$=x.length;if(a&&(w=E,E=a,a=w,$-=w),E>0&&$>0){for(w=$%E||E,g=x.substr(0,w);w<$;w+=E)g+=f+x.substr(w,E);a>0&&(g+=f+x.slice(w)),N&&(g="-"+g)}b=R?g+(u.decimalSeparator||"")+((a=+u.fractionGroupSize)?R.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(u.fractionGroupSeparator||"")):R):g}return(u.prefix||"")+b+(u.suffix||"")},i.toFraction=function(h){var p,u,b,d,w,O,E,a,f,g,R,N,x=this,$=x.c;if(h!=null&&(E=new _(h),!E.isInteger()&&(E.c||E.s!==1)||E.lt(s)))throw Error(Bt+"Argument "+(E.isInteger()?"out of range: ":"not an integer: ")+ht(E));if(!$)return new _(x);for(p=new _(s),f=u=new _(s),b=a=new _(s),N=qt($),w=p.e=N.length-x.e-1,p.c[0]=Mi[(O=w%k)<0?k+O:O],h=!h||E.comparedTo(p)>0?w>0?p:f:E,O=v,v=1/0,E=new _(N),a.c[0]=0;g=t(E,p,0,1),d=u.plus(g.times(b)),d.comparedTo(h)!=1;)u=b,b=d,f=a.plus(g.times(d=f)),a=d,p=E.minus(g.times(d=p)),E=d;return d=t(h.minus(u),b,0,1),a=a.plus(d.times(f)),u=u.plus(d.times(b)),a.s=f.s=x.s,w=w*2,R=t(f,b,w,c).minus(x).abs().comparedTo(t(a,u,w,c).minus(x).abs())<1?[f,b]:[a,u],v=O,R},i.toNumber=function(){return+ht(this)},i.toPrecision=function(h,p){return h!=null&&ft(h,1,_t),nt(this,h,p,2)},i.toString=function(h){var p,u=this,b=u.s,d=u.e;return d===null?b?(p="Infinity",b<0&&(p="-"+p)):p="NaN":(h==null?p=d<=l||d>=m?wn(qt(u.c),d):Re(qt(u.c),d,"0"):h===10&&L?(u=Rt(new _(u),o+d+1,c),p=Re(qt(u.c),u.e,"0")):(ft(h,2,C.length,"Base"),p=e(Re(qt(u.c),d,"0"),10,h,b,!0)),b<0&&u.c[0]&&(p="-"+p)),p},i.valueOf=i.toJSON=function(){return ht(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,r!=null&&_.set(r),_}function Wt(r){var t=r|0;return r>0||r===t?t:t-1}function qt(r){for(var t,e,n=1,i=r.length,s=r[0]+"";n<i;){for(t=r[n++]+"",e=k-t.length;e--;t="0"+t);s+=t}for(i=s.length;s.charCodeAt(--i)===48;);return s.slice(0,i+1||1)}function Sr(r,t){var e,n,i=r.c,s=t.c,o=r.s,c=t.s,l=r.e,m=t.e;if(!o||!c)return null;if(e=i&&!i[0],n=s&&!s[0],e||n)return e?n?0:-c:o;if(o!=c)return o;if(e=o<0,n=l==m,!i||!s)return n?0:!i^e?1:-1;if(!n)return l>m^e?1:-1;for(c=(l=i.length)<(m=s.length)?l:m,o=0;o<c;o++)if(i[o]!=s[o])return i[o]>s[o]^e?1:-1;return l==m?0:l>m^e?1:-1}function ft(r,t,e,n){if(r<t||r>e||r!==oe(r))throw Error(Bt+(n||"Argument")+(typeof r=="number"?r<t||r>e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(r))}function vn(r){var t=r.c.length-1;return Wt(r.e/k)==t&&r.c[t]%2!=0}function wn(r,t){return(r.length>1?r.charAt(0)+"."+r.slice(1):r)+(t<0?"e":"e+")+t}function Re(r,t,e){var n,i;if(t<0){for(i=e+".";++t;i+=e);r=i+r}else if(n=r.length,++t>n){for(i=e,t-=n;--t;i+=e);r+=i}else t<n&&(r=r.slice(0,t)+"."+r.slice(t));return r}var G=Ra();function Bi(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e}function V(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function c(y){try{m(n.next(y))}catch(v){o(v)}}function l(y){try{m(n.throw(y))}catch(v){o(v)}}function m(y){y.done?s(y.value):i(y.value).then(c,l)}m((n=n.apply(r,t||[])).next())})}const pl="main",F={block:"head"};var ho;(function(r){r.GET_BAKING_RIGHTS="getBakingRights",r.GET_BALLOTS="getBallots",r.GET_BALLOT_LIST="getBallotList",r.GET_BIG_MAP_KEY="getBigMapKey",r.GET_BIG_MAP_EXPR="getBigMapExpr",r.GET_BLOCK_HASH="getBlockHash",r.GET_BLOCK="getBlock",r.GET_BLOCK_HEADER="getBlockHeader",r.GET_BLOCK_METADATA="getBlockMetadata",r.GET_BALANCE="getBalance",r.GET_CHAIN_ID="getChainId",r.GET_CONSTANTS="getConstants",r.GET_CONTRACT="getContract",r.GET_CURRENT_PERIOD="getCurrentPeriod",r.GET_CURRENT_PROPOSAL="getCurrentProposal",r.GET_CURRENT_QUORUM="getCurrentQuorum",r.GET_DELEGATE="getDelegate",r.GET_DELEGATES="getDelegates",r.GET_ENDORSING_RIGHTS="getEndorsingRights",r.GET_ENTRYPOINTS="getEntrypoints",r.GET_LIVE_BLOCKS="getLiveBlocks",r.GET_MANAGER_KEY="getManagerKey",r.GET_NORMALIZED_SCRIPT="getNormalizedScript",r.GET_PROPOSALS="getProposals",r.GET_PROTOCOLS="getProtocols",r.GET_SAPLING_DIFF_BY_CONTRACT="getSaplingDiffByContract",r.GET_SAPLING_DIFF_BY_ID="getSaplingDiffById",r.GET_SCRIPT="getScript",r.GET_STORAGE="getStorage",r.GET_SUCCESSOR_PERIOD="getSuccessorPeriod",r.GET_TX_ROLLUP_INBOX="getTxRollupInbox",r.GET_TX_ROLLUP_STATE="getTxRollupState",r.GET_VOTES_LISTINGS="getVotesListings",r.PACK_DATA="packData"})(ho||(ho={}));function qr(r,t){const e=Array.isArray(r);typeof t>"u"&&(t=Object.keys(r));const n=e?[]:{};return t.forEach(i=>{const s=r[i];let o;if(!(typeof s>"u")){if(Array.isArray(s)){o=qr(s),n[i]=o;return}o=new G(s),n[i]=o}}),n}var fo;(function(r){r.TOO_LARGE="too large"})(fo||(fo={}));var po;(function(r){r.BAKING_REWARDS="baking rewards",r.REWARDS="rewards",r.FEES="fees",r.DEPOSITS="deposits",r.LEGACY_REWARDS="legacy_rewards",r.LEGACY_FEES="legacy_fees",r.LEGACY_DEPOSITS="legacy_deposits",r.BLOCK_FEES="block fees",r.NONCE_REVELATION_REWARDS="nonce revelation rewards",r.DOUBLE_SIGNING_EVIDENCE_REWARDS="double signing evidence rewards",r.ENDORSING_REWARDS="endorsing rewards",r.BAKING_BONUSES="baking bonuses",r.STORAGE_FEES="storage fees",r.PUNISHMENTS="punishments",r.LOST_ENDORSING_REWARDS="lost endorsing rewards",r.SUBSIDY="subsidy",r.BURNED="burned",r.COMMITMENT="commitment",r.BOOTSTRAP="bootstrap",r.INVOICE="invoice",r.MINTED="minted",r.TX_ROLLUP_REJECTION_REWARDS="tx_rollup_rejection_rewards",r.TX_ROLLUP_REJECTION_PUNISHMENTS="tx_rollup_rejection_punishments",r.BONDS="bonds"})(po||(po={}));var I;(function(r){r.ORIGINATION="origination",r.DELEGATION="delegation",r.REVEAL="reveal",r.TRANSACTION="transaction",r.ACTIVATION="activate_account",r.ENDORSEMENT="endorsement",r.PREENDORSEMENT="preendorsement",r.SET_DEPOSITS_LIMIT="set_deposits_limit",r.DOUBLE_PREENDORSEMENT_EVIDENCE="double_preendorsement_evidence",r.ENDORSEMENT_WITH_SLOT="endorsement_with_slot",r.SEED_NONCE_REVELATION="seed_nonce_revelation",r.DOUBLE_ENDORSEMENT_EVIDENCE="double_endorsement_evidence",r.DOUBLE_BAKING_EVIDENCE="double_baking_evidence",r.PROPOSALS="proposals",r.BALLOT="ballot",r.FAILING_NOOP="failing_noop",r.REGISTER_GLOBAL_CONSTANT="register_global_constant",r.TX_ROLLUP_ORIGINATION="tx_rollup_origination",r.TX_ROLLUP_SUBMIT_BATCH="tx_rollup_submit_batch",r.TX_ROLLUP_COMMIT="tx_rollup_commit",r.TX_ROLLUP_RETURN_BOND="tx_rollup_return_bond",r.TX_ROLLUP_FINALIZE_COMMITMENT="tx_rollup_finalize_commitment",r.TX_ROLLUP_REMOVE_COMMITMENT="tx_rollup_remove_commitment",r.TX_ROLLUP_REJECTION="tx_rollup_rejection",r.TX_ROLLUP_DISPATCH_TICKETS="tx_rollup_dispatch_tickets",r.TRANSFER_TICKET="transfer_ticket"})(I||(I={}));class Nn{constructor(t,e=pl,n=new hl){this.url=t,this.chain=e,this.httpBackend=n}createURL(t){return`${this.url.replace(/\/+$/g,"")}${t}`}validateAddress(t){if(pt(t)!==U.VALID)throw new bt(t)}validateContract(t){if(xr(t)!==U.VALID)throw new bt(t)}getBlockHash({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/hash`),method:"GET"})})}getLiveBlocks({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/live_blocks`),method:"GET"})})}getBalance(t,{block:e}=F){return V(this,void 0,void 0,function*(){this.validateAddress(t);const n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/contracts/${t}/balance`),method:"GET"});return new G(n)})}getStorage(t,{block:e}=F){return V(this,void 0,void 0,function*(){return this.validateContract(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/contracts/${t}/storage`),method:"GET"})})}getScript(t,{block:e}=F){return V(this,void 0,void 0,function*(){return this.validateContract(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/contracts/${t}/script`),method:"GET"})})}getNormalizedScript(t,e={unparsing_mode:"Readable"},{block:n}=F){return V(this,void 0,void 0,function*(){return this.validateContract(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/contracts/${t}/script/normalized`),method:"POST"},e)})}getContract(t,{block:e}=F){return V(this,void 0,void 0,function*(){this.validateAddress(t);const n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/contracts/${t}`),method:"GET"});return Object.assign(Object.assign({},n),{balance:new G(n.balance)})})}getManagerKey(t,{block:e}=F){return V(this,void 0,void 0,function*(){return this.validateAddress(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/contracts/${t}/manager_key`),method:"GET"})})}getDelegate(t,{block:e}=F){return V(this,void 0,void 0,function*(){this.validateAddress(t);let n;try{n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/contracts/${t}/delegate`),method:"GET"})}catch(i){if(i instanceof si&&i.status===Yr.NOT_FOUND)n=null;else throw i}return n})}getBigMapKey(t,e,{block:n}=F){return V(this,void 0,void 0,function*(){return this.validateAddress(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/contracts/${t}/big_map_get`),method:"POST"},e)})}getBigMapExpr(t,e,{block:n}=F){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/big_maps/${t}/${e}`),method:"GET"})})}getDelegates(t,{block:e}=F){return V(this,void 0,void 0,function*(){this.validateAddress(t);const n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/delegates/${t}`),method:"GET"}),i=qr(n,["balance","full_balance","current_frozen_deposits","frozen_deposits","frozen_balance","frozen_deposits_limit","staking_balance","delegated_balance","voting_power"]);return Object.assign(Object.assign(Object.assign({},n),i),{frozen_balance_by_cycle:n.frozen_balance_by_cycle?n.frozen_balance_by_cycle.map(s=>{var{deposit:o,deposits:c,fees:l,rewards:m}=s,y=Bi(s,["deposit","deposits","fees","rewards"]);const v=qr({deposit:o,deposits:c,fees:l,rewards:m},["deposit","deposits","fees","rewards"]);return Object.assign(Object.assign({},y),{deposit:v.deposit,deposits:v.deposits,fees:v.fees,rewards:v.rewards})}):void 0})})}getConstants({block:t}=F){return V(this,void 0,void 0,function*(){const e=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/context/constants`),method:"GET"}),n=qr(e,["time_between_blocks","hard_gas_limit_per_operation","hard_gas_limit_per_block","proof_of_work_threshold","tokens_per_roll","seed_nonce_revelation_tip","block_security_deposit","endorsement_security_deposit","block_reward","endorsement_reward","cost_per_byte","hard_storage_limit_per_operation","test_chain_duration","baking_reward_per_endorsement","delay_per_missing_endorsement","minimal_block_delay","liquidity_baking_subsidy","cache_layout","baking_reward_fixed_portion","baking_reward_bonus_per_slot","endorsing_reward_per_slot","double_baking_punishment","delay_increment_per_round","tx_rollup_commitment_bond"]);return Object.assign(Object.assign({},e),n)})}getBlock({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}`),method:"GET"})})}getBlockHeader({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/header`),method:"GET"})})}getBlockMetadata({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/metadata`),method:"GET"})})}getBakingRights(t={},{block:e}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/helpers/baking_rights`),method:"GET",query:t})})}getEndorsingRights(t={},{block:e}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/helpers/endorsing_rights`),method:"GET",query:t})})}getBallotList({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/ballot_list`),method:"GET"})})}getBallots({block:t}=F){return V(this,void 0,void 0,function*(){const e=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/ballots`),method:"GET"});return qr(e,["yay","nay","pass"])})}getCurrentProposal({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/current_proposal`),method:"GET"})})}getCurrentQuorum({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/current_quorum`),method:"GET"})})}getVotesListings({block:t}=F){return V(this,void 0,void 0,function*(){const e=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/listings`),method:"GET"});return e.map(n=>(n.voting_power&&(n.voting_power=new G(n.voting_power)),n)),e})}getProposals({block:t}=F){return V(this,void 0,void 0,function*(){const e=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/proposals`),method:"GET"});return e.map(n=>n[1]=new G(n[1])),e})}forgeOperations(t,{block:e}=F){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/helpers/forge/operations`),method:"POST"},t)})}injectOperation(t){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL("/injection/operation"),method:"POST"},t)})}preapplyOperations(t,{block:e}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/helpers/preapply/operations`),method:"POST"},t)})}getEntrypoints(t,{block:e}=F){return V(this,void 0,void 0,function*(){return this.validateContract(t),yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/contracts/${t}/entrypoints`),method:"GET"})})}runOperation(t,{block:e}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/helpers/scripts/run_operation`),method:"POST"},t)})}runCode(t,{block:e}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/helpers/scripts/run_code`),method:"POST"},t)})}runView(t,{block:e}=F){var{unparsing_mode:n="Readable"}=t,i=Bi(t,["unparsing_mode"]);return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/helpers/scripts/run_view`),method:"POST"},Object.assign({unparsing_mode:n},i))})}getChainId(){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/chain_id`),method:"GET"})})}packData(t,{block:e}=F){return V(this,void 0,void 0,function*(){const n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/helpers/scripts/pack_data`),method:"POST"},t),{gas:i}=n,s=Bi(n,["gas"]);let o=i;const c=new G(i||"");return c.isNaN()||(o=c),Object.assign({gas:o},s)})}getRpcUrl(){return this.url}getCurrentPeriod({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/current_period`),method:"GET"})})}getSuccessorPeriod({block:t}=F){return V(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/successor_period`),method:"GET"})})}getSaplingDiffById(t,{block:e}=F){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/sapling/${t}/get_diff`),method:"GET"})})}getSaplingDiffByContract(t,{block:e}=F){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/contracts/${t}/single_sapling_get_diff`),method:"GET"})})}getProtocols({block:t}=F){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/protocols`),method:"GET"})})}getTxRollupState(t,{block:e}=F){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${e}/context/tx_rollup/${t}/state`),method:"GET"})})}getTxRollupInbox(t,e,{block:n}=F){return V(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/tx_rollup/${t}/inbox/${e}`),method:"GET"})})}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ji=function(r,t){return Ji=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])},Ji(r,t)};function K(r,t){Ji(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Bn(r){return typeof r=="function"}var go=!1,ne={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){if(r){var t=new Error;""+t.stack}go=r},get useDeprecatedSynchronousErrorHandling(){return go}};function Tr(r){setTimeout(function(){throw r},0)}var Dn={closed:!0,next:function(r){},error:function(r){if(ne.useDeprecatedSynchronousErrorHandling)throw r;Tr(r)},complete:function(){}},ys=function(){return Array.isArray||function(r){return r&&typeof r.length=="number"}}();function Sa(r){return r!==null&&typeof r=="object"}var dl=function(){function r(t){return Error.call(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(e,n){return n+1+") "+e.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t,this}return r.prototype=Object.create(Error.prototype),r}(),xn=dl,Gt=function(){function r(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return r.prototype.unsubscribe=function(){var t;if(!this.closed){var e=this,n=e._parentOrParents,i=e._ctorUnsubscribe,s=e._unsubscribe,o=e._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof r)n.remove(this);else if(n!==null)for(var c=0;c<n.length;++c){var l=n[c];l.remove(this)}if(Bn(s)){i&&(this._unsubscribe=void 0);try{s.call(this)}catch(v){t=v instanceof xn?mo(v.errors):[v]}}if(ys(o))for(var c=-1,m=o.length;++c<m;){var y=o[c];if(Sa(y))try{y.unsubscribe()}catch(P){t=t||[],P instanceof xn?t=t.concat(mo(P.errors)):t.push(P)}}if(t)throw new xn(t)}},r.prototype.add=function(t){var e=t;if(!t)return r.EMPTY;switch(typeof t){case"function":e=new r(t);case"object":if(e===this||e.closed||typeof e.unsubscribe!="function")return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof r)){var n=e;e=new r,e._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=e._parentOrParents;if(i===null)e._parentOrParents=this;else if(i instanceof r){if(i===this)return e;e._parentOrParents=[i,this]}else if(i.indexOf(this)===-1)i.push(this);else return e;var s=this._subscriptions;return s===null?this._subscriptions=[e]:s.push(e),e},r.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);n!==-1&&e.splice(n,1)}},r.EMPTY=function(t){return t.closed=!0,t}(new r),r}();function mo(r){return r.reduce(function(t,e){return t.concat(e instanceof xn?e.errors:e)},[])}var $n=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Et=function(r){K(t,r);function t(e,n,i){var s=r.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=Dn;break;case 1:if(!e){s.destination=Dn;break}if(typeof e=="object"){e instanceof t?(s.syncErrorThrowable=e.syncErrorThrowable,s.destination=e,e.add(s)):(s.syncErrorThrowable=!0,s.destination=new yo(s,e));break}default:s.syncErrorThrowable=!0,s.destination=new yo(s,e,n,i);break}return s}return t.prototype[$n]=function(){return this},t.create=function(e,n,i){var s=new t(e,n,i);return s.syncErrorThrowable=!1,s},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(Gt),yo=function(r){K(t,r);function t(e,n,i,s){var o=r.call(this)||this;o._parentSubscriber=e;var c,l=o;return Bn(n)?c=n:n&&(c=n.next,i=n.error,s=n.complete,n!==Dn&&(l=Object.create(n),Bn(l.unsubscribe)&&o.add(l.unsubscribe.bind(l)),l.unsubscribe=o.unsubscribe.bind(o))),o._context=l,o._next=c,o._error=i,o._complete=s,o}return t.prototype.next=function(e){if(!this.isStopped&&this._next){var n=this._parentSubscriber;!ne.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?this.__tryOrUnsub(this._next,e):this.__tryOrSetError(n,this._next,e)&&this.unsubscribe()}},t.prototype.error=function(e){if(!this.isStopped){var n=this._parentSubscriber,i=ne.useDeprecatedSynchronousErrorHandling;if(this._error)!i||!n.syncErrorThrowable?(this.__tryOrUnsub(this._error,e),this.unsubscribe()):(this.__tryOrSetError(n,this._error,e),this.unsubscribe());else if(n.syncErrorThrowable)i?(n.syncErrorValue=e,n.syncErrorThrown=!0):Tr(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;Tr(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var n=this._parentSubscriber;if(this._complete){var i=function(){return e._complete.call(e._context)};!ne.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?(this.__tryOrUnsub(i),this.unsubscribe()):(this.__tryOrSetError(n,i),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,n){try{e.call(this._context,n)}catch(i){if(this.unsubscribe(),ne.useDeprecatedSynchronousErrorHandling)throw i;Tr(i)}},t.prototype.__tryOrSetError=function(e,n,i){if(!ne.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,i)}catch(s){return ne.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=s,e.syncErrorThrown=!0,!0):(Tr(s),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Et);function gl(r){for(;r;){var t=r,e=t.closed,n=t.destination,i=t.isStopped;if(e||i)return!1;n&&n instanceof Et?r=n:r=null}return!0}function ml(r,t,e){if(r){if(r instanceof Et)return r;if(r[$n])return r[$n]()}return!r&&!t&&!e?new Et(Dn):new Et(r,t,e)}var rn=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function bs(r){return r}function yl(r){return r.length===0?bs:r.length===1?r[0]:function(e){return r.reduce(function(n,i){return i(n)},e)}}var yt=function(){function r(t){this._isScalar=!1,t&&(this._subscribe=t)}return r.prototype.lift=function(t){var e=new r;return e.source=this,e.operator=t,e},r.prototype.subscribe=function(t,e,n){var i=this.operator,s=ml(t,e,n);if(i?s.add(i.call(s,this.source)):s.add(this.source||ne.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),ne.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},r.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){ne.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),gl(t)?t.error(e):console.warn(e)}},r.prototype.forEach=function(t,e){var n=this;return e=bo(e),new e(function(i,s){var o;o=n.subscribe(function(c){try{t(c)}catch(l){s(l),o&&o.unsubscribe()}},s,i)})},r.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},r.prototype[rn]=function(){return this},r.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length===0?this:yl(t)(this)},r.prototype.toPromise=function(t){var e=this;return t=bo(t),new t(function(n,i){var s;e.subscribe(function(o){return s=o},function(o){return i(o)},function(){return n(s)})})},r.create=function(t){return new r(t)},r}();function bo(r){if(r||(r=ne.Promise||Promise),!r)throw new Error("no Promise impl found");return r}var bl=function(){function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return r.prototype=Object.create(Error.prototype),r}(),fr=bl,Pa=function(r){K(t,r);function t(e,n){var i=r.call(this)||this;return i.subject=e,i.subscriber=n,i.closed=!1,i}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,n=e.observers;if(this.subject=null,!(!n||n.length===0||e.isStopped||e.closed)){var i=n.indexOf(this.subscriber);i!==-1&&n.splice(i,1)}}},t}(Gt),Ta=function(r){K(t,r);function t(e){var n=r.call(this,e)||this;return n.destination=e,n}return t}(Et),Br=function(r){K(t,r);function t(){var e=r.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return t.prototype[$n]=function(){return new Ta(this)},t.prototype.lift=function(e){var n=new Eo(this,this);return n.operator=e,n},t.prototype.next=function(e){if(this.closed)throw new fr;if(!this.isStopped)for(var n=this.observers,i=n.length,s=n.slice(),o=0;o<i;o++)s[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new fr;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var n=this.observers,i=n.length,s=n.slice(),o=0;o<i;o++)s[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new fr;this.isStopped=!0;for(var e=this.observers,n=e.length,i=e.slice(),s=0;s<n;s++)i[s].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(e){if(this.closed)throw new fr;return r.prototype._trySubscribe.call(this,e)},t.prototype._subscribe=function(e){if(this.closed)throw new fr;return this.hasError?(e.error(this.thrownError),Gt.EMPTY):this.isStopped?(e.complete(),Gt.EMPTY):(this.observers.push(e),new Pa(this,e))},t.prototype.asObservable=function(){var e=new yt;return e.source=this,e},t.create=function(e,n){return new Eo(e,n)},t}(yt),Eo=function(r){K(t,r);function t(e,n){var i=r.call(this)||this;return i.destination=e,i.source=n,i}return t.prototype.next=function(e){var n=this.destination;n&&n.next&&n.next(e)},t.prototype.error=function(e){var n=this.destination;n&&n.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){var n=this.source;return n?this.source.subscribe(e):Gt.EMPTY},t}(Br);function Ia(){return function(t){return t.lift(new El(t))}}var El=function(){function r(t){this.connectable=t}return r.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var i=new vl(t,n),s=e.subscribe(i);return i.closed||(i.connection=n.connect()),s},r}(),vl=function(r){K(t,r);function t(e,n){var i=r.call(this,e)||this;return i.connectable=n,i}return t.prototype._unsubscribe=function(){var e=this.connectable;if(!e){this.connection=null;return}this.connectable=null;var n=e._refCount;if(n<=0){this.connection=null;return}if(e._refCount=n-1,n>1){this.connection=null;return}var i=this.connection,s=e._connection;this.connection=null,s&&(!i||s===i)&&s.unsubscribe()},t}(Et),wl=function(r){K(t,r);function t(e,n){var i=r.call(this)||this;return i.source=e,i.subjectFactory=n,i._refCount=0,i._isComplete=!1,i}return t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,e=this._connection=new Gt,e.add(this.source.subscribe(new _l(this.getSubject(),this))),e.closed&&(this._connection=null,e=Gt.EMPTY)),e},t.prototype.refCount=function(){return Ia()(this)},t}(yt),Al=function(){var r=wl.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:r._subscribe},_isComplete:{value:r._isComplete,writable:!0},getSubject:{value:r.getSubject},connect:{value:r.connect},refCount:{value:r.refCount}}}(),_l=function(r){K(t,r);function t(e,n){var i=r.call(this,e)||this;return i.connectable=n,i}return t.prototype._error=function(e){this._unsubscribe(),r.prototype._error.call(this,e)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),r.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var n=e._connection;e._refCount=0,e._subject=null,e._connection=null,n&&n.unsubscribe()}},t}(Ta),Na=function(r){K(t,r);function t(e){var n=r.call(this)||this;return n._value=e,n}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(e){var n=r.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new fr;return this._value},t.prototype.next=function(e){r.prototype.next.call(this,this._value=e)},t}(Br),Ol=function(r){K(t,r);function t(e,n){return r.call(this)||this}return t.prototype.schedule=function(e,n){return this},t}(Gt),xa=function(r){K(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.pending=!1,i}return t.prototype.schedule=function(e,n){if(n===void 0&&(n=0),this.closed)return this;this.state=e;var i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(s,this.id,n),this},t.prototype.requestAsyncId=function(e,n,i){return i===void 0&&(i=0),setInterval(e.flush.bind(e,this),i)},t.prototype.recycleAsyncId=function(e,n,i){if(i===void 0&&(i=0),i!==null&&this.delay===i&&this.pending===!1)return n;clearInterval(n)},t.prototype.execute=function(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,n){var i=!1,s=void 0;try{this.work(e)}catch(o){i=!0,s=!!o&&o||new Error(o)}if(i)return this.unsubscribe(),s},t.prototype._unsubscribe=function(){var e=this.id,n=this.scheduler,i=n.actions,s=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,s!==-1&&i.splice(s,1),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null},t}(Ol),Rl=function(r){K(t,r);function t(e,n){var i=r.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return t.prototype.schedule=function(e,n){return n===void 0&&(n=0),n>0?r.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},t.prototype.execute=function(e,n){return n>0||this.closed?r.prototype.execute.call(this,e,n):this._execute(e,n)},t.prototype.requestAsyncId=function(e,n,i){return i===void 0&&(i=0),i!==null&&i>0||i===null&&this.delay>0?r.prototype.requestAsyncId.call(this,e,n,i):e.flush(this)},t}(xa),vo=function(){function r(t,e){e===void 0&&(e=r.now),this.SchedulerAction=t,this.now=e}return r.prototype.schedule=function(t,e,n){return e===void 0&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},r.now=function(){return Date.now()},r}(),La=function(r){K(t,r);function t(e,n){n===void 0&&(n=vo.now);var i=r.call(this,e,function(){return t.delegate&&t.delegate!==i?t.delegate.now():n()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return t.prototype.schedule=function(e,n,i){return n===void 0&&(n=0),t.delegate&&t.delegate!==this?t.delegate.schedule(e,n,i):r.prototype.schedule.call(this,e,n,i)},t.prototype.flush=function(e){var n=this.actions;if(this.active){n.push(e);return}var i;this.active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=n.shift());if(this.active=!1,i){for(;e=n.shift();)e.unsubscribe();throw i}},t}(vo),Sl=function(r){K(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(La),Pl=new Sl(Rl),Tl=Pl,Ca=new yt(function(r){return r.complete()});function Es(r){return r?Il(r):Ca}function Il(r){return new yt(function(t){return r.schedule(function(){return t.complete()})})}function Jr(r){return r&&typeof r.schedule=="function"}var Ma=function(r){return function(t){for(var e=0,n=r.length;e<n&&!t.closed;e++)t.next(r[e]);t.complete()}};function vs(r,t){return new yt(function(e){var n=new Gt,i=0;return n.add(t.schedule(function(){if(i===r.length){e.complete();return}e.next(r[i++]),e.closed||n.add(this.schedule())})),n})}function Ba(r,t){return t?vs(r,t):new yt(Ma(r))}function nn(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r[r.length-1];return Jr(e)?(r.pop(),vs(r,e)):Ba(r)}function ws(r,t){return t?new yt(function(e){return t.schedule(Nl,0,{error:r,subscriber:e})}):new yt(function(e){return e.error(r)})}function Nl(r){var t=r.error,e=r.subscriber;e.error(t)}var Di=function(){function r(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue=t==="N"}return r.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},r.prototype.do=function(t,e,n){var i=this.kind;switch(i){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},r.prototype.accept=function(t,e,n){return t&&typeof t.next=="function"?this.observe(t):this.do(t,e,n)},r.prototype.toObservable=function(){var t=this.kind;switch(t){case"N":return nn(this.value);case"E":return ws(this.error);case"C":return Es()}throw new Error("unexpected notification kind value")},r.createNext=function(t){return typeof t<"u"?new r("N",t):r.undefinedValueNotification},r.createError=function(t){return new r("E",void 0,t)},r.createComplete=function(){return r.completeNotification},r.completeNotification=new r("C"),r.undefinedValueNotification=new r("N",void 0),r}(),xl=function(r){K(t,r);function t(e,n,i){i===void 0&&(i=0);var s=r.call(this,e)||this;return s.scheduler=n,s.delay=i,s}return t.dispatch=function(e){var n=e.notification,i=e.destination;n.observe(i),this.unsubscribe()},t.prototype.scheduleMessage=function(e){var n=this.destination;n.add(this.scheduler.schedule(t.dispatch,this.delay,new Ll(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(Di.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(Di.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Di.createComplete()),this.unsubscribe()},t}(Et),Ll=function(){function r(t,e){this.notification=t,this.destination=e}return r}(),kn=function(r){K(t,r);function t(e,n,i){e===void 0&&(e=Number.POSITIVE_INFINITY),n===void 0&&(n=Number.POSITIVE_INFINITY);var s=r.call(this)||this;return s.scheduler=i,s._events=[],s._infiniteTimeWindow=!1,s._bufferSize=e<1?1:e,s._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(s._infiniteTimeWindow=!0,s.next=s.nextInfiniteTimeWindow):s.next=s.nextTimeWindow,s}return t.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}r.prototype.next.call(this,e)},t.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new Cl(this._getNow(),e)),this._trimBufferThenGetEvents()),r.prototype.next.call(this,e)},t.prototype._subscribe=function(e){var n=this._infiniteTimeWindow,i=n?this._events:this._trimBufferThenGetEvents(),s=this.scheduler,o=i.length,c;if(this.closed)throw new fr;if(this.isStopped||this.hasError?c=Gt.EMPTY:(this.observers.push(e),c=new Pa(this,e)),s&&e.add(e=new xl(e,s)),n)for(var l=0;l<o&&!e.closed;l++)e.next(i[l]);else for(var l=0;l<o&&!e.closed;l++)e.next(i[l].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),c},t.prototype._getNow=function(){return(this.scheduler||Tl).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),n=this._bufferSize,i=this._windowTime,s=this._events,o=s.length,c=0;c<o&&!(e-s[c].time<i);)c++;return o>n&&(c=Math.max(c,o-n)),c>0&&s.splice(0,c),s},t}(Br),Cl=function(){function r(t,e){this.time=t,this.value=e}return r}(),Ml=new La(xa),Da=Ml;function Se(){}var Bl=function(){function r(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return r.prototype=Object.create(Error.prototype),r}(),Dl=Bl,$l=function(){function r(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return r.prototype=Object.create(Error.prototype),r}(),$a=$l;function br(r,t){return function(n){if(typeof r!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new kl(r,t))}}var kl=function(){function r(t,e){this.project=t,this.thisArg=e}return r.prototype.call=function(t,e){return e.subscribe(new jl(t,this.project,this.thisArg))},r}(),jl=function(r){K(t,r);function t(e,n,i){var s=r.call(this,e)||this;return s.project=n,s.count=0,s.thisArg=i||s,s}return t.prototype._next=function(e){var n;try{n=this.project.call(this.thisArg,e,this.count++)}catch(i){this.destination.error(i);return}this.destination.next(n)},t}(Et),Vl=function(r){K(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.notifyNext=function(e,n,i,s,o){this.destination.next(n)},t.prototype.notifyError=function(e,n){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Et),Hl=function(r){K(t,r);function t(e,n,i){var s=r.call(this)||this;return s.parent=e,s.outerValue=n,s.outerIndex=i,s.index=0,s}return t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Et),Ul=function(r){return function(t){return r.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,Tr),t}};function Fl(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var oi=Fl(),Gl=function(r){return function(t){var e=r[oi]();do{var n=void 0;try{n=e.next()}catch(i){return t.error(i),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}while(!0);return typeof e.return=="function"&&t.add(function(){e.return&&e.return()}),t}},Kl=function(r){return function(t){var e=r[rn]();if(typeof e.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)}},ka=function(r){return r&&typeof r.length=="number"&&typeof r!="function"};function ja(r){return!!r&&typeof r.subscribe!="function"&&typeof r.then=="function"}var As=function(r){if(!!r&&typeof r[rn]=="function")return Kl(r);if(ka(r))return Ma(r);if(ja(r))return Ul(r);if(!!r&&typeof r[oi]=="function")return Gl(r);var t=Sa(r)?"an invalid object":"'"+r+"'",e="You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(e)};function ql(r,t,e,n,i){if(i===void 0&&(i=new Hl(r,e,n)),!i.closed)return t instanceof yt?t.subscribe(i):As(t)(i)}var wo={};function Ao(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=void 0,n=void 0;return Jr(r[r.length-1])&&(n=r.pop()),typeof r[r.length-1]=="function"&&(e=r.pop()),r.length===1&&ys(r[0])&&(r=r[0]),Ba(r,n).lift(new zl(e))}var zl=function(){function r(t){this.resultSelector=t}return r.prototype.call=function(t,e){return e.subscribe(new Wl(t,this.resultSelector))},r}(),Wl=function(r){K(t,r);function t(e,n){var i=r.call(this,e)||this;return i.resultSelector=n,i.active=0,i.values=[],i.observables=[],i}return t.prototype._next=function(e){this.values.push(wo),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,n=e.length;if(n===0)this.destination.complete();else{this.active=n,this.toRespond=n;for(var i=0;i<n;i++){var s=e[i];this.add(ql(this,s,void 0,i))}}},t.prototype.notifyComplete=function(e){(this.active-=1)===0&&this.destination.complete()},t.prototype.notifyNext=function(e,n,i){var s=this.values,o=s[i],c=this.toRespond?o===wo?--this.toRespond:this.toRespond:0;s[i]=n,c===0&&(this.resultSelector?this._tryResultSelector(s):this.destination.next(s.slice()))},t.prototype._tryResultSelector=function(e){var n;try{n=this.resultSelector.apply(this,e)}catch(i){this.destination.error(i);return}this.destination.next(n)},t}(Vl);function Yl(r,t){return new yt(function(e){var n=new Gt;return n.add(t.schedule(function(){var i=r[rn]();n.add(i.subscribe({next:function(s){n.add(t.schedule(function(){return e.next(s)}))},error:function(s){n.add(t.schedule(function(){return e.error(s)}))},complete:function(){n.add(t.schedule(function(){return e.complete()}))}}))})),n})}function Jl(r,t){return new yt(function(e){var n=new Gt;return n.add(t.schedule(function(){return r.then(function(i){n.add(t.schedule(function(){e.next(i),n.add(t.schedule(function(){return e.complete()}))}))},function(i){n.add(t.schedule(function(){return e.error(i)}))})})),n})}function Xl(r,t){if(!r)throw new Error("Iterable cannot be null");return new yt(function(e){var n=new Gt,i;return n.add(function(){i&&typeof i.return=="function"&&i.return()}),n.add(t.schedule(function(){i=r[oi](),n.add(t.schedule(function(){if(!e.closed){var s,o;try{var c=i.next();s=c.value,o=c.done}catch(l){e.error(l);return}o?e.complete():(e.next(s),this.schedule())}}))})),n})}function Zl(r){return r&&typeof r[rn]=="function"}function Ql(r){return r&&typeof r[oi]=="function"}function th(r,t){if(r!=null){if(Zl(r))return Yl(r,t);if(ja(r))return Jl(r,t);if(ka(r))return vs(r,t);if(Ql(r)||typeof r=="string")return Xl(r,t)}throw new TypeError((r!==null&&typeof r||r)+" is not observable")}function Ar(r,t){return t?th(r,t):r instanceof yt?r:new yt(As(r))}var sn=function(r){K(t,r);function t(e){var n=r.call(this)||this;return n.parent=e,n}return t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(Et),on=function(r){K(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(Et);function an(r,t){if(!t.closed){if(r instanceof yt)return r.subscribe(t);var e;try{e=As(r)(t)}catch(n){t.error(n)}return e}}function _s(r,t,e){return e===void 0&&(e=Number.POSITIVE_INFINITY),typeof t=="function"?function(n){return n.pipe(_s(function(i,s){return Ar(r(i,s)).pipe(br(function(o,c){return t(i,o,s,c)}))},e))}:(typeof t=="number"&&(e=t),function(n){return n.lift(new eh(r,e))})}var eh=function(){function r(t,e){e===void 0&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return r.prototype.call=function(t,e){return e.subscribe(new rh(t,this.project,this.concurrent))},r}(),rh=function(r){K(t,r);function t(e,n,i){i===void 0&&(i=Number.POSITIVE_INFINITY);var s=r.call(this,e)||this;return s.project=n,s.concurrent=i,s.hasCompleted=!1,s.buffer=[],s.active=0,s.index=0,s}return t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var n,i=this.index++;try{n=this.project(e,i)}catch(s){this.destination.error(s);return}this.active++,this._innerSub(n)},t.prototype._innerSub=function(e){var n=new sn(this),i=this.destination;i.add(n);var s=an(e,n);s!==n&&i.add(s)},t.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},t}(on);function nh(r){return r===void 0&&(r=Number.POSITIVE_INFINITY),_s(bs,r)}function ih(){return nh(1)}function Xi(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return ih()(nn.apply(void 0,r))}function Va(r){return new yt(function(t){var e;try{e=r()}catch(i){t.error(i);return}var n=e?Ar(e):Es();return n.subscribe(t)})}function _o(r){return!ys(r)&&r-parseFloat(r)+1>=0}var sh=new yt(Se);function jn(r,t){return function(n){return n.lift(new oh(r,t))}}var oh=function(){function r(t,e){this.predicate=t,this.thisArg=e}return r.prototype.call=function(t,e){return e.subscribe(new ah(t,this.predicate,this.thisArg))},r}(),ah=function(r){K(t,r);function t(e,n,i){var s=r.call(this,e)||this;return s.predicate=n,s.thisArg=i,s.count=0,s}return t.prototype._next=function(e){var n;try{n=this.predicate.call(this.thisArg,e,this.count++)}catch(i){this.destination.error(i);return}n&&this.destination.next(e)},t}(Et);function ch(r,t,e){return r===void 0&&(r=0),new yt(function(n){t===void 0&&(t=r,r=0);var i=0,s=r;if(e)return e.schedule(uh,0,{index:i,count:t,start:r,subscriber:n});do{if(i++>=t){n.complete();break}if(n.next(s++),n.closed)break}while(!0)})}function uh(r){var t=r.start,e=r.index,n=r.count,i=r.subscriber;if(e>=n){i.complete();return}i.next(t),!i.closed&&(r.index=e+1,r.start=t+1,this.schedule(r))}function Oo(r,t,e){r===void 0&&(r=0);var n=-1;return _o(t)?n=Number(t)<1&&1||Number(t):Jr(t)&&(e=t),Jr(e)||(e=Da),new yt(function(i){var s=_o(r)?r:+r-e.now();return e.schedule(lh,s,{index:0,period:n,subscriber:i})})}function lh(r){var t=r.index,e=r.period,n=r.subscriber;if(n.next(t),!n.closed){if(e===-1)return n.complete();r.index=t+1,this.schedule(r,e)}}function Os(r){return function(e){var n=new hh(r),i=e.lift(n);return n.caught=i}}var hh=function(){function r(t){this.selector=t}return r.prototype.call=function(t,e){return e.subscribe(new fh(t,this.selector,this.caught))},r}(),fh=function(r){K(t,r);function t(e,n,i){var s=r.call(this,e)||this;return s.selector=n,s.caught=i,s}return t.prototype.error=function(e){if(!this.isStopped){var n=void 0;try{n=this.selector(e,this.caught)}catch(o){r.prototype.error.call(this,o);return}this._unsubscribeAndRecycle();var i=new sn(this);this.add(i);var s=an(n,i);s!==i&&this.add(s)}},t}(on);function Ha(r,t){return _s(r,t,1)}function ph(r){return r===void 0&&(r=null),function(t){return t.lift(new dh(r))}}var dh=function(){function r(t){this.defaultValue=t}return r.prototype.call=function(t,e){return e.subscribe(new gh(t,this.defaultValue))},r}(),gh=function(r){K(t,r);function t(e,n){var i=r.call(this,e)||this;return i.defaultValue=n,i.isEmpty=!0,i}return t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(Et);function mh(r){return r instanceof Date&&!isNaN(+r)}function Ua(r,t){return function(e){return e.lift(new yh(r,t))}}var yh=function(){function r(t,e){this.compare=t,this.keySelector=e}return r.prototype.call=function(t,e){return e.subscribe(new bh(t,this.compare,this.keySelector))},r}(),bh=function(r){K(t,r);function t(e,n,i){var s=r.call(this,e)||this;return s.keySelector=i,s.hasKey=!1,typeof n=="function"&&(s.compare=n),s}return t.prototype.compare=function(e,n){return e===n},t.prototype._next=function(e){var n;try{var i=this.keySelector;n=i?i(e):e}catch(c){return this.destination.error(c)}var s=!1;if(this.hasKey)try{var o=this.compare;s=o(this.key,n)}catch(c){return this.destination.error(c)}else this.hasKey=!0;s||(this.key=n,this.destination.next(e))},t}(Et);function Eh(r,t){return Ua(function(e,n){return t?t(e[r],n[r]):e[r]===n[r]})}function vh(r){return r===void 0&&(r=_h),function(t){return t.lift(new wh(r))}}var wh=function(){function r(t){this.errorFactory=t}return r.prototype.call=function(t,e){return e.subscribe(new Ah(t,this.errorFactory))},r}(),Ah=function(r){K(t,r);function t(e,n){var i=r.call(this,e)||this;return i.errorFactory=n,i.hasValue=!1,i}return t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(n){e=n}this.destination.error(e)},t}(Et);function _h(){return new $a}function Oh(r){return function(t){return r===0?Es():t.lift(new Rh(r))}}var Rh=function(){function r(t){if(this.total=t,this.total<0)throw new Dl}return r.prototype.call=function(t,e){return e.subscribe(new Sh(t,this.total))},r}(),Sh=function(r){K(t,r);function t(e,n){var i=r.call(this,e)||this;return i.total=n,i.count=0,i}return t.prototype._next=function(e){var n=this.total,i=++this.count;i<=n&&(this.destination.next(e),i===n&&(this.destination.complete(),this.unsubscribe()))},t}(Et);function ke(r,t){var e=arguments.length>=2;return function(n){return n.pipe(r?jn(function(i,s){return r(i,s,n)}):bs,Oh(1),e?ph(t):vh(function(){return new $a}))}}function Ro(r,t){return function(n){var i;if(typeof r=="function"?i=r:i=function(){return r},typeof t=="function")return n.lift(new Ph(i,t));var s=Object.create(n,Al);return s.source=n,s.subjectFactory=i,s}}var Ph=function(){function r(t,e){this.subjectFactory=t,this.selector=e}return r.prototype.call=function(t,e){var n=this.selector,i=this.subjectFactory(),s=n(i).subscribe(t);return s.add(e.subscribe(i)),s},r}();function So(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r.length;if(e===0)throw new Error("list of properties cannot be empty.");return function(n){return br(Th(r,e))(n)}}function Th(r,t){var e=function(n){for(var i=n,s=0;s<t;s++){var o=i!=null?i[r[s]]:void 0;if(o!==void 0)i=o;else return}return i};return e}function Ih(r){return r?Ro(function(){return new Br},r):Ro(new Br)}function Fa(r){return r===void 0&&(r=-1),function(t){return t.lift(new Nh(r,t))}}var Nh=function(){function r(t,e){this.count=t,this.source=e}return r.prototype.call=function(t,e){return e.subscribe(new xh(t,this.count,this.source))},r}(),xh=function(r){K(t,r);function t(e,n,i){var s=r.call(this,e)||this;return s.count=n,s.source=i,s}return t.prototype.error=function(e){if(!this.isStopped){var n=this,i=n.source,s=n.count;if(s===0)return r.prototype.error.call(this,e);s>-1&&(this.count=s-1),i.subscribe(this._unsubscribeAndRecycle())}},t}(Et);function Xr(r,t,e){var n;return r&&typeof r=="object"?n=r:n={bufferSize:r,windowTime:t,refCount:!1,scheduler:e},function(i){return i.lift(Lh(n))}}function Lh(r){var t=r.bufferSize,e=t===void 0?Number.POSITIVE_INFINITY:t,n=r.windowTime,i=n===void 0?Number.POSITIVE_INFINITY:n,s=r.refCount,o=r.scheduler,c,l=0,m,y=!1,v=!1;return function(T){l++;var D;!c||y?(y=!1,c=new kn(e,i,o),D=c.subscribe(this),m=T.subscribe({next:function(W){c.next(W)},error:function(W){y=!0,c.error(W)},complete:function(){v=!0,m=void 0,c.complete()}}),v&&(m=void 0)):D=c.subscribe(this),this.add(function(){l--,D.unsubscribe(),D=void 0,m&&!v&&s&&l===0&&(m.unsubscribe(),m=void 0,c=void 0)})}}function Ch(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var e=r[r.length-1];return Jr(e)?(r.pop(),function(n){return Xi(r,n,e)}):function(n){return Xi(r,n)}}function Er(r,t){return typeof t=="function"?function(e){return e.pipe(Er(function(n,i){return Ar(r(n,i)).pipe(br(function(s,o){return t(n,s,i,o)}))}))}:function(e){return e.lift(new Mh(r))}}var Mh=function(){function r(t){this.project=t}return r.prototype.call=function(t,e){return e.subscribe(new Bh(t,this.project))},r}(),Bh=function(r){K(t,r);function t(e,n){var i=r.call(this,e)||this;return i.project=n,i.index=0,i}return t.prototype._next=function(e){var n,i=this.index++;try{n=this.project(e,i)}catch(s){this.destination.error(s);return}this._innerSub(n)},t.prototype._innerSub=function(e){var n=this.innerSubscription;n&&n.unsubscribe();var i=new sn(this),s=this.destination;s.add(i),this.innerSubscription=an(e,i),this.innerSubscription!==i&&s.add(this.innerSubscription)},t.prototype._complete=function(){var e=this.innerSubscription;(!e||e.closed)&&r.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&r.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(on);function Dh(r){return function(t){return t.lift(new $h(r))}}var $h=function(){function r(t){this.notifier=t}return r.prototype.call=function(t,e){var n=new kh(t),i=an(this.notifier,new sn(n));return i&&!n.seenValue?(n.add(i),e.subscribe(n)):n},r}(),kh=function(r){K(t,r);function t(e){var n=r.call(this,e)||this;return n.seenValue=!1,n}return t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(on);function jh(r,t){return t===void 0&&(t=!1),function(e){return e.lift(new Vh(r,t))}}var Vh=function(){function r(t,e){this.predicate=t,this.inclusive=e}return r.prototype.call=function(t,e){return e.subscribe(new Hh(t,this.predicate,this.inclusive))},r}(),Hh=function(r){K(t,r);function t(e,n,i){var s=r.call(this,e)||this;return s.predicate=n,s.inclusive=i,s.index=0,s}return t.prototype._next=function(e){var n=this.destination,i;try{i=this.predicate(e,this.index++)}catch(s){n.error(s);return}this.nextOrComplete(e,i)},t.prototype.nextOrComplete=function(e,n){var i=this.destination;Boolean(n)?i.next(e):(this.inclusive&&i.next(e),i.complete())},t}(Et);function Zi(r,t,e){return function(i){return i.lift(new Uh(r,t,e))}}var Uh=function(){function r(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return r.prototype.call=function(t,e){return e.subscribe(new Fh(t,this.nextOrObserver,this.error,this.complete))},r}(),Fh=function(r){K(t,r);function t(e,n,i,s){var o=r.call(this,e)||this;return o._tapNext=Se,o._tapError=Se,o._tapComplete=Se,o._tapError=i||Se,o._tapComplete=s||Se,Bn(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||Se,o._tapError=n.error||Se,o._tapComplete=n.complete||Se),o}return t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(n){this.destination.error(n);return}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(n){this.destination.error(n);return}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){this.destination.error(e);return}return this.destination.complete()},t}(Et);function Ga(r,t,e){return e===void 0&&(e=Da),function(n){var i=mh(r),s=i?+r-e.now():Math.abs(r);return n.lift(new Gh(s,i,t,e))}}var Gh=function(){function r(t,e,n,i){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=i}return r.prototype.call=function(t,e){return e.subscribe(new Kh(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},r}(),Kh=function(r){K(t,r);function t(e,n,i,s,o){var c=r.call(this,e)||this;return c.absoluteTimeout=n,c.waitFor=i,c.withObservable=s,c.scheduler=o,c.scheduleTimeout(),c}return t.dispatchTimeout=function(e){var n=e.withObservable;e._unsubscribeAndRecycle(),e.add(an(n,new sn(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),r.prototype._next.call(this,e)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(on),qh=function(r,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var e=typeof t.cycles=="boolean"?t.cycles:!1,n=t.cmp&&function(s){return function(o){return function(c,l){var m={key:c,value:o[c]},y={key:l,value:o[l]};return s(m,y)}}}(t.cmp),i=[];return function s(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var c,l;if(Array.isArray(o)){for(l="[",c=0;c<o.length;c++)c&&(l+=","),l+=s(o[c])||"null";return l+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(e)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var m=i.push(o)-1,y=Object.keys(o).sort(n&&n(o));for(l="",c=0;c<y.length;c++){var v=y[c],P=s(o[v]);!P||(l&&(l+=","),l+=JSON.stringify(v)+":"+P)}return i.splice(m,1),"{"+l+"}"}}(r)},Ka;class zh extends Error{constructor(t){super(`The map type '${t}' is invalid`),this.mapType=t,this.name="InvalidMapTypeError"}}const qa=Symbol.for("taquito-michelson-map-type-symbol"),Wh=r=>"args"in r&&Array.isArray(r.args)&&r.args.length===2;class Po extends Error{constructor(t,e,n){super(`${n} not compliant with underlying michelson type`),this.value=t,this.type=e,this.name="MapTypecheckError"}}class Vt{constructor(t){this.valueMap=new Map,this.keyMap=new Map,this[Ka]=!0,t&&this.setType(t)}static isMichelsonMap(t){return t&&t[qa]===!0}setType(t){if(!Wh(t))throw new zh(t.toString());this.keySchema=new Ht(t.args[0]),this.valueSchema=new Ht(t.args[1])}removeType(){this.keySchema=void 0,this.valueSchema=void 0}static fromLiteral(t,e){const n=new Vt(e);return Object.keys(t).forEach(i=>{n.set(i,t[i])}),n}typecheckKey(t){return this.keySchema?this.keySchema.Typecheck(t):!0}typecheckValue(t){return this.valueSchema?this.valueSchema.Typecheck(t):!0}assertTypecheckValue(t){if(!this.typecheckValue(t))throw new Po(t,this.valueSchema,"value")}assertTypecheckKey(t){if(!this.typecheckKey(t))throw new Po(t,this.keySchema,"key")}serializeDeterministically(t){return qh(t)}*keys(){for(const[t]of this.entries())yield t}*values(){for(const[,t]of this.entries())yield t}*entries(){for(const t of this.valueMap.keys())yield[this.keyMap.get(t),this.valueMap.get(t)]}get(t){this.assertTypecheckKey(t);const e=this.serializeDeterministically(t);return this.valueMap.get(e)}set(t,e){this.assertTypecheckKey(t),this.assertTypecheckValue(e);const n=this.serializeDeterministically(t);this.keyMap.set(n,t),this.valueMap.set(n,e)}delete(t){this.assertTypecheckKey(t),this.keyMap.delete(this.serializeDeterministically(t)),this.valueMap.delete(this.serializeDeterministically(t))}has(t){this.assertTypecheckKey(t);const e=this.serializeDeterministically(t);return this.keyMap.has(e)&&this.valueMap.has(e)}clear(){this.keyMap.clear(),this.valueMap.clear()}get size(){return this.keyMap.size}forEach(t){for(const[e,n]of this.entries())t(n,e,this)}}Ka=qa;class rt extends Error{constructor(t,e,n){super(),this.value=t,this.token=e,this.name="ValidationError";const i=this.token.annot(),s=i?`[${i}] `:"";this.message=`${s}${n}`}}class Ot{constructor(t,e,n){this.val=t,this.idx=e,this.fac=n,this.createToken=this.fac}typeWithoutAnnotations(){const t=n=>{if(typeof n=="object"){if(Array.isArray(n))return n.map(o=>t(o));const i=n;return i.args?{prim:i.prim,args:i.args.map(s=>t(s))}:{prim:i.prim}}return n};return(n=>n.args?{prim:n.prim,args:n.args.map(i=>t(i))}:{prim:n.prim})(this.val)}annot(){return(Array.isArray(this.val.annots)&&this.val.annots.length>0?this.val.annots[0]:String(this.idx)).replace(/(%|:)(_Liq_entry_)?/,"")}hasAnnotations(){return Array.isArray(this.val.annots)&&this.val.annots.length}get tokenVal(){return this.val}ExtractSignature(){return[[this.ExtractSchema()]]}}class mt extends Ot{compare(t,e){return t===e?0:t<e?-1:1}}class To extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="BigMapValidationError"}}class Jt extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}get ValueSchema(){return this.createToken(this.val.args[1],0)}get KeySchema(){return this.createToken(this.val.args[0],0)}ExtractSchema(){return{big_map:{key:this.KeySchema.ExtractSchema(),value:this.ValueSchema.ExtractSchema()}}}generateSchema(){return{__michelsonType:Jt.prim,schema:{key:this.KeySchema.generateSchema(),value:this.ValueSchema.generateSchema()}}}isValid(t){return Vt.isMichelsonMap(t)?null:new To(t,this,"Value must be a MichelsonMap")}objLitToMichelsonMap(t){return t instanceof Vt?t:typeof t=="object"?Object.keys(t).length===0?new Vt:Vt.fromLiteral(t):t}Encode(t){const e=this.objLitToMichelsonMap(t.pop()),n=this.isValid(e);if(n)throw n;return Array.from(e.keys()).sort((i,s)=>this.KeySchema.compare(i,s)).map(i=>({prim:"Elt",args:[this.KeySchema.EncodeObject(i),this.ValueSchema.EncodeObject(e.get(i))]}))}EncodeObject(t,e){const n=this.objLitToMichelsonMap(t),i=this.isValid(n);if(i)throw i;return e&&e[Jt.prim]?e[Jt.prim](n,this.val):Array.from(n.keys()).sort((s,o)=>this.KeySchema.compare(s,o)).map(s=>({prim:"Elt",args:[this.KeySchema.EncodeObject(s),this.ValueSchema.EncodeObject(n.get(s))]}))}Execute(t,e){if(e&&e[Jt.prim])return e[Jt.prim](t,this.val);if(Array.isArray(t)){const n=new Vt(this.val);return t.forEach(i=>{n.set(this.KeySchema.ToKey(i.args[0]),this.ValueSchema.Execute(i.args[1]))}),n}else{if("int"in t)return t.int;throw new To(t,this,`Big map is expecting either an array (Athens) or an object with an int property (Babylon). Got ${JSON.stringify(t)}`)}}findAndReturnTokens(t,e){return Jt.prim===t&&e.push(this),this.KeySchema.findAndReturnTokens(t,e),this.ValueSchema.findAndReturnTokens(t,e),e}}Jt.prim="big_map";class Yh extends Error{constructor(t){super(t),this.message=t,this.name="OrTokenDecodingError"}}class z extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Encode(t){const e=t[t.length-1],n=this.createToken(this.val.args[0],this.idx);let i=1;n instanceof z&&(i=Object.keys(n.ExtractSchema()).length);const s=this.createToken(this.val.args[1],this.idx+i);if(String(n.annot())===String(e)&&!(n instanceof z))return t.pop(),{prim:"Left",args:[n.Encode(t)]};if(String(s.annot())===String(e)&&!(s instanceof z))return t.pop(),{prim:"Right",args:[s.Encode(t)]};if(n instanceof z){const o=n.Encode(t);if(o)return{prim:"Left",args:[o]}}if(s instanceof z){const o=s.Encode(t);if(o)return{prim:"Right",args:[o]}}return null}ExtractSignature(){const t=this.createToken(this.val.args[0],this.idx);let e=1;t instanceof z&&(e=Object.keys(t.ExtractSchema()).length);const n=this.createToken(this.val.args[1],this.idx+e),i=[];if(t instanceof z)i.push(...t.ExtractSignature());else for(const s of t.ExtractSignature())i.push([t.annot(),...s]);if(n instanceof z)i.push(...n.ExtractSignature());else for(const s of n.ExtractSignature())i.push([n.annot(),...s]);return i}EncodeObject(t,e){const n=Object.keys(t)[0],i=this.createToken(this.val.args[0],this.idx);let s=1;i instanceof z&&(s=Object.keys(i.ExtractSchema()).length);const o=this.createToken(this.val.args[1],this.idx+s);if(String(i.annot())===String(n)&&!(i instanceof z))return{prim:"Left",args:[i.EncodeObject(t[n],e)]};if(String(o.annot())===String(n)&&!(o instanceof z))return{prim:"Right",args:[o.EncodeObject(t[n],e)]};if(i instanceof z){const c=i.EncodeObject(t,e);if(c)return{prim:"Left",args:[c]}}if(o instanceof z){const c=o.EncodeObject(t,e);if(c)return{prim:"Right",args:[c]}}return null}Execute(t,e){const n=this.createToken(this.val.args[0],this.idx);let i=1;n instanceof z&&(i=Object.keys(n.ExtractSchema()).length);const s=this.createToken(this.val.args[1],this.idx+i);if(t.prim==="Right")return s instanceof z?s.Execute(t.args[0],e):{[s.annot()]:s.Execute(t.args[0],e)};if(t.prim==="Left")return n instanceof z?n.Execute(t.args[0],e):{[n.annot()]:n.Execute(t.args[0],e)};throw new Yh(`Was expecting Left or Right prim but got: ${t.prim}`)}traversal(t,e,n){const i=this.createToken(this.val.args[0],this.idx);let s=1,o;i instanceof z&&!i.hasAnnotations()?(o=t(i),s=Object.keys(i.ExtractSchema()).length):o={[i.annot()]:t(i)};const c=this.createToken(this.val.args[1],this.idx+s);let l;return c instanceof z&&!c.hasAnnotations()?l=e(c):l={[c.annot()]:e(c)},n(o,l)}ExtractSchema(){return this.traversal(t=>t.ExtractSchema(),t=>t.ExtractSchema(),(t,e)=>Object.assign(Object.assign({},t),e))}generateSchema(){return{__michelsonType:z.prim,schema:this.traversal(t=>t instanceof z&&!t.hasAnnotations()?t.generateSchema().schema:t.generateSchema(),t=>t instanceof z&&!t.hasAnnotations()?t.generateSchema().schema:t.generateSchema(),(t,e)=>Object.assign(Object.assign({},t),e))}}findToken(t){const e=this.createToken(this.val.args[0],this.idx);let n=1;e instanceof z&&(n=Object.keys(e.ExtractSchema()).length);const i=this.createToken(this.val.args[1],this.idx+n);if(String(e.annot())===String(t)&&!(e instanceof z)&&e instanceof mt)return e;if(String(i.annot())===String(t)&&!(i instanceof z)&&i instanceof mt)return i;if(e instanceof z){const s=e.findToken(t);if(s)return s}if(i instanceof z){const s=i.findToken(t);if(s)return s}return null}compare(t,e){const n=Object.keys(t)[0],i=Object.keys(e)[0];if(n===i){const s=this.findToken(n);if(s instanceof mt)return s.compare(t[n],e[n])}else{const s=JSON.stringify(this.EncodeObject(t)),o=JSON.stringify(this.EncodeObject(e));return s<o?-1:1}}ToKey(t){return this.Execute(t)}ToBigMapKey(t){return{key:this.EncodeObject(t),type:this.typeWithoutAnnotations()}}findAndReturnTokens(t,e){return z.prim===t&&e.push(this),this.traversal(n=>n.findAndReturnTokens(t,e),n=>n.findAndReturnTokens(t,e),(n,i)=>Object.assign(Object.assign({},n),i)),e}}z.prim="or";class Jh extends Error{constructor(t){super(t),this.message=t,this.name="TokenArgumentValidationError"}}class Xh extends Error{constructor(t,e){super(`Tokens ${t} and ${e} are not comparable`),this.val1=t,this.val2=e,this.name="TokenComparisonError"}}function Qi(r,t=vt.prim){if(Array.isArray(r))return Qi({prim:t,args:r},t);if(r.args===void 0)throw new Jh("Encountered an invalid PairToken with no arguments, a pair must have two or more arguments");return r.args.length>2?[r.args[0],{prim:t,args:r.args.slice(1)}]:[r.args[0],r.args[1]]}class vt extends mt{constructor(t,e,n){super(Array.isArray(t)?{prim:vt.prim,args:t}:t.prim?t:{prim:vt.prim,args:t},e,n)}args(){return Qi(this.val)}tokens(){let t=0;return this.args().map(e=>{const n=this.createToken(e,this.idx+t);return n instanceof vt?t+=Object.keys(n.ExtractSchema()).length:t++,n})}Encode(t){return{prim:"Pair",args:this.tokens().map(e=>e.Encode(t))}}ExtractSignature(){const t=this.args(),e=this.createToken(t[0],this.idx);let n=1;e instanceof z&&(n=Object.keys(e.ExtractSchema()).length);const i=this.createToken(t[1],this.idx+n),s=[];for(const o of e.ExtractSignature())for(const c of i.ExtractSignature())s.push([...o,...c]);return s}ToBigMapKey(t){return{key:this.EncodeObject(t),type:this.typeWithoutAnnotations()}}ToKey(t){return this.Execute(t)}EncodeObject(t,e){const[n,i]=this.tokens();let s;n instanceof vt&&!n.hasAnnotations()?s=t:s=t[n.annot()];let o;return i instanceof vt&&!i.hasAnnotations()?o=t:o=t[i.annot()],{prim:"Pair",args:[n.EncodeObject(s,e),i.EncodeObject(o,e)]}}traversal(t,e){const n=this.args(),i=this.createToken(n[0],this.idx);let s=1,o;i instanceof vt&&(s=Object.keys(i.ExtractSchema()).length),i instanceof vt&&!i.hasAnnotations()?o=t(i):o={[i.annot()]:t(i)};const c=this.createToken(n[1],this.idx+s);let l;return c instanceof vt&&!c.hasAnnotations()?l=e(c):l={[c.annot()]:e(c)},Object.assign(Object.assign({},o),l)}Execute(t,e){const n=Qi(t,"Pair");return this.traversal(i=>i.Execute(n[0],e),i=>i.Execute(n[1],e))}ExtractSchema(){return this.traversal(t=>t.ExtractSchema(),t=>t.ExtractSchema())}generateSchema(){return{__michelsonType:vt.prim,schema:this.traversal(t=>t instanceof vt&&!t.hasAnnotations()?t.generateSchema().schema:t.generateSchema(),t=>t instanceof vt&&!t.hasAnnotations()?t.generateSchema().schema:t.generateSchema())}}compare(t,e){const[n,i]=this.tokens(),s=(o,c)=>o instanceof vt&&!o.hasAnnotations()?c:c[o.annot()];if(n instanceof mt&&i instanceof mt){const o=n.compare(s(n,t),s(n,e));return o===0?i.compare(s(i,t),s(i,e)):o}throw new Xh(t,e)}findAndReturnTokens(t,e){return vt.prim===t&&e.push(this),this.tokens().map(n=>n.findAndReturnTokens(t,e)),e}}vt.prim="pair";class Io extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="NatValidationError"}}class ce extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return new G(t[Object.keys(t)[0]])}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{int:new G(e).toFixed()}}isValid(t){const e=new G(t);return e.isNaN()?new Io(t,this,`Value is not a number: ${t}`):e.isNegative()?new Io(t,this,`Value cannot be negative: ${t}`):null}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[ce.prim]?e[ce.prim](t):{int:new G(t).toFixed()}}ExtractSchema(){return ce.prim}generateSchema(){return{__michelsonType:ce.prim,schema:ce.prim}}ToBigMapKey(t){return{key:{int:String(t)},type:{prim:ce.prim}}}ToKey({int:t}){return new G(t)}compare(t,e){const n=Number(t),i=Number(e);return n===i?0:n<i?-1:1}findAndReturnTokens(t,e){return ce.prim===t&&e.push(this),e}}ce.prim="nat";class ue extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return t[Object.keys(t)[0]]}ExtractSchema(){return ue.prim}generateSchema(){return{__michelsonType:ue.prim,schema:ue.prim}}Encode(t){return{string:t.pop()}}EncodeObject(t,e){return e&&e[ue.prim]?e[ue.prim](t):{string:t}}ToKey({string:t}){return t}ToBigMapKey(t){return{key:{string:t},type:{prim:ue.prim}}}findAndReturnTokens(t,e){return ue.prim===t&&e.push(this),e}}ue.prim="string";class $i extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="AddressValidationError"}}class Pe extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}ToBigMapKey(t){return{key:{bytes:nu(t)},type:{prim:"bytes"}}}isValid(t){return pt(t)!==U.VALID?new $i(t,this,`Address is not valid: ${t}`):null}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{string:e}}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[Pe.prim]?e[Pe.prim](t):{string:t}}Execute(t){if(t.string)return t.string;if(!t.bytes)throw new $i(t,this,`cannot be missing both string and bytes: ${t}`);return zi(t.bytes)}ExtractSchema(){return Pe.prim}generateSchema(){return{__michelsonType:Pe.prim,schema:Pe.prim}}ToKey({bytes:t,string:e}){if(e)return e;if(!t)throw new $i({bytes:t,string:e},this,`cannot be missing both string and bytes ${{string:e,bytes:t}}`);return zi(t)}compare(t,e){const n=o=>o.startsWith("tz"),i=n(t),s=n(e);return i&&!s?-1:s&&!i?1:super.compare(t,e)}findAndReturnTokens(t,e){return Pe.prim===t&&e.push(this),e}}Pe.prim="address";class Zh extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="MapValidationError"}}class mr extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}get ValueSchema(){return this.createToken(this.val.args[1],0)}get KeySchema(){return this.createToken(this.val.args[0],0)}isValid(t){return Vt.isMichelsonMap(t)?null:new Zh(t,this,"Value must be a MichelsonMap")}Execute(t,e){const n=new Vt(this.val);return t.forEach(i=>{n.set(this.KeySchema.ToKey(i.args[0]),this.ValueSchema.Execute(i.args[1],e))}),n}objLitToMichelsonMap(t){return t instanceof Vt?t:typeof t=="object"?Object.keys(t).length===0?new Vt:Vt.fromLiteral(t):t}Encode(t){const e=this.objLitToMichelsonMap(t.pop()),n=this.isValid(e);if(n)throw n;return Array.from(e.keys()).sort((i,s)=>this.KeySchema.compare(i,s)).map(i=>({prim:"Elt",args:[this.KeySchema.EncodeObject(i),this.ValueSchema.EncodeObject(e.get(i))]}))}EncodeObject(t,e){const n=this.objLitToMichelsonMap(t),i=this.isValid(n);if(i)throw i;return e&&e[mr.prim]?e[mr.prim](n):Array.from(n.keys()).sort((s,o)=>this.KeySchema.compare(s,o)).map(s=>({prim:"Elt",args:[this.KeySchema.EncodeObject(s),this.ValueSchema.EncodeObject(n.get(s))]}))}ExtractSchema(){return{map:{key:this.KeySchema.ExtractSchema(),value:this.ValueSchema.ExtractSchema()}}}generateSchema(){return{__michelsonType:mr.prim,schema:{key:this.KeySchema.generateSchema(),value:this.ValueSchema.generateSchema()}}}findAndReturnTokens(t,e){return mr.prim===t&&e.push(this),this.KeySchema.findAndReturnTokens(t,e),this.ValueSchema.findAndReturnTokens(t,e),e}}mr.prim="map";class le extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return String(t.prim).toLowerCase()==="true"}Encode(t){return{prim:t.pop()?"True":"False"}}EncodeObject(t,e){return e&&e[le.prim]?e[le.prim](t):{prim:t?"True":"False"}}ExtractSchema(){return le.prim}generateSchema(){return{__michelsonType:le.prim,schema:le.prim}}ToBigMapKey(t){return{key:this.EncodeObject(t),type:{prim:le.prim}}}ToKey(t){return this.EncodeObject(t)}compare(t,e){return t&&e||!t&&!e?0:t?1:-1}findAndReturnTokens(t,e){return le.prim===t&&e.push(this),e}}le.prim="bool";class An extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="TxRollupL2AddressValidationError"}}class Te extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}ToBigMapKey(t){return{key:{bytes:iu(t)},type:{prim:"bytes"}}}isValid(t){if(pt(t)!==U.VALID)throw new An(t,this,`tx_rollup_l2_address is not valid: ${t}`);return null}Encode(t){const e=t.pop();if(!e)throw new An(e,this,`arg missing to encode: this -> "${e}"`);return this.isValid(e),{string:e}}EncodeObject(t,e){return this.isValid(t),e&&e[Te.prim]?e[Te.prim](t):{string:t}}Execute(t){if(t.string)return t.string;if(!t.bytes)throw new An(t,this,`value cannot be missing string and byte value. must have one ${JSON.stringify(t)}`);return $s(t.bytes)}ExtractSchema(){return Te.prim}generateSchema(){return{__michelsonType:Te.prim,schema:Te.prim}}ToKey({bytes:t,string:e}){if(e)return e;if(!t)throw new An(t,this,`value cannot be missing string and byte value. must have one: bytes = ${t}`);return $s(t)}findAndReturnTokens(t,e){return Te.prim===t&&e.push(this),e}}Te.prim="tx_rollup_l2_address";class No extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="ContractValidationError"}}class ie extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}isValid(t){return pt(t)!==U.VALID?new No(t,this,"Contract address is not valid"):null}Execute(t){if(t.string)return t.string;if(!t.bytes)throw new No(t,this,"must contain bytes or string");return zi(t.bytes)}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{string:e}}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[ie.prim]?e[ie.prim](t):{string:t}}ExtractSchema(){return ie.prim}generateSchema(){const t=this.createToken(this.val.args[0],0);return{__michelsonType:ie.prim,schema:{parameter:this.val.args[0]?t.generateSchema():{}}}}findAndReturnTokens(t,e){return ie.prim===t&&e.push(this),e}}ie.prim="contract";class Qh extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="ListValidationError"}}class Ye extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}get valueSchema(){return this.createToken(this.val.args[0],this.idx)}isValid(t){return Array.isArray(t)?null:new Qh(t,this,"Value must be an array")}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;const i=this.createToken(this.val.args[0],0);return e.reduce((s,o)=>[...s,i.EncodeObject(o)],[])}Execute(t,e){const n=this.createToken(this.val.args[0],0),i=this.isValid(t);if(i)throw i;return t.reduce((s,o)=>[...s,n.Execute(o,e)],[])}EncodeObject(t,e){const n=this.createToken(this.val.args[0],0),i=this.isValid(t);if(i)throw i;return e&&e[Ye.prim]?e[Ye.prim](t):t.reduce((s,o)=>[...s,n.EncodeObject(o)],[])}ExtractSchema(){return{[Ye.prim]:this.valueSchema.ExtractSchema()}}generateSchema(){return{__michelsonType:Ye.prim,schema:this.valueSchema.generateSchema()}}findAndReturnTokens(t,e){return Ye.prim===t&&e.push(this),this.createToken(this.val.args[0],this.idx).findAndReturnTokens(t,e),e}}Ye.prim="list";class tf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="MutezValidationError"}}class he extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return new G(t[Object.keys(t)[0]])}ExtractSchema(){return he.prim}generateSchema(){return{__michelsonType:he.prim,schema:he.prim}}isValid(t){return new G(t).isNaN()?new tf(t,this,`Value is not a number: ${t}`):null}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{int:String(e).toString()}}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[he.prim]?e[he.prim](t):{int:String(t).toString()}}ToBigMapKey(t){return{key:{int:String(t)},type:{prim:he.prim}}}ToKey({int:t}){return t}compare(t,e){const n=Number(t),i=Number(e);return n===i?0:n<i?-1:1}findAndReturnTokens(t,e){return he.prim===t&&e.push(this),e}}he.prim="mutez";class ef extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="BytesValidationError"}}class fe extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}ToBigMapKey(t){return{key:{bytes:t},type:{prim:fe.prim}}}isValid(t){return typeof t=="string"&&/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new ef(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let e=t.pop();e=this.convertUint8ArrayToHexString(e);const n=this.isValid(e);if(n)throw n;return{bytes:String(e).toString()}}EncodeObject(t,e){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return e&&e[fe.prim]?e[fe.prim](t):{bytes:String(t).toString()}}Execute(t){return t.bytes}ExtractSchema(){return fe.prim}generateSchema(){return{__michelsonType:fe.prim,schema:fe.prim}}ToKey({bytes:t,string:e}){return e||t}findAndReturnTokens(t,e){return fe.prim===t&&e.push(this),e}}fe.prim="bytes";class Dr extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}subToken(){return this.createToken(this.val.args[0],this.idx)}schema(){return this.createToken(this.val.args[0],0)}annot(){return Array.isArray(this.val.annots)?super.annot():this.createToken(this.val.args[0],this.idx).annot()}Encode(t){const e=t;return e==null?{prim:"None"}:Array.isArray(e)&&(e[e.length-1]===void 0||e[e.length-1]===null)?(e.pop(),{prim:"None"}):{prim:"Some",args:[this.schema().Encode(t)]}}EncodeObject(t,e){const n=t;return n==null?{prim:"None"}:{prim:"Some",args:[this.schema().EncodeObject(n,e)]}}Execute(t,e){return t.prim==="None"?null:this.schema().Execute(t.args[0],e)}ExtractSchema(){return this.schema().ExtractSchema()}generateSchema(){return{__michelsonType:Dr.prim,schema:this.schema().generateSchema()}}ExtractSignature(){return[...this.schema().ExtractSignature(),[]]}get KeySchema(){return this.schema()}compare(t,e){if(t){if(!e)return 1}else return-1;return this.KeySchema.compare(t,e)}ToKey(t){return this.Execute(t)}ToBigMapKey(t){return{key:this.EncodeObject(t),type:this.typeWithoutAnnotations()}}findAndReturnTokens(t,e){return Dr.prim===t&&e.push(this),this.subToken().findAndReturnTokens(t,e),e}}Dr.prim="option";class pe extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){if(t.string&&/^\d+$/.test(t.string))return new Date(Number(t.string)*1e3).toISOString();if(t.string)return new Date(t.string).toISOString();if(t.int)return new Date(Number(t.int)*1e3).toISOString()}Encode(t){return{string:t.pop()}}EncodeObject(t,e){return e&&e[pe.prim]?e[pe.prim](t):{string:t}}ExtractSchema(){return pe.prim}generateSchema(){return{__michelsonType:pe.prim,schema:pe.prim}}ToKey({string:t}){return t}ToBigMapKey(t){return{key:{string:t},type:{prim:pe.prim}}}findAndReturnTokens(t,e){return pe.prim===t&&e.push(this),e}}pe.prim="timestamp";class rf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="IntValidationError"}}class kt extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return new G(t[Object.keys(t)[0]])}ExtractSchema(){return kt.prim}generateSchema(){return{__michelsonType:kt.prim,schema:kt.prim}}isValid(t){return new G(t).isNaN()?new rf(t,this,`Value is not a number: ${t}`):null}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{int:new G(e).toFixed()}}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[kt.prim]?e[kt.prim](t):{int:new G(t).toFixed()}}ToBigMapKey(t){return{key:{int:String(t)},type:{prim:kt.prim}}}ToKey({int:t}){return t}compare(t,e){const n=Number(t),i=Number(e);return n===i?0:n<i?-1:1}findAndReturnTokens(t,e){return kt.prim===t&&e.push(this),e}}kt.prim="int";class de extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Encode(t){return t.pop(),{prim:"Unit"}}EncodeObject(t,e){return e&&e[de.prim]?e[de.prim](t):{prim:"Unit"}}Execute(t){return Do}ExtractSchema(){return de.prim}generateSchema(){return{__michelsonType:de.prim,schema:de.prim}}compare(t,e){return 0}ToKey(t){return Do}ToBigMapKey(t){return{key:{prim:"Unit"},type:{prim:de.prim}}}findAndReturnTokens(t,e){return de.prim===t&&e.push(this),e}}de.prim="unit";const nf=4;class sf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="KeyValidationError"}}class ge extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return t.string?t.string:su(t.bytes)}isValid(t){return ou(t)!==U.VALID?new sf(t,this,"Key is not valid"):null}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{string:e}}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[ge.prim]?e[ge.prim](t):{string:t}}ExtractSchema(){return ge.prim}generateSchema(){return{__michelsonType:ge.prim,schema:ge.prim}}ToKey(t){return this.Execute(t)}ToBigMapKey(t){return{key:{string:t},type:{prim:ge.prim}}}compare(t,e){const n=this.getPrefix(t),i=this.getPrefix(e);if(n===j.EDPK&&i!==j.EDPK)return-1;if(n===j.SPPK&&i!==j.SPPK)return i===j.EDPK?1:-1;if(n===j.P2PK){if(i!==j.P2PK)return 1;const s=this.getP256PublicKeyComparableBytes(t),o=this.getP256PublicKeyComparableBytes(e);return Buffer.compare(s,o)}return super.compare(t,e)}getPrefix(t){return t.substring(0,nf)}getP256PublicKeyComparableBytes(t){return ia(t,us[j.P2PK]).slice(1)}findAndReturnTokens(t,e){return ge.prim===t&&e.push(this),e}}ge.prim="key";class of extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="KeyHashValidationError"}}class me extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return t.string?t.string:ks(t.bytes)}isValid(t){return ls(t)!==U.VALID?new of(t,this,`KeyHash is not valid: ${t}`):null}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{string:e}}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[me.prim]?e[me.prim](t):{string:t}}ExtractSchema(){return me.prim}generateSchema(){return{__michelsonType:me.prim,schema:me.prim}}ToKey({string:t,bytes:e}){return t||ks(e)}ToBigMapKey(t){return{key:{string:t},type:{prim:me.prim}}}findAndReturnTokens(t,e){return me.prim===t&&e.push(this),e}}me.prim="key_hash";class af extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="SignatureValidationError"}}class ye extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return t.string?t.string:t.bytes}isValid(t){return au(t)!==U.VALID?new af(t,this,"Signature is not valid"):null}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{string:e}}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[ye.prim]?e[ye.prim](t):{string:t}}ExtractSchema(){return ye.prim}generateSchema(){return{__michelsonType:ye.prim,schema:ye.prim}}ToKey(t){return this.Execute(t)}ToBigMapKey(t){return{key:{string:t},type:{prim:ye.prim}}}findAndReturnTokens(t,e){return ye.prim===t&&e.push(this),e}}ye.prim="signature";class Je extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}get paramSchema(){return this.createToken(this.val.args[0],this.idx)}get returnSchema(){return this.createToken(this.val.args[1],this.idx+1)}Execute(t){return t.string?t.string:t}Encode(t){return t.pop()}EncodeObject(t,e){return e&&e[Je.prim]?e[Je.prim](t):t}ExtractSchema(){return{[Je.prim]:{parameters:this.paramSchema.ExtractSchema(),returns:this.returnSchema.ExtractSchema()}}}generateSchema(){return{__michelsonType:Je.prim,schema:{parameters:this.paramSchema.generateSchema(),returns:this.returnSchema.generateSchema()}}}findAndReturnTokens(t,e){return Je.prim===t&&e.push(this),this.createToken(this.val.args[0],this.idx).findAndReturnTokens(t,e),this.createToken(this.val.args[1],this.idx).findAndReturnTokens(t,e),e}}Je.prim="lambda";class Ie extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){return t.string}Encode(...t){return{string:t.pop()}}EncodeObject(t,e){return e&&e[Ie.prim]?e[Ie.prim](t):{string:t}}ExtractSchema(){return Ie.prim}generateSchema(){return{__michelsonType:Ie.prim,schema:Ie.prim}}findAndReturnTokens(t,e){return Ie.prim===t&&e.push(this),e}}Ie.prim="operation";class cf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="SetValidationError"}}class Xe extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}get KeySchema(){return this.createToken(this.val.args[0],0)}isValid(t){return Array.isArray(t)?null:new cf(t,this,"Value must be an array")}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return e.sort((i,s)=>this.KeySchema.compare(i,s)).reduce((i,s)=>[...i,this.KeySchema.EncodeObject(s)],[])}Execute(t,e){return t.reduce((n,i)=>[...n,this.KeySchema.Execute(i,e)],[])}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[Xe.prim]?e[Xe.prim](t):t.sort((i,s)=>this.KeySchema.compare(i,s)).reduce((i,s)=>[...i,this.KeySchema.EncodeObject(s)],[])}ExtractSchema(){return Xe.prim}generateSchema(){return{__michelsonType:Xe.prim,schema:this.KeySchema.generateSchema()}}findAndReturnTokens(t,e){return Xe.prim===t&&e.push(this),this.KeySchema.findAndReturnTokens(t,e),e}}Xe.prim="set";class uf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="ChainIDValidationError"}}class be extends mt{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}isValid(t){return sa(t)!==U.VALID?new uf(t,this,"ChainID is not valid"):null}Execute(t){return t[Object.keys(t)[0]]}ExtractSchema(){return be.prim}generateSchema(){return{__michelsonType:be.prim,schema:be.prim}}Encode(t){const e=t.pop(),n=this.isValid(e);if(n)throw n;return{string:e}}EncodeObject(t,e){const n=this.isValid(t);if(n)throw n;return e&&e[be.prim]?e[be.prim](t):{string:t}}ToKey({string:t}){return t}ToBigMapKey(t){return{key:{string:t},type:{prim:be.prim}}}findAndReturnTokens(t,e){return be.prim===t&&e.push(this),e}}be.prim="chain_id";class xo extends Error{constructor(){super("Tickets cannot be sent to the blockchain; they are created on-chain"),this.name="TicketEncodeError"}}const lf={prim:"contract"},hf={prim:"int"};class Ne extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}get valueToken(){return this.createToken(this.val.args[0],this.idx)}Encode(t){throw new xo}EncodeObject(t,e){if(e&&e[Ne.prim])return e[Ne.prim](t,this.val);throw new xo}Execute(t,e){if(e&&e[Ne.prim])return e[Ne.prim](t,this.val);const n=this.createToken(lf,this.idx),i=this.valueToken,s=this.createToken(hf,this.idx);return t.args[2]===void 0&&t.args[1].args!==void 0?{ticketer:n.Execute(t.args[0],e),value:i.Execute(t.args[1].args[0],e),amount:s.Execute(t.args[1].args[1],e)}:{ticketer:n.Execute(t.args[0],e),value:i.Execute(t.args[1],e),amount:s.Execute(t.args[2],e)}}ExtractSchema(){return{ticketer:ie.prim,value:this.valueToken.ExtractSchema(),amount:kt.prim}}generateSchema(){return{__michelsonType:Ne.prim,schema:{value:this.valueToken.generateSchema(),ticketer:{__michelsonType:ie.prim,schema:ie.prim},amount:{__michelsonType:kt.prim,schema:kt.prim}}}}findAndReturnTokens(t,e){return Ne.prim===t&&e.push(this),this.valueToken.findAndReturnTokens(t,e),e}}Ne.prim="ticket";class ki extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="NeverTokenError"}}class xe extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Encode(t){const e=t.pop();throw new ki(e,this,"Assigning a value to the type never is forbidden.")}EncodeObject(t,e){if(e&&e[xe.prim])return e[xe.prim](t);throw new ki(t,this,"Assigning a value to the type never is forbidden.")}Execute(t){throw new ki(t,this,"There is no literal value for the type never.")}ExtractSchema(){return xe.prim}generateSchema(){return{__michelsonType:xe.prim,schema:xe.prim}}findAndReturnTokens(t,e){return xe.prim===t&&e.push(this),e}}xe.prim="never";class ji extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="SaplingStateValidationError"}}class Ee extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}isValid(t){return typeof t=="object"&&Object.keys(t).length===0}Execute(t,e){if(e&&e[Ee.prim])return e[Ee.prim](t,this.val);if("int"in t)return t.int;throw new ji(t,this,`Sapling state is expecting an object with an int property. Got ${JSON.stringify(t)}`)}Encode(t){const e=t.pop();if(this.isValid(e))return[];throw new ji(e,this,`Invalid sapling_state. Received: ${e} while expecting: {}`)}EncodeObject(t,e){if(e&&e[Ee.prim])return e[Ee.prim](t);if(this.isValid(t))return[];throw new ji(t,this,`Invalid sapling_state. Received: ${t} while expecting: {}`)}ExtractSchema(){return{[Ee.prim]:{"memo-size":Number(this.val.args[0].int)}}}generateSchema(){return{__michelsonType:Ee.prim,schema:{memoSize:this.val.args[0].int}}}findAndReturnTokens(t,e){return Ee.prim===t&&e.push(this),e}}Ee.prim="sapling_state";class Lo extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="SaplingTransactionValidationError"}}class Ze extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t){throw new Lo(t,this,"There is no literal value for the sapling_transaction type.")}validateBytes(t){const e=/^(0x|0X)?([0-9a-fA-F]*$)/.exec(t);if(e&&e[2].length%2===0)return e[2];throw new Lo(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let e=t.pop();return e=this.validateBytes(this.convertUint8ArrayToHexString(e)),{bytes:String(e).toString()}}EncodeObject(t,e){return t=this.validateBytes(this.convertUint8ArrayToHexString(t)),e&&e[Ze.prim]?e[Ze.prim](t):{bytes:String(t).toString()}}ExtractSchema(){return{[Ze.prim]:{"memo-size":Number(this.val.args[0].int)}}}generateSchema(){return{__michelsonType:Ze.prim,schema:{memoSize:this.val.args[0].int}}}findAndReturnTokens(t,e){return Ze.prim===t&&e.push(this),e}}Ze.prim="sapling_transaction";class ff extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="Bls12381frValidationError"}}class Le extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new ff(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let e=t.pop();if(typeof e=="number")return{int:e.toString()};{e=this.convertUint8ArrayToHexString(e);const n=this.isValid(e);if(n)throw n;return{bytes:e}}}EncodeObject(t,e){if(e&&e[Le.prim])return e[Le.prim](t);if(typeof t=="number")return{int:t.toString()};{t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return{bytes:t}}}Execute(t){return t.bytes}ExtractSchema(){return Le.prim}generateSchema(){return{__michelsonType:Le.prim,schema:Le.prim}}findAndReturnTokens(t,e){return Le.prim===t&&e.push(this),e}}Le.prim="bls12_381_fr";class pf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="Bls12381g1ValidationError"}}class Ce extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new pf(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let e=t.pop();e=this.convertUint8ArrayToHexString(e);const n=this.isValid(e);if(n)throw n;return{bytes:e}}EncodeObject(t,e){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return e&&e[Ce.prim]?e[Ce.prim](t):{bytes:t}}Execute(t){return t.bytes}ExtractSchema(){return Ce.prim}generateSchema(){return{__michelsonType:Ce.prim,schema:Ce.prim}}findAndReturnTokens(t,e){return Ce.prim===t&&e.push(this),e}}Ce.prim="bls12_381_g1";class df extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="Bls12381g2ValidationError"}}class Me extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new df(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let e=t.pop();e=this.convertUint8ArrayToHexString(e);const n=this.isValid(e);if(n)throw n;return{bytes:e}}EncodeObject(t,e){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return e&&e[Me.prim]?e[Me.prim](t):{bytes:t}}Execute(t){return t.bytes}ExtractSchema(){return Me.prim}generateSchema(){return{__michelsonType:Me.prim,schema:Me.prim}}findAndReturnTokens(t,e){return Me.prim===t&&e.push(this),e}}Me.prim="bls12_381_g2";class gf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="ChestValidationError"}}class Be extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new gf(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let e=t.pop();e=this.convertUint8ArrayToHexString(e);const n=this.isValid(e);if(n)throw n;return{bytes:e}}EncodeObject(t,e){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return e&&e[Be.prim]?e[Be.prim](t):{bytes:t}}Execute(t){return t.bytes}ExtractSchema(){return Be.prim}generateSchema(){return{__michelsonType:Be.prim,schema:Be.prim}}findAndReturnTokens(t,e){return Be.prim===t&&e.push(this),e}}Be.prim="chest";class mf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="ChestKeyValidationError"}}class De extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new mf(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let e=t.pop();e=this.convertUint8ArrayToHexString(e);const n=this.isValid(e);if(n)throw n;return{bytes:e}}EncodeObject(t,e){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return e&&e[De.prim]?e[De.prim](t):{bytes:t}}Execute(t){return t.bytes}ExtractSchema(){return De.prim}generateSchema(){return{__michelsonType:De.prim,schema:De.prim}}findAndReturnTokens(t,e){return De.prim===t&&e.push(this),e}}De.prim="chest_key";class Co extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="GlobalConstantEncodingError"}}class yf extends rt{constructor(t,e,n){super(t,e,n),this.value=t,this.token=e,this.name="GlobalConstantDecodingError"}}class ve extends Ot{constructor(t,e,n){super(t,e,n),this.val=t,this.idx=e,this.fac=n}Execute(t,e){if(e&&e[ve.prim])return e[ve.prim](t,this.val);throw new yf(t,this,`Unable to decode a value represented by a globalThis constants. Please provide an expanded script to the Michelson-Encoder or semantics for the decoding. The following globalThis constant hash was encountered: ${this.val.args[0].string}.`)}Encode(t){throw new Co(t,this,`Unable to encode a script containing globalThis constants. Please provide an expanded script to the Michelson-Encoder. The following globalThis constant hash was encountered: ${this.val.args[0].string}.`)}EncodeObject(t,e){if(e&&e[ve.prim])return e[ve.prim](t);throw new Co(t,this,`Unable to encode a script containing globalThis constants. Please provide an expanded script to the Michelson-Encoder. The following globalThis constant hash was encountered: ${this.val.args[0].string}.`)}ExtractSchema(){return ve.prim}generateSchema(){return{__michelsonType:ve.prim,schema:{hash:this.val.args[0].string}}}findAndReturnTokens(t,e){return ve.prim===t&&e.push(this),e}}ve.prim="constant";const bf=[vt,ce,ue,Jt,Pe,Te,mr,le,z,ie,Ye,he,fe,Dr,pe,kt,de,ge,me,ye,Je,Ie,Xe,be,Ne,xe,Ee,Ze,Le,Ce,Me,Be,De,ve];class Ef extends Error{constructor(t,e){super(t),this.message=t,this.data=e,this.name="Invalid token error"}}function vr(r,t){if(Array.isArray(r))return new vt(r,t,vr);const e=bf.find(n=>n.prim===r.prim);if(!e)throw new Ef("Malformed data expected a value with a valid prim property",r);return new e(r,t,vr)}class vf extends Error{constructor(t,e){super(`Unable to encode the parameter of the view: ${t}.`),this.smartContractViewName=t,this.originalError=e,this.name="ViewEncodingError"}}class Mo extends Error{constructor(t){super(t),this.message=t,this.name="InvalidScriptError"}}class za extends Error{constructor(t){super("Invalid RPC response passed as argument(s)"),this.script=t,this.name="InvalidRpcResponseError"}}class Bo extends Error{constructor(t,e,n){super(`
      ${t}. Error encountered when trying to encode arguments: 

      [${e}]
    `),this.message=t,this.args=e,this.originalError=n,this.name="ParameterEncodingError"}}class _n extends Error{constructor(t){super(t),this.message=t,this.name="InvalidBigMapSchema"}}class wf extends Error{constructor(t){super(t),this.message=t,this.name="InvalidBigMapDiff"}}class Af extends Error{constructor(t,e){super(`Unable to encode ${t}. ${e}`),this.obj=t,this.details=e,this.name="BigMapEncodingError"}}class _f extends Error{constructor(t,e){super(`Unable to encode ${t}. ${e}`),this.obj=t,this.details=e,this.name="StorageEncodingError"}}class Of extends Error{constructor(t){super(t),this.message=t,this.name="MissingArgumentError"}}var Wa;const Ya=Symbol.for("taquito-schema-type-symbol");function Zr(r,t=vt.prim){var e,n;if(Array.isArray(r))return Zr({prim:t,args:r},t);const i=r;return i.prim===t&&i.args&&i.args.length>2?Object.assign(Object.assign({},i),{args:[(e=i.args)===null||e===void 0?void 0:e[0],{prim:t,args:(n=i.args)===null||n===void 0?void 0:n.slice(1)}]}):i}function Ja(r,t){const e=Zr(r),n=Zr(t);return e.prim===n.prim&&(e.args===void 0&&n.args===void 0||e.args!==void 0&&n.args!==void 0&&e.args.length===n.args.length&&e.args.every((i,s)=>{var o,c;return Ja(i,(c=(o=n.args)===null||o===void 0?void 0:o[s])!==null&&c!==void 0?c:{})}))&&(e.annots===void 0&&n.annots===void 0||e.annots!==void 0&&n.annots!==void 0&&e.annots.length===n.annots.length&&e.annots.every((i,s)=>{var o;return i===((o=n.annots)===null||o===void 0?void 0:o[s])}))}class Ht{constructor(t){if(this.val=t,this[Wa]=!0,this.root=vr(t,0),this.root instanceof Jt)this.bigMap=this.root;else if(this.isExpressionExtended(t)&&t.prim==="pair"){const e=t.args[0];this.isExpressionExtended(e)&&e.prim==="big_map"&&(this.bigMap=new Jt(e,0,vr))}}static isSchema(t){return t&&t[Ya]===!0}static fromRPCResponse(t){const e=t&&t.script&&Array.isArray(t.script.code)&&t.script.code.find(n=>{if(Array.isArray(n))this.fromRPCResponse({script:{code:n,storage:t.script.storage}});else{const i=n;return i.prim?i.prim==="storage":!1}});if(!e||!Array.isArray(e.args))throw new za(t.script);return new Ht(e.args[0])}isExpressionExtended(t){return"prim"in t&&Array.isArray(t.args)}removeTopLevelAnnotation(t){return(this.root instanceof vt||this.root instanceof z)&&this.root.hasAnnotations()&&typeof t=="object"&&Object.keys(t).length===1?t[Object.keys(t)[0]]:t}Execute(t,e){const n=this.root.Execute(t,e);return this.removeTopLevelAnnotation(n)}Typecheck(t){if(this.root instanceof Jt&&Number.isInteger(Number(t)))return!0;try{return this.root.EncodeObject(t),!0}catch{return!1}}ExecuteOnBigMapDiff(t,e){if(!this.bigMap)throw new _n("Big map schema is undefined");if(!Array.isArray(t))throw new wf("Big map diff must be an array");const n=t.map(({key:i,value:s})=>({args:[i,s]}));return this.bigMap.Execute(n,e)}ExecuteOnBigMapValue(t,e){if(!this.bigMap)throw new _n("No big map schema");return this.bigMap.ValueSchema.Execute(t,e)}EncodeBigMapKey(t){if(!this.bigMap)throw new _n("Big map schema is undefined");try{return this.bigMap.KeySchema.ToBigMapKey(t)}catch(e){throw new Af("big map key",e)}}Encode(t,e){try{return this.root.EncodeObject(t,e)}catch(n){throw n instanceof rt?n:new _f("storage object",n)}}ExtractSchema(){return this.removeTopLevelAnnotation(this.root.ExtractSchema())}generateSchema(){return this.removeTopLevelAnnotation(this.root.generateSchema())}ComputeState(t,e){if(!this.bigMap)throw new _n("Big map schema is undefined");const n=t.reduce((i,s)=>Object.assign(Object.assign({},i),this.ExecuteOnBigMapDiff(s.contents[0].metadata.operation_result.big_map_diff)),{});return Object.assign(Object.assign({},this.Execute(e)),{[this.bigMap.annot()]:n})}FindFirstInTopLevelPair(t,e){return this.findValue(this.root.val,t,e)}findValue(t,e,n){if(Ja(n,t))return e;if(Array.isArray(t)||t.prim==="pair"){const i=Zr(t),s=Zr(e,"Pair");if(i.args===void 0||s.args===void 0)throw new Of("Tokens have no arguments");if(i.args[0])return this.findValue(i.args[0],s.args[0],n)||this.findValue(i.args[1],s.args[1],n)}}findToken(t){const e=[];return this.root.findAndReturnTokens(t,e)}}Wa=Ya;class Ir{constructor(t){this.root=vr(t,0)}static fromRPCResponse(t){const e=t&&t.script&&Array.isArray(t.script.code)&&t.script.code.find(n=>n.prim==="parameter");if(!e||!Array.isArray(e.args))throw new za(t.script);return new Ir(e.args[0])}get isMultipleEntryPoint(){return this.root instanceof z||this.root instanceof Dr&&this.root.subToken()instanceof z}get hasAnnotation(){return this.isMultipleEntryPoint?Object.keys(this.ExtractSchema())[0]!=="0":!0}Execute(t,e){return this.root.Execute(t,e)}Encode(...t){try{return this.root.Encode(t.reverse())}catch(e){throw e instanceof rt?e:new Bo("Unable to encode parameter",t.toString(),e)}}EncodeObject(t,e){try{return this.root.EncodeObject(t,e)}catch(n){throw n instanceof rt?n:new Bo("Unable to encode parameter object",t,n)}}ExtractSchema(){return this.root.ExtractSchema()}generateSchema(){return this.root.generateSchema()}ExtractSignatures(){return this.root.ExtractSignature()}}class Rs{constructor(t){if(t.length!==4||!("string"in t[0]))throw new Mo(`Invalid on-chain view: ${JSON.stringify(t)}`);this.viewName=t[0].string,this.viewArgsType=t[1],this.viewReturnType=t[2],this.instructions=t[3],this.rootArgsType=vr(this.viewArgsType,0),this.rootReturnType=vr(this.viewReturnType,0)}static fromRPCResponse(t){const e=[],n=t&&t.script&&Array.isArray(t.script.code)&&t.script.code.filter(i=>i.prim==="view");return n&&n.forEach(i=>{if(!i.args||i.args.length!==4)throw new Mo(`Invalid on-chain view found in the script: ${JSON.stringify(i)}`);e.push(new Rs(i.args))}),e}encodeViewArgs(t){try{return this.rootArgsType.EncodeObject(t)}catch(e){throw new vf(this.viewName,e)}}decodeViewResult(t,e){return this.rootReturnType.Execute(t,e)}extractArgsSchema(){return this.rootArgsType.ExtractSchema()}extractResultSchema(){return this.rootReturnType.ExtractSchema()}}const Do=Symbol(),Ct=Symbol("source_reference");class pr extends Error{constructor(t,e,n){super(n),this.src=t,this.idx=e,Object.setPrototypeOf(this,pr.prototype)}}var Mt;(function(r){r[r.Comment=0]="Comment",r[r.Number=1]="Number",r[r.String=2]="String",r[r.Bytes=3]="Bytes",r[r.Ident=4]="Ident"})(Mt||(Mt={}));const Rf=new RegExp("\\s"),Sf=new RegExp("[:@%_A-Za-z]"),Pf=new RegExp("[@%_\\.A-Za-z0-9]"),$o=new RegExp("[0-9]"),Tf=new RegExp("[0-9a-fA-F]");function*Vi(r,t=!1){let e=0;for(;e<r.length;){for(;e<r.length&&Rf.test(r[e]);)e++;if(e===r.length)return;const n=r[e],i=e;if(Sf.test(n)){for(e++;e<r.length&&Pf.test(r[e]);)e++;yield{t:Mt.Ident,v:r.slice(i,e),first:i,last:e}}else if(r.length-e>1&&r.substr(e,2)==="0x"){for(e+=2;e<r.length&&Tf.test(r[e]);)e++;if((e-i&1)!==0)throw new pr(r,e,"Bytes literal length is expected to be power of two");yield{t:Mt.Bytes,v:r.slice(i,e),first:i,last:e}}else if($o.test(n)||n==="-"){n==="-"&&e++;const s=e;for(;e<r.length&&$o.test(r[e]);)e++;if(s===e)throw new pr(r,e,"Number literal is too short");yield{t:Mt.Number,v:r.slice(i,e),first:i,last:e}}else if(n==='"'){e++;let s=!1;for(;e<r.length&&(s||r[e]!=='"');e++)!s&&r[e]==="\\"?s=!0:s=!1;if(e===r.length)throw new pr(r,e,"Unterminated string literal");e++,yield{t:Mt.String,v:r.slice(i,e),first:i,last:e}}else if(n==="#"){for(e++;e<r.length&&r[e]!==`
`;)e++;t&&(yield{t:Mt.Comment,v:r.slice(i,e),first:i,last:e})}else if(r.length-e>1&&r.substr(e,2)==="/*"){for(e+=2;e<r.length&&!(r.length-e>1&&r.substr(e,2)==="*/");)e++;if(e===r.length)throw new pr(r,e,"Unterminated C style comment");e+=2,t&&(yield{t:Mt.Comment,v:r.slice(i,e),first:i,last:e})}else if(n==="("||n===")"||n==="{"||n==="}"||n===";")e++,yield{t:n,v:n,first:i,last:e};else throw new pr(r,e,`Invalid character at offset ${e}: \`${n}'`)}}const On=Symbol("ref_contract");var tr;(function(r){r.Ps9mPmXa="Ps9mPmXaRzmzk35gbAYNCAw6UXdE2qoABTHbN2oEEc1qM7CwT9P",r.PtCJ7pwo="PtCJ7pwoxe8JasnHY8YonnLYjcVHmhiARPJvqcC6VfHT5s8k8sY",r.PsYLVpVv="PsYLVpVvgbLhAhoqAkMFUo6gudkJ9weNXhUYCiLDzcUpFpkk8Wt",r.PsddFKi3="PsddFKi32cMJ2qPjf43Qv5GDWLDPZb3T3bF6fLKiF5HtvHNU7aP",r.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",r.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",r.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",r.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",r.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",r.PtEdoTez="PtEdoTezd3RHSC31mpxxo1npxFjoWWcFgQtxapi51Z8TLu6v6Uq",r.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA",r.PsFLoren="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",r.PsFLorena="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",r.PtGRANAD="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",r.PtGRANADs="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",r.PtHangzH="PtHangzHogokSuiMHemCuowEavgYTP8J5qQ9fQS793MHYFpCY3r",r.PtHangz2="PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx",r.PsiThaCa="PsiThaCaT47Zboaw71QWScM8sXeMM7bbQFncK9FLqYc6EKdpjVP",r.Psithaca2="Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A",r.PtJakarta="PtJakartaiDz69SfDDLXJSiuZqTSeSKRDbKVZC8MNzJnvRjvnGw",r.PtJakart2="PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY",r.ProtoALpha="ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK"})(tr||(tr={}));const Xa=tr.Psithaca2,ko={Ps9mPmXaRzmzk35gbAYNCAw6UXdE2qoABTHbN2oEEc1qM7CwT9P:0,PtCJ7pwoxe8JasnHY8YonnLYjcVHmhiARPJvqcC6VfHT5s8k8sY:1,PsYLVpVvgbLhAhoqAkMFUo6gudkJ9weNXhUYCiLDzcUpFpkk8Wt:2,PsddFKi32cMJ2qPjf43Qv5GDWLDPZb3T3bF6fLKiF5HtvHNU7aP:3,Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd:4,PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU:5,PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS:5,PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb:6,PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo:7,PtEdoTezd3RHSC31mpxxo1npxFjoWWcFgQtxapi51Z8TLu6v6Uq:8,PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA:8,PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i:9,PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV:10,PtHangzHogokSuiMHemCuowEavgYTP8J5qQ9fQS793MHYFpCY3r:11,PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx:11,PsiThaCaT47Zboaw71QWScM8sXeMM7bbQFncK9FLqYc6EKdpjVP:12,Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A:12,PtJakartaiDz69SfDDLXJSiuZqTSeSKRDbKVZC8MNzJnvRjvnGw:13,PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY:13,ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK:14};function zr(r,t){return ko[r]<ko[t]}class Ut extends Error{constructor(t,e){super(e),this.prim=t,Object.setPrototypeOf(this,Ut.prototype)}}function ut(r,t){var e,n;if(t===0&&r.args===void 0||((e=r.args)===null||e===void 0?void 0:e.length)===t)return!0;throw new Ut(r,`macro ${r.prim} expects ${t} arguments, was given ${(n=r.args)===null||n===void 0?void 0:n.length}`)}function Kr(r){if(r.annots===void 0)return!0;throw new Ut(r,`unexpected annotation on macro ${r.prim}: ${r.annots}`)}function jo(r,t){if("int"in t)return!0;throw new Ut(r,`macro ${r.prim} expects int argument`)}function Wr(r,t,e,n){let i=0,s=0;const o=[null,null];let c;if(i===t.length)throw new Ut(r,`unexpected end: ${r.prim}`);let l=t[i++];switch(l){case"P":{const{r:y,n:v,an:P}=Wr(r,t.slice(i),e.slice(s),n);c=y,i+=v,s+=P;break}case"A":s!==e.length&&(o[0]=e[s++]);break;default:throw new Ut(r,`${r.prim}: unexpected character: ${l}`)}let m;if(i===t.length)throw new Ut(r,`unexpected end: ${r.prim}`);switch(l=t[i++],l){case"P":{const{r:y,n:v,an:P}=Wr(r,t.slice(i),e.slice(s),n);m=y.map(([T,D])=>[T+1,D]),i+=v,s+=P;break}case"I":s!==e.length&&(o[1]=e[s++]);break;default:throw new Ut(r,`${r.prim}: unexpected character: ${l}`)}return{r:n(c,m,[0,o]),n:i,an:s}}function Vn(r,t,e,n){const i=t[0];switch(i){case"A":return t.length>1?[{prim:"DUP"},{prim:"DIP",args:[[{prim:"CAR",annots:["@%%"]},Vn(r,t.slice(1),[],n)]]},{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:["%@","%@",...e]}]:n.a;case"D":return t.length>1?[{prim:"DUP"},{prim:"DIP",args:[[{prim:"CDR",annots:["@%%"]},Vn(r,t.slice(1),[],n)]]},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@","%@",...e]}]:n.d;default:throw new Ut(r,`${r.prim}: unexpected character: ${i}`)}}function If(r,t){let e=r.length;for(;e>0&&r[e-1]===t;)e--;return r.slice(0,e)}function Hi(r){const t=[],e=[];if(r!==void 0)for(const n of r)(n.length!==0&&n[0]==="%"?t:e).push(n);return{fields:t,rest:e}}function wt({prim:r,annots:t,args:e}){return Object.assign(Object.assign({prim:r},t&&{annots:t}),e&&{args:e})}const Nf=/^P[PAI]{3,}R$/,xf=/^UNP[PAI]{2,}R$/,Lf=/^C[AD]{2,}R$/,Cf=/^SET_C[AD]+R$/,Mf=/^MAP_C[AD]+R$/,Bf=/^DI{2,}P$/,Df=/^DU+P$/;function $f(r,t){const e=(t==null?void 0:t.protocol)||Xa;function n(i){return i!==void 0?[{prim:"RENAME",annots:i}]:[]}switch(r.prim){case"CMPEQ":case"CMPNEQ":case"CMPLT":case"CMPGT":case"CMPLE":case"CMPGE":if(ut(r,0))return[{prim:"COMPARE"},wt({prim:r.prim.slice(3),annots:r.annots})];break;case"IFEQ":case"IFNEQ":case"IFLT":case"IFGT":case"IFLE":case"IFGE":if(ut(r,2))return[{prim:r.prim.slice(2)},wt({prim:"IF",annots:r.annots,args:r.args})];break;case"IFCMPEQ":case"IFCMPNEQ":case"IFCMPLT":case"IFCMPGT":case"IFCMPLE":case"IFCMPGE":if(ut(r,2))return[{prim:"COMPARE"},{prim:r.prim.slice(5)},wt({prim:"IF",annots:r.annots,args:r.args})];break;case"FAIL":if(ut(r,0)&&Kr(r))return[{prim:"UNIT"},{prim:"FAILWITH"}];break;case"ASSERT":if(ut(r,0)&&Kr(r))return[{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_EQ":case"ASSERT_NEQ":case"ASSERT_LT":case"ASSERT_GT":case"ASSERT_LE":case"ASSERT_GE":if(ut(r,0)&&Kr(r))return[{prim:r.prim.slice(7)},{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_CMPEQ":case"ASSERT_CMPNEQ":case"ASSERT_CMPLT":case"ASSERT_CMPGT":case"ASSERT_CMPLE":case"ASSERT_CMPGE":if(ut(r,0)&&Kr(r))return[[{prim:"COMPARE"},{prim:r.prim.slice(10)}],{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_NONE":if(ut(r,0)&&Kr(r))return[{prim:"IF_NONE",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_SOME":if(ut(r,0))return[{prim:"IF_NONE",args:[[[{prim:"UNIT"},{prim:"FAILWITH"}]],n(r.annots)]}];break;case"ASSERT_LEFT":if(ut(r,0))return[{prim:"IF_LEFT",args:[n(r.annots),[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_RIGHT":if(ut(r,0))return[{prim:"IF_LEFT",args:[[[{prim:"UNIT"},{prim:"FAILWITH"}]],n(r.annots)]}];break;case"IF_SOME":if(ut(r,2))return[wt({prim:"IF_NONE",annots:r.annots,args:[r.args[1],r.args[0]]})];break;case"IF_RIGHT":if(ut(r,2))return[wt({prim:"IF_LEFT",annots:r.annots,args:[r.args[1],r.args[0]]})];break;case"CAR":case"CDR":if(r.args!==void 0){if(ut(r,1)&&jo(r,r.args[0])){const i=parseInt(r.args[0].int,10);return wt({prim:"GET",args:[{int:r.prim==="CAR"?String(i*2+1):String(i*2)}],annots:r.annots})}}else return r}if(Nf.test(r.prim)&&ut(r,0)){const{fields:i,rest:s}=Hi(r.annots),{r:o}=Wr(r,r.prim.slice(1),i,(c,l,m)=>[...c||[],...l||[],m]);return o.map(([c,l],m)=>{const y=[...If(l,null).map(P=>P===null?"%":P),...c===0&&m===o.length-1?s:[]],v=wt({prim:"PAIR",annots:y.length!==0?y:void 0});return c===0?v:{prim:"DIP",args:c===1?[[v]]:[{int:String(c)},[v]]}})}if(xf.test(r.prim))if(zr(e,tr.PtEdo2Zk)&&ut(r,0)){const{r:i}=Wr(r,r.prim.slice(3),r.annots||[],(s,o,c)=>[c,...o||[],...s||[]]);return i.map(([s,o])=>{const c=[{prim:"DUP"},wt({prim:"CAR",annots:o[0]!==null?[o[0]]:void 0}),{prim:"DIP",args:[[wt({prim:"CDR",annots:o[1]!==null?[o[1]]:void 0})]]}];return s===0?c:{prim:"DIP",args:s===1?[[c]]:[{int:String(s)},[c]]}})}else{if(r.prim==="UNPAIR")return r;if(ut(r,0)){const{r:i}=Wr(r,r.prim.slice(3),[],(s,o,c)=>[c,...o||[],...s||[]]);return i.map(([s])=>{const o=wt({prim:"UNPAIR"});return s===0?o:{prim:"DIP",args:s===1?[[o]]:[{int:String(s)},[o]]}})}}if(Lf.test(r.prim)&&ut(r,0)){const i=[...r.prim.slice(1,r.prim.length-1)];return i.map((s,o)=>{const c=o===i.length-1?r.annots:void 0;switch(s){case"A":return wt({prim:"CAR",annots:c});case"D":return wt({prim:"CDR",annots:c});default:throw new Ut(r,`unexpected character: ${s}`)}})}if(Cf.test(r.prim)&&ut(r,0)){const{fields:i,rest:s}=Hi(r.annots);if(i.length>1)throw new Ut(r,`unexpected annotation on macro ${r.prim}: ${i}`);const o=i.length!==0?{a:[{prim:"DUP"},{prim:"CAR",annots:i},{prim:"DROP"},{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:[i[0],"%@"]}],d:[{prim:"DUP"},{prim:"CDR",annots:i},{prim:"DROP"},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@",i[0]]}]}:{a:[{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:["%","%@"]}],d:[{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@","%"]}]};return Vn(r,r.prim.slice(5,r.prim.length-1),s,o)}if(Mf.test(r.prim)&&ut(r,1)){const{fields:i}=Hi(r.annots);if(i.length>1)throw new Ut(r,`unexpected annotation on macro ${r.prim}: ${i}`);const s={a:[{prim:"DUP"},{prim:"CDR",annots:["@%%"]},{prim:"DIP",args:[[wt({prim:"CAR",annots:i.length!==0?["@"+i[0].slice(1)]:void 0}),r.args[0]]]},{prim:"SWAP"},{prim:"PAIR",annots:[i.length!==0?i[0]:"%","%@"]}],d:[{prim:"DUP"},wt({prim:"CDR",annots:i.length!==0?["@"+i[0].slice(1)]:void 0}),r.args[0],{prim:"SWAP"},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@",i.length!==0?i[0]:"%"]}]};return Vn(r,r.prim.slice(5,r.prim.length-1),[],s)}if(Bf.test(r.prim)&&ut(r,1)){let i=0;for(;r.prim[1+i]==="I";)i++;return wt({prim:"DIP",args:[{int:String(i)},r.args[0]]})}if(Df.test(r.prim)){let i=0;for(;r.prim[1+i]==="U";)i++;if(zr(e,tr.PtEdo2Zk)){if(i===1){if(r.args===void 0)return r;ut(r,1)&&jo(r,r.args[0])&&(i=parseInt(r.args[0].int,10))}else ut(r,0);return i===1?[wt({prim:"DUP",annots:r.annots})]:i===2?[{prim:"DIP",args:[[wt({prim:"DUP",annots:r.annots})]]},{prim:"SWAP"}]:[{prim:"DIP",args:[{int:String(i-1)},[wt({prim:"DUP",annots:r.annots})]]},{prim:"DIG",args:[{int:String(i)}]}]}else{if(i===1)return r;if(ut(r,0))return wt({prim:"DUP",args:[{int:String(i)}],annots:r.annots})}}return r}function kf(r,t){return r.args!==void 0&&r.args.length===1&&"string"in r.args[0]&&r.args[0].string in t?t[r.args[0].string]:r}class Lr extends Error{constructor(t,e){super(e),this.token=t,Object.setPrototypeOf(this,Lr.prototype)}}class ae extends Error{constructor(t,e){super(e),this.node=t,Object.setPrototypeOf(this,ae.prototype)}}const Ui=new Lr(null,"Unexpected EOF");function Vo(r){return r.t===Mt.Ident&&(r.v[0]==="@"||r.v[0]==="%"||r.v[0]===":")}const jf=new RegExp("^-?[0-9]+$"),Vf=new RegExp("^([0-9a-fA-F]{2})*$");class yr{constructor(t){this.opt=t}expand(t){var e,n,i;if(((e=this.opt)===null||e===void 0?void 0:e.expandGlobalConstant)!==void 0&&t.prim==="constant"){const s=kf(t,this.opt.expandGlobalConstant);return s!==t&&(s[Ct]=Object.assign(Object.assign({},t[Ct]||{first:0,last:0}),{globalConstant:t})),s}if(((n=this.opt)===null||n===void 0?void 0:n.expandMacros)===void 0||((i=this.opt)===null||i===void 0?void 0:i.expandMacros)){const s=$f(t,this.opt);return s!==t&&(s[Ct]=Object.assign(Object.assign({},t[Ct]||{first:0,last:0}),{macro:t})),s}else return t}parseListExpr(t,e){var n;const i={first:e.first,last:e.last},s=e.t==="(";let o;if(s){if(o=t.next(),o.done)throw Ui;i.last=o.value.last}else o={value:e};if(o.value.t!==Mt.Ident)throw new Lr(o.value,`not an identifier: ${o.value.v}`);const c={prim:o.value.v,[Ct]:i};for(;;){const l=t.next();if(l.done){if(s)throw Ui;break}else if(l.value.t===")"){if(!s)throw new Lr(l.value,"unexpected closing bracket");i.last=l.value.last;break}else if(Vo(l.value))c.annots=c.annots||[],c.annots.push(l.value.v),i.last=l.value.last;else{c.args=c.args||[];const m=this.parseExpr(t,l.value);i.last=((n=m[Ct])===null||n===void 0?void 0:n.last)||i.last,c.args.push(m)}}return this.expand(c)}parseArgs(t,e){var n;const i={first:e.first,last:e.last},s={prim:e.v,[Ct]:i};for(;;){const o=t.next();if(o.done||o.value.t==="}"||o.value.t===";")return[s,o];if(Vo(o.value))i.last=o.value.last,s.annots=s.annots||[],s.annots.push(o.value.v);else{const c=this.parseExpr(t,o.value);i.last=((n=c[Ct])===null||n===void 0?void 0:n.last)||i.last,s.args=s.args||[],s.args.push(c)}}}parseSequenceExpr(t,e){var n,i;const s={first:e.first,last:e.last},o=[];o[Ct]=s;const c=e.t==="{";let l=e.t==="{"?null:{value:e};for(;;){if(l===null&&(l=t.next(),l.done||(s.last=l.value.last)),l.done){if(c)throw Ui;return o}if(l.value.t==="}"){if(c)return o;throw new Lr(l.value,"unexpected closing bracket")}else if(l.value.t===Mt.Ident){const[m,y]=this.parseArgs(t,l.value);s.last=((n=m[Ct])===null||n===void 0?void 0:n.last)||s.last,o.push(this.expand(m)),l=y}else{const m=this.parseExpr(t,l.value);s.last=((i=m[Ct])===null||i===void 0?void 0:i.last)||s.last,o.push(m),l=null}l===null&&(l=t.next(),l.done||(s.last=l.value.last)),!l.done&&l.value.t===";"&&(l=null)}}parseExpr(t,e){switch(e.t){case Mt.Ident:return this.expand({prim:e.v,[Ct]:{first:e.first,last:e.last}});case Mt.Number:return{int:e.v,[Ct]:{first:e.first,last:e.last}};case Mt.String:return{string:JSON.parse(e.v),[Ct]:{first:e.first,last:e.last}};case Mt.Bytes:return{bytes:e.v.slice(2),[Ct]:{first:e.first,last:e.last}};case"{":return this.parseSequenceExpr(t,e);default:return this.parseListExpr(t,e)}}parseSequence(t){if(typeof t!="string")throw new TypeError(`string type was expected, got ${typeof t} instead`);const e=Vi(t),n=e.next();return n.done?null:this.parseSequenceExpr(e,n.value)}parseList(t){if(typeof t!="string")throw new TypeError(`string type was expected, got ${typeof t} instead`);const e=Vi(t),n=e.next();return n.done?null:this.parseListExpr(e,n.value)}parseMichelineExpression(t){if(typeof t!="string")throw new TypeError(`string type was expected, got ${typeof t} instead`);const e=Vi(t),n=e.next();return n.done?null:this.parseExpr(e,n.value)}parseScript(t){return this.parseSequence(t)}parseData(t){return this.parseList(t)}parseJSON(t){if(typeof t!="object")throw new TypeError(`object type was expected, got ${typeof t} instead`);if(Array.isArray(t)){const e=[];for(const n of t){if(n===null||typeof n!="object")throw new ae(n,`unexpected sequence element: ${n}`);e.push(this.parseJSON(n))}return e}else if("prim"in t){const e=t;if(typeof e.prim=="string"&&(e.annots===void 0||Array.isArray(e.annots))&&(e.args===void 0||Array.isArray(e.args))){const n={prim:e.prim};if(e.annots!==void 0){for(const i of e.annots)if(typeof i!="string")throw new ae(i,`string expected: ${i}`);n.annots=e.annots}if(e.args!==void 0){n.args=[];for(const i of e.args){if(i===null||typeof i!="object")throw new ae(i,`unexpected argument: ${i}`);n.args.push(this.parseJSON(i))}}return this.expand(n)}throw new ae(t,`malformed prim expression: ${t}`)}else if("string"in t){if(typeof t.string=="string")return{string:t.string};throw new ae(t,`malformed string literal: ${t}`)}else if("int"in t){if(typeof t.int=="string"&&jf.test(t.int))return{int:t.int};throw new ae(t,`malformed int literal: ${t}`)}else if("bytes"in t){if(typeof t.bytes=="string"&&Vf.test(t.bytes))return{bytes:t.bytes};throw new ae(t,`malformed bytes literal: ${t}`)}else throw new ae(t,`unexpected object: ${t}`)}}const Hf=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Uf=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];class ts extends Error{constructor(t){super(t),this.message=t,this.name="Base58DecodingError"}}class Ff extends Error{constructor(t){super(t),this.message=t,this.name="InvalidMessageError"}}function Ho(r){const t=(r.length+9)%64,e=t===0?0:64-t;if(r.length>268435455)throw new Ff(`SHA-256 -- message length is too big: ${r.length}`);const n=r.length<<3,i=[...r,128,...new Array(e).fill(0),0,0,0,0,n>>24&255,n>>16&255,n>>8&255,n&255];function s(y,v){return y>>>v|y<<32-v}const o=[...Hf],c=new Array(64),l=new Array(8);for(let y=0;y<i.length;y+=64){let v=y,P=0;for(;P<16;)c[P]=i[v]<<24|i[v+1]<<16|i[v+2]<<8|i[v+3],v+=4,P++;for(;P<64;){const T=s(c[P-15],7)^s(c[P-15],18)^c[P-15]>>>3,D=s(c[P-2],17)^s(c[P-2],19)^c[P-2]>>>10;c[P]=(D|0)+c[P-7]+T+c[P-16]|0,P++}for(let T=0;T<8;T++)l[T]=o[T];for(let T=0;T<64;T++){const D=s(l[0],2)^s(l[0],13)^s(l[0],22),W=s(l[4],6)^s(l[4],11)^s(l[4],25),C=l[7]+W+(l[4]&l[5]^~l[4]&l[6])+Uf[T]+c[T]|0,L=D+(l[0]&l[1]^l[0]&l[2]^l[1]&l[2])|0;l[7]=l[6],l[6]=l[5],l[5]=l[4],l[4]=l[3]+C|0,l[3]=l[2],l[2]=l[1],l[1]=l[0],l[0]=C+L|0}for(let T=0;T<8;T++)o[T]=o[T]+l[T]|0}const m=[];for(const y of o)m.push(y>>24&255),m.push(y>>16&255),m.push(y>>8&255),m.push(y&255);return m}const Fi=[0,1,2,3,4,5,6,7,8,-1,-1,-1,-1,-1,-1,-1,9,10,11,12,13,14,15,16,-1,17,18,19,20,21,-1,22,23,24,25,26,27,28,29,30,31,32,-1,-1,-1,-1,-1,-1,33,34,35,36,37,38,39,40,41,42,43,-1,44,45,46,47,48,49,50,51,52,53,54,55,56,57];function Uo(r,t){const e=r.charCodeAt(t)-49;if(e>=Fi.length||Fi[e]===-1)throw new ts(`Unexpected character at position ${t}: ${r[t]}`);return Fi[e]}function Gf(r){const t=[];let e=0;for(;e<r.length&&Uo(r,e)===0;)e++;let n=e;for(;e<r.length;){let i=Uo(r,e++),s=0;for(;i!==0||s<t.length;){const o=(t[s]||0)*58+i;t[s++]=o%256,i=Math.floor(o/256)}}for(;n-- >0;)t.push(0);return t.reverse()}function Za(r){const t=Gf(r);if(t.length<4)throw new ts(`Data is too short ${t.length}`);const e=t.slice(0,t.length-4),n=t.slice(t.length-4),i=Ho(Ho(e));if(n[0]!==i[0]||n[1]!==i[1]||n[2]!==i[2]||n[3]!==i[3])throw new ts("Invalid checksum");return e}class Kf extends Error{constructor(t){super(t),this.message=t,this.name="InvalidContractError"}}class qf extends Error{constructor(t){super(t),this.message=t,this.name="InvalidTypeExpressionError"}}class zf extends Error{constructor(t){super(t),this.message=t,this.name="InvalidDataExpressionError"}}class Wf extends Error{constructor(t){super(`Contract has no entrypoint named: '${t}'`),this.entrypoint=t,this.name="InvalidEntrypointError"}}class Yf extends Error{constructor(t){super(t),this.message=t,this.name="LongIntegerError"}}class Jf extends Error{constructor(t){super(`Unable to parse hex byte: ${t}`),this.hexByte=t,this.name="HexParseError"}}class Ft extends Error{constructor(t,e){super(e),this.val=t,Object.setPrototypeOf(this,Ft.prototype)}}class M extends Ft{constructor(t,e,n){super(t,n),e!==void 0&&(this.data=e),Object.setPrototypeOf(this,M.prototype)}}class Qa{constructor(t){if(this.neg=!1,this.buf=[],t!==void 0)if(typeof t=="string")for(let e=0;e<t.length;e++){const n=t.charCodeAt(e);if(e===0&&n===45)this.neg=!0;else{if(n<48||n>57)throw new Yf(`unexpected character in integer constant: ${t[e]}`);this.append(n-48)}}else t<0?(this.neg=!0,this.append(-t)):this.append(t)}append(t){let e=0;for(;t!==0||e<this.buf.length;){const n=(this.buf[e]||0)*10+t;this.buf[e++]=n%256,t=Math.floor(n/256)}}cmp(t){if(this.neg!==t.neg)return(t.neg?1:0)-(this.neg?1:0);{let e=0;if(this.buf.length!==t.buf.length)e=this.buf.length<t.buf.length?-1:1;else if(this.buf.length!==0){let n=t.buf.length-1;for(;n>=0&&this.buf[n]===t.buf[n];)n--;e=n<0?0:this.buf[n]<t.buf[n]?-1:1}return this.neg?e===0?0:-e:e}}get sign(){return this.buf.length===0?0:this.neg?-1:1}}function Cr(r){const t=[];for(let e=0;e<r.length;e+=2){const n=parseInt(r.slice(e,e+2),16);if(Number.isNaN(n))return null;t.push(n)}return t}function es(r){try{return new Qa(r),!0}catch{return!1}}function tc(r){try{return new Qa(r).sign>=0}catch{return!1}}const Xf=/^(@%|@%%|%@|[@:%]([_0-9a-zA-Z][_0-9a-zA-Z.%@]*)?)$/;function $r(r,t){if(Array.isArray(r))return{};let e,n,i;if(r.annots!==void 0){for(const s of r.annots)if(s.length!==0){if(!Xf.test(s)||!(t!=null&&t.specialVar)&&(s==="@%"||s==="@%%")||!(t!=null&&t.specialFields)&&s==="%@")throw new Ft(r,`${r.prim}: unexpected annotation: ${s}`);switch(s[0]){case"%":((t==null?void 0:t.emptyFields)||s.length>1)&&(e=e||[],e.push(s));break;case":":s.length>1&&(n=n||[],n.push(s));break;case"@":((t==null?void 0:t.emptyVar)||s.length>1)&&(i=i||[],i.push(s));break}}}return{f:e,t:n,v:i}}const Zf={BlockHash:[32,[1,52]],OperationHash:[32,[5,116]],OperationListHash:[32,[133,233]],OperationListListHash:[32,[29,159,109]],ProtocolHash:[32,[2,170]],ContextHash:[32,[79,199]],ED25519PublicKeyHash:[20,[6,161,159]],SECP256K1PublicKeyHash:[20,[6,161,161]],P256PublicKeyHash:[20,[6,161,164]],ContractHash:[20,[2,90,121]],CryptoboxPublicKeyHash:[16,[153,103]],ED25519Seed:[32,[13,15,58,7]],ED25519PublicKey:[32,[13,15,37,217]],SECP256K1SecretKey:[32,[17,162,224,201]],P256SecretKey:[32,[16,81,238,189]],ED25519EncryptedSeed:[56,[7,90,60,179,41]],SECP256K1EncryptedSecretKey:[56,[9,237,241,174,150]],P256EncryptedSecretKey:[56,[9,48,57,115,171]],SECP256K1PublicKey:[33,[3,254,226,86]],P256PublicKey:[33,[3,178,139,127]],SECP256K1Scalar:[33,[38,248,136]],SECP256K1Element:[33,[5,92,0]],ED25519SecretKey:[64,[43,246,78,7]],ED25519Signature:[64,[9,245,205,134,18]],SECP256K1Signature:[64,[13,115,101,19,63]],P256Signature:[64,[54,240,44,52]],GenericSignature:[64,[4,130,43]],ChainID:[4,[87,82,0]],RollupAddress:[20,[1,128,120,31]],TxRollupL2Address:[20,[6,161,166]]};function je(r,...t){const e=Za(r);for(const n of t){const[i,s]=Zf[n];if(e.length===i+s.length){let o=0;for(;o<s.length&&e[o]===s[o];)o++;if(o===s.length)return[n,e.slice(s.length)]}}return null}function jt(r,t){const e=t,n=Array.isArray(e)?e:e.args;return n.length===2?r==="pair"?{prim:"pair",args:n}:{prim:"Pair",args:n}:Object.assign(Object.assign({},Array.isArray(e)?{prim:r}:e),{args:[n[0],{prim:r,args:n.slice(1)}]})}function Ve(r){return Array.isArray(r)||r.prim==="pair"}function ec(r){return Array.isArray(r)||"prim"in r&&r.prim==="Pair"}const Qf=/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])[T ]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\.[0-9]+)?(Z|[+-]([01][0-9]|2[0-3]):([0-5][0-9]))$/;function rc(r){if("string"in r){if(tc(r.string))return new Date(parseInt(r.string,10));if(Qf.test(r.string)){const t=new Date(r.string);if(!Number.isNaN(t.valueOf))return t}}else if(es(r.int))return new Date(parseInt(r.int,10));return null}function tp(r){const t=[];for(let e=0;e<r.length;e+=2){const n=r.slice(e,e+2),i=parseInt(n,16);if(Number.isNaN(i))throw new Jf(n);t.push(i)}return t}function Pr(r){return r.map(t=>(t>>4&15).toString(16)+(t&15).toString(16)).join("")}const ep=31,nc={ABS:!0,ADD:!0,ADDRESS:!0,AMOUNT:!0,AND:!0,APPLY:!0,BALANCE:!0,BLAKE2B:!0,CAR:!0,CDR:!0,CHAIN_ID:!0,CHECK_SIGNATURE:!0,COMPARE:!0,CONCAT:!0,CONS:!0,EDIV:!0,EQ:!0,EXEC:!0,FAILWITH:!0,GE:!0,GET_AND_UPDATE:!0,GT:!0,HASH_KEY:!0,IMPLICIT_ACCOUNT:!0,INT:!0,ISNAT:!0,JOIN_TICKETS:!0,KECCAK:!0,LE:!0,LEVEL:!0,LSL:!0,LSR:!0,LT:!0,MEM:!0,MUL:!0,NEG:!0,NEQ:!0,NEVER:!0,NOT:!0,NOW:!0,OR:!0,PACK:!0,PAIRING_CHECK:!0,READ_TICKET:!0,SAPLING_VERIFY_UPDATE:!0,SELF:!0,SELF_ADDRESS:!0,SENDER:!0,SET_DELEGATE:!0,SHA256:!0,SHA3:!0,SHA512:!0,SIZE:!0,SLICE:!0,SOME:!0,SOURCE:!0,SPLIT_TICKET:!0,SUB:!0,SWAP:!0,TICKET:!0,TOTAL_VOTING_POWER:!0,TRANSFER_TOKENS:!0,UNIT:!0,VOTING_POWER:!0,XOR:!0,RENAME:!0,OPEN_CHEST:!0,SUB_MUTEZ:!0,MIN_BLOCK_TIME:!0},ic=Object.assign({},nc,{CONTRACT:!0,CREATE_CONTRACT:!0,DIG:!0,DIP:!0,DROP:!0,DUG:!0,DUP:!0,EMPTY_BIG_MAP:!0,EMPTY_MAP:!0,EMPTY_SET:!0,GET:!0,IF:!0,IF_CONS:!0,IF_LEFT:!0,IF_NONE:!0,ITER:!0,LAMBDA:!0,LEFT:!0,LOOP:!0,LOOP_LEFT:!0,MAP:!0,NIL:!0,NONE:!0,PAIR:!0,PUSH:!0,RIGHT:!0,SAPLING_EMPTY_STATE:!0,UNPACK:!0,UNPAIR:!0,UPDATE:!0,CAST:!0,VIEW:!0}),sc={unit:!0,never:!0,bool:!0,int:!0,nat:!0,string:!0,chain_id:!0,bytes:!0,mutez:!0,key_hash:!0,key:!0,signature:!0,timestamp:!0,address:!0,tx_rollup_l2_address:!0},Ur=Object.assign({},sc,{or:!0,pair:!0,set:!0,big_map:!0,contract:!0,lambda:!0,list:!0,map:!0,operation:!0,option:!0,bls12_381_g1:!0,bls12_381_g2:!0,bls12_381_fr:!0,sapling_transaction:!0,sapling_state:!0,ticket:!0,chest_key:!0,chest:!0});class Q extends Ft{constructor(t,e){super(t,e),this.val=t,Object.setPrototypeOf(this,Q.prototype)}}function _e(r){return"prim"in r}function rp(r){return Array.isArray(r)||"prim"in r}function oc(r){if(_e(r))return!0;throw new Q(r,"prim expression expected")}function Qe(r){if(Array.isArray(r))return!0;throw new Q(r,"sequence expression expected")}function Nt(r){if(rp(r))return!0;throw new Q(r,"prim or sequence expression expected")}function Gi(r){if(r.int[0]==="-")throw new Q(r,"natural number expected")}function Ln(r){if("int"in r)return!0;throw new Q(r,"int literal expected")}function ac(r){if("string"in r)return!0;throw new Q(r,"string literal expected")}function Y(r,t){var e;if(t===0&&r.args===void 0||((e=r.args)===null||e===void 0?void 0:e.length)===t)return!0;throw new Q(r,`${t} arguments expected`)}function ee(r){var t,e;if(Array.isArray(r)){for(const n of r){if(!Array.isArray(n)&&!_e(n))throw new Q(r,"sequence or prim expected");ee(n)}return!0}if(oc(r)){if(Object.prototype.hasOwnProperty.call(nc,r.prim))return Y(r,0),!0;switch(r.prim){case"DROP":case"PAIR":case"UNPAIR":case"DUP":case"UPDATE":case"GET":r.args!==void 0&&Y(r,1)&&Ln(r.args[0])&&Gi(r.args[0]);break;case"DIG":case"DUG":case"SAPLING_EMPTY_STATE":Y(r,1)&&Ln(r.args[0])&&Gi(r.args[0]);break;case"NONE":case"LEFT":case"RIGHT":case"NIL":case"CAST":Y(r,1)&&He(r.args[0]);break;case"UNPACK":Y(r,1)&&Ss(r.args[0]);break;case"CONTRACT":Y(r,1)&&ai(r.args[0]);break;case"IF_NONE":case"IF_LEFT":case"IF_CONS":case"IF":Y(r,2)&&(Qe(r.args[0])&&ee(r.args[0]),Qe(r.args[1])&&ee(r.args[1]));break;case"MAP":case"ITER":case"LOOP":case"LOOP_LEFT":Y(r,1)&&ee(r.args[0]);break;case"CREATE_CONTRACT":Y(r,1)&&uc(r.args[0]);break;case"DIP":if(((t=r.args)===null||t===void 0?void 0:t.length)===2)Ln(r.args[0])&&Gi(r.args[0]),Qe(r.args[1])&&ee(r.args[1]);else if(((e=r.args)===null||e===void 0?void 0:e.length)===1)Qe(r.args[0])&&ee(r.args[0]);else throw new Q(r,"1 or 2 arguments expected");break;case"PUSH":Y(r,2)&&(kr(r.args[0]),dr(r.args[1]));break;case"EMPTY_SET":Y(r,1)&&Ue(r.args[0]);break;case"EMPTY_MAP":Y(r,2)&&(Ue(r.args[0]),He(r.args[1]));break;case"EMPTY_BIG_MAP":Y(r,2)&&(Ue(r.args[0]),ci(r.args[1]));break;case"LAMBDA":Y(r,3)&&(He(r.args[0]),He(r.args[1]),Qe(r.args[2])&&ee(r.args[2]));break;case"VIEW":Y(r,2)&&(ac(r.args[0])&&cc(r.args[0]),He(r.args[1])&&kr(r.args[1]));break;default:throw new Q(r,"instruction expected")}}return!0}function Ue(r){if(Nt(r)){if(Array.isArray(r)||r.prim==="pair"||r.prim==="or"||r.prim==="option")_r(r,t=>Ue(t));else if(!Object.prototype.hasOwnProperty.call(sc,r.prim))throw new Q(r,`${r.prim}: type is not comparable`)}return!0}function Ss(r){if(Nt(r)&&_e(r)){if(!Object.prototype.hasOwnProperty.call(Ur,r.prim)||r.prim==="big_map"||r.prim==="operation"||r.prim==="sapling_state"||r.prim==="ticket")throw new Q(r,`${r.prim}: type can't be used inside PACK/UNPACK instructions`);_r(r,t=>Ss(t))}return!0}function kr(r){if(Nt(r)&&_e(r)){if(!Object.prototype.hasOwnProperty.call(Ur,r.prim)||r.prim==="big_map"||r.prim==="operation"||r.prim==="sapling_state"||r.prim==="ticket"||r.prim==="contract")throw new Q(r,`${r.prim}: type can't be pushed`);_r(r,t=>kr(t))}return!0}function Ps(r){if(Nt(r)&&_e(r)){if(!Object.prototype.hasOwnProperty.call(Ur,r.prim)||r.prim==="operation"||r.prim==="contract")throw new Q(r,`${r.prim}: type can't be used as part of a storage`);_r(r,t=>Ps(t))}return!0}function ai(r){if(Nt(r)&&_e(r)){if(!Object.prototype.hasOwnProperty.call(Ur,r.prim)||r.prim==="operation")throw new Q(r,`${r.prim}: type can't be used as part of a parameter`);_r(r,t=>ai(t))}return!0}function ci(r){if(Nt(r)&&_e(r)){if(!Object.prototype.hasOwnProperty.call(Ur,r.prim)||r.prim==="big_map"||r.prim==="operation"||r.prim==="sapling_state")throw new Q(r,`${r.prim}: type can't be used inside a big_map`);_r(r,t=>ci(t))}return!0}const np=new RegExp("^[a-zA-Z0-9_.%@]*$");function cc(r){if(r.string.length>ep)throw new Q(r,`view name too long: ${r.string}`);if(!np.test(r.string))throw new Q(r,`invalid character(s) in view name: ${r.string}`)}function He(r){if(Nt(r)&&_e(r)){if(!Object.prototype.hasOwnProperty.call(Ur,r.prim))throw new Q(r,"type expected");_r(r,t=>He(t))}return!0}function _r(r,t){if(Array.isArray(r)||r.prim==="pair"){const e=Array.isArray(r)?r:r.args;if(e===void 0||e.length<2)throw new Q(r,"at least 2 arguments expected");return e.forEach(n=>{Nt(n)&&t(n)}),!0}switch(r.prim){case"option":case"list":Y(r,1)&&Nt(r.args[0])&&t(r.args[0]);break;case"contract":Y(r,1)&&ai(r.args[0]);break;case"or":Y(r,2)&&Nt(r.args[0])&&Nt(r.args[1])&&(t(r.args[0]),t(r.args[1]));break;case"lambda":Y(r,2)&&(He(r.args[0]),He(r.args[1]));break;case"set":Y(r,1)&&Ue(r.args[0]);break;case"map":Y(r,2)&&Nt(r.args[0])&&Nt(r.args[1])&&(Ue(r.args[0]),t(r.args[1]));break;case"big_map":Y(r,2)&&Nt(r.args[0])&&Nt(r.args[1])&&(Ue(r.args[0]),ci(r.args[1]),t(r.args[1]));break;case"ticket":Y(r,1)&&Nt(r.args[0])&&Ue(r.args[0]);break;case"sapling_state":case"sapling_transaction":Y(r,1)&&Ln(r.args[0]);break;default:Y(r,0)}return!0}function dr(r){if("int"in r||"string"in r||"bytes"in r)return!0;if(Array.isArray(r)){let t=0;for(const e of r)_e(e)&&e.prim==="Elt"?(Y(e,2)&&(dr(e.args[0]),dr(e.args[1])),t++):dr(e);if(t!==0&&t!==r.length)throw new Q(r,"data entries and map elements can't be intermixed");return!0}if(_e(r))switch(r.prim){case"Unit":case"True":case"False":case"None":Y(r,0);break;case"Pair":if(r.args===void 0||r.args.length<2)throw new Q(r,"at least 2 arguments expected");for(const t of r.args)dr(t);break;case"Left":case"Right":case"Some":Y(r,1)&&dr(r.args[0]);break;default:if(Object.prototype.hasOwnProperty.call(ic,r.prim))ee(r);else throw new Q(r,"data entry or instruction expected")}else throw new Q(r,"data entry expected");return!0}function uc(r){if(Qe(r)){const t={},e={};for(const n of r)if(oc(n)){if(n.prim!=="view"){if(n.prim in t)throw new Q(r,`duplicate contract section: ${n.prim}`);t[n.prim]=!0}switch(n.prim){case"code":Y(n,1)&&Qe(n.args[0])&&ee(n.args[0]);break;case"parameter":if(Y(n,1)&&ai(n.args[0]),n.annots)throw new Q(n,"Annotation must be part of the parameter type");break;case"storage":Y(n,1)&&Ps(n.args[0]);break;case"view":if(Y(n,4)){if(ac(n.args[0])){const i=n.args[0];if(i.string in e)throw new Q(r,`duplicate view name: ${i.string}`);e[i.string]=!0,cc(i)}kr(n.args[1]),kr(n.args[2]),Qe(n.args[3])&&ee(n.args[3])}break;default:throw new Q(r,`unexpected contract section: ${n.prim}`)}}}return!0}function lc(r){return Object.prototype.hasOwnProperty.call(ic,r.prim)}function rs(r){if(!Array.isArray(r))return!1;for(const t of r)if("prim"in t){if(lc(t))throw new Ft(r,`Instruction outside of a lambda: ${JSON.stringify(r)}`);if(t.prim==="Elt")throw new Ft(r,`Elt item outside of a map literal: ${JSON.stringify(r)}`)}return!0}function ip(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e}const sp=["parameter","storage","code","False","Elt","Left","None","Pair","Right","Some","True","Unit","PACK","UNPACK","BLAKE2B","SHA256","SHA512","ABS","ADD","AMOUNT","AND","BALANCE","CAR","CDR","CHECK_SIGNATURE","COMPARE","CONCAT","CONS","CREATE_ACCOUNT","CREATE_CONTRACT","IMPLICIT_ACCOUNT","DIP","DROP","DUP","EDIV","EMPTY_MAP","EMPTY_SET","EQ","EXEC","FAILWITH","GE","GET","GT","HASH_KEY","IF","IF_CONS","IF_LEFT","IF_NONE","INT","LAMBDA","LE","LEFT","LOOP","LSL","LSR","LT","MAP","MEM","MUL","NEG","NEQ","NIL","NONE","NOT","NOW","OR","PAIR","PUSH","RIGHT","SIZE","SOME","SOURCE","SENDER","SELF","STEPS_TO_QUOTA","SUB","SWAP","TRANSFER_TOKENS","SET_DELEGATE","UNIT","UPDATE","XOR","ITER","LOOP_LEFT","ADDRESS","CONTRACT","ISNAT","CAST","RENAME","bool","contract","int","key","key_hash","lambda","list","map","big_map","nat","option","or","pair","set","signature","string","bytes","mutez","timestamp","unit","operation","address","SLICE","DIG","DUG","EMPTY_BIG_MAP","APPLY","chain_id","CHAIN_ID","LEVEL","SELF_ADDRESS","never","NEVER","UNPAIR","VOTING_POWER","TOTAL_VOTING_POWER","KECCAK","SHA3","PAIRING_CHECK","bls12_381_g1","bls12_381_g2","bls12_381_fr","sapling_state","sapling_transaction","SAPLING_EMPTY_STATE","SAPLING_VERIFY_UPDATE","ticket","TICKET","READ_TICKET","SPLIT_TICKET","JOIN_TICKETS","GET_AND_UPDATE","chest","chest_key","OPEN_CHEST","VIEW","view","constant","SUB_MUTEZ"],op=Object.assign({},...sp.map((r,t)=>({[r]:t})));var ze;(function(r){r[r.Int=0]="Int",r[r.String=1]="String",r[r.Sequence=2]="Sequence",r[r.Prim0=3]="Prim0",r[r.Prim0Annot=4]="Prim0Annot",r[r.Prim1=5]="Prim1",r[r.Prim1Annot=6]="Prim1Annot",r[r.Prim2=7]="Prim2",r[r.Prim2Annot=8]="Prim2Annot",r[r.Prim=9]="Prim",r[r.Bytes=10]="Bytes"})(ze||(ze={}));class Mr{constructor(){this.buffer=[]}get length(){return this.buffer.length}writeBytes(t){this.buffer.push(...t.map(e=>e&255))}writeUint8(t){const e=t|0;this.buffer.push(e&255)}writeUint16(t){const e=t|0;this.buffer.push(e>>8&255),this.buffer.push(e&255)}writeUint32(t){const e=t|0;this.buffer.push(e>>24&255),this.buffer.push(e>>16&255),this.buffer.push(e>>8&255),this.buffer.push(e&255)}writeInt8(t){this.writeUint8(t)}writeInt16(t){this.writeUint16(t)}writeInt32(t){this.writeUint32(t)}}const qe=new Error("bounds out of range");class jr{constructor(t,e=0,n=t.length){this.buffer=t,this.idx=e,this.cap=n}get length(){return this.cap-this.idx}readBytes(t){if(this.cap-this.idx<t)throw qe;const e=this.buffer.slice(this.idx,this.idx+t);return this.idx+=t,e}reader(t){if(this.cap-this.idx<t)throw qe;const e=new jr(this.buffer,this.idx,this.idx+t);return this.idx+=t,e}copy(){return new jr(this.buffer,this.idx,this.cap)}readUint8(){if(this.cap-this.idx<1)throw qe;return this.buffer[this.idx++]>>>0}readUint16(){if(this.cap-this.idx<2)throw qe;const t=this.buffer[this.idx++],e=this.buffer[this.idx++];return(t<<8|e)>>>0}readUint32(){if(this.cap-this.idx<4)throw qe;const t=this.buffer[this.idx++],e=this.buffer[this.idx++],n=this.buffer[this.idx++],i=this.buffer[this.idx++];return(t<<24|e<<16|n<<8|i)>>>0}readInt8(){if(this.cap-this.idx<1)throw qe;return this.buffer[this.idx++]<<24>>24}readInt16(){if(this.cap-this.idx<2)throw qe;const t=this.buffer[this.idx++],e=this.buffer[this.idx++];return(t<<8|e)<<16>>16}readInt32(){if(this.cap-this.idx<4)throw qe;const t=this.buffer[this.idx++],e=this.buffer[this.idx++],n=this.buffer[this.idx++],i=this.buffer[this.idx++];return t<<24|e<<16|n<<8|i}}var Vr;(function(r){r[r.Implicit=0]="Implicit",r[r.Originated=1]="Originated"})(Vr||(Vr={}));var er;(function(r){r[r.ED25519=0]="ED25519",r[r.SECP256K1=1]="SECP256K1",r[r.P256=2]="P256"})(er||(er={}));function hc(r){let t;const e=r.readUint8();switch(e){case er.ED25519:t="ED25519PublicKeyHash";break;case er.SECP256K1:t="SECP256K1PublicKeyHash";break;case er.P256:t="P256PublicKeyHash";break;default:throw new Error(`unknown public key hash tag: ${e}`)}return{type:t,hash:r.readBytes(20)}}function ap(r){let t;const e=r.readUint8();switch(e){case Vr.Implicit:t=hc(r);break;case Vr.Originated:t={type:"ContractHash",hash:r.readBytes(20)},r.readBytes(1);break;default:throw new Error(`unknown address tag: ${e}`)}if(r.length!==0){const n=new TextDecoder;t.entryPoint=n.decode(new Uint8Array(r.readBytes(r.length)))}return t}function fc(r,t){let e;switch(r.type){case"ED25519PublicKeyHash":e=er.ED25519;break;case"SECP256K1PublicKeyHash":e=er.SECP256K1;break;case"P256PublicKeyHash":e=er.P256;break;default:throw new Error(`unexpected address type: ${r.type}`)}t.writeUint8(e),t.writeBytes(Array.from(r.hash))}function cp(r,t){if(r.type==="ContractHash"?(t.writeUint8(Vr.Originated),t.writeBytes(Array.from(r.hash)),t.writeUint8(0)):(t.writeUint8(Vr.Implicit),fc(r,t)),r.entryPoint!==void 0&&r.entryPoint!==""&&r.entryPoint!=="default"){const n=new TextEncoder().encode(r.entryPoint);t.writeBytes(Array.from(n))}}var rr;(function(r){r[r.ED25519=0]="ED25519",r[r.SECP256K1=1]="SECP256K1",r[r.P256=2]="P256"})(rr||(rr={}));function up(r){let t,e;const n=r.readUint8();switch(n){case rr.ED25519:e="ED25519PublicKey",t=32;break;case rr.SECP256K1:e="SECP256K1PublicKey",t=33;break;case rr.P256:e="P256PublicKey",t=33;break;default:throw new Error(`unknown public key tag: ${n}`)}return{type:e,publicKey:r.readBytes(t)}}function lp(r,t){let e;switch(r.type){case"ED25519PublicKey":e=rr.ED25519;break;case"SECP256K1PublicKey":e=rr.SECP256K1;break;case"P256PublicKey":e=rr.P256;break;default:throw new Error(`unexpected public key type: ${r.type}`)}t.writeUint8(e),t.writeBytes(Array.from(r.publicKey))}function Cn(r,t,e){var n,i;const[s,o]=e(r);if(Array.isArray(s)){const m=new Mr;for(const y of s){const v=o.next();if(v.done)throw new Error("REPORT ME: iterator is done");Cn(y,m,v.value)}t.writeUint8(ze.Sequence),t.writeUint32(m.length),t.writeBytes(m.buffer);return}if("string"in s){const y=new TextEncoder().encode(s.string);t.writeUint8(ze.String),t.writeUint32(y.length),t.writeBytes(Array.from(y));return}if("int"in s){t.writeUint8(ze.Int);let m=BigInt(s.int);const y=m<0;y&&(m=-m);let v=0;do{const P=BigInt(v===0?6:7);let T=m&(BigInt(1)<<P)-BigInt(1);m>>=P,m&&(T|=BigInt(128)),v===0&&y&&(T|=BigInt(64)),t.writeUint8(Number(T)),v++}while(m);return}if("bytes"in s){const m=tp(s.bytes);t.writeUint8(ze.Bytes),t.writeUint32(m.length),t.writeBytes(m);return}const c=op[s.prim];if(c===void 0)throw new TypeError(`Can't encode primary: ${s.prim}`);const l=(((n=s.args)===null||n===void 0?void 0:n.length)||0)<3?ze.Prim0+(((i=s.args)===null||i===void 0?void 0:i.length)||0)*2+(s.annots===void 0||s.annots.length===0?0:1):ze.Prim;if(t.writeUint8(l),t.writeUint8(c),s.args!==void 0)if(s.args.length<3)for(const m of s.args){const y=o.next();if(y.done)throw new Error("REPORT ME: iterator is done");Cn(m,t,y.value)}else{const m=new Mr;for(const y of s.args){const v=o.next();if(v.done)throw new Error("REPORT ME: iterator is done");Cn(y,m,v.value)}t.writeUint32(m.length),t.writeBytes(m.buffer)}if(s.annots!==void 0&&s.annots.length!==0){const y=new TextEncoder().encode(s.annots.join(" "));t.writeUint32(y.length),t.writeBytes(Array.from(y))}else s.args!==void 0&&s.args.length>=3&&t.writeUint32(0)}const hp=r=>"prim"in r&&(r.prim==="Left"||r.prim==="Right"),fp=r=>"prim"in r&&(r.prim==="Some"||r.prim==="None"),gr=r=>{if(Ve(r))return t=>{if(!ec(t))throw new M(r,t,`pair expected: ${JSON.stringify(t)}`);rs(t);const e=jt("pair",r);return[jt("Pair",t),function*(){for(const i of e.args)yield gr(i)}()]};switch(r.prim){case"or":return t=>{if(!hp(t))throw new M(r,t,`or expected: ${JSON.stringify(t)}`);return[t,function*(){yield gr(r.args[t.prim==="Left"?0:1])}()]};case"option":return t=>{if(!fp(t))throw new M(r,t,`option expected: ${JSON.stringify(t)}`);return[t,function*(){t.prim==="Some"&&(yield gr(r.args[0]))}()]};case"list":case"set":return t=>{if(!Array.isArray(t))throw new M(r,t,`${r.prim} expected: ${JSON.stringify(t)}`);return[t,function*(){for(const e of t)yield gr(r.args[0])}()]};case"map":return t=>{if(!Array.isArray(t))throw new M(r,t,`map expected: ${JSON.stringify(t)}`);return[t,function*(){for(const e of t)yield n=>{if(!("prim"in n)||n.prim!=="Elt")throw new M(r,n,`map element expected: ${JSON.stringify(n)}`);return[n,function*(){for(const i of r.args)yield gr(i)}()]}}()]};case"chain_id":return t=>{if(!("bytes"in t)&&!("string"in t))throw new M(r,t,`chain id expected: ${JSON.stringify(t)}`);let e;if("string"in t){const n=je(t.string,"ChainID");if(n===null)throw new M(r,t,`chain id base58 expected: ${t.string}`);e={bytes:Pr(n[1])}}else e=t;return[e,[][Symbol.iterator]()]};case"signature":return t=>{if(!("bytes"in t)&&!("string"in t))throw new M(r,t,`signature expected: ${JSON.stringify(t)}`);let e;if("string"in t){const n=je(t.string,"ED25519Signature","SECP256K1Signature","P256Signature","GenericSignature");if(n===null)throw new M(r,t,`signature base58 expected: ${t.string}`);e={bytes:Pr(n[1])}}else e=t;return[e,[][Symbol.iterator]()]};case"key_hash":return t=>{if(!("bytes"in t)&&!("string"in t))throw new M(r,t,`key hash expected: ${JSON.stringify(t)}`);let e;if("string"in t){const n=je(t.string,"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash");if(n===null)throw new M(r,t,`key hash base58 expected: ${t.string}`);const i=new Mr;fc({type:n[0],hash:n[1]},i),e={bytes:Pr(i.buffer)}}else e=t;return[e,[][Symbol.iterator]()]};case"key":return t=>{if(!("bytes"in t)&&!("string"in t))throw new M(r,t,`public key expected: ${JSON.stringify(t)}`);let e;if("string"in t){const n=je(t.string,"ED25519PublicKey","SECP256K1PublicKey","P256PublicKey");if(n===null)throw new M(r,t,`public key base58 expected: ${t.string}`);const i=new Mr;lp({type:n[0],publicKey:n[1]},i),e={bytes:Pr(i.buffer)}}else e=t;return[e,[][Symbol.iterator]()]};case"address":return t=>{if(!("bytes"in t)&&!("string"in t))throw new M(r,t,`address expected: ${JSON.stringify(t)}`);let e;if("string"in t){const n=t.string.split("%"),i=je(n[0],"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash","ContractHash");if(i===null)throw new M(r,t,`address base58 expected: ${t.string}`);const s=new Mr;cp({type:i[0],hash:i[1],entryPoint:n.length>1?n[1]:void 0},s),e={bytes:Pr(s.buffer)}}else e=t;return[e,[][Symbol.iterator]()]};case"timestamp":return t=>{if(!("string"in t)&&!("int"in t))throw new M(r,t,`timestamp expected: ${JSON.stringify(t)}`);let e;if("string"in t){const n=rc(t);if(n===null)throw new M(r,t,`can't parse date: ${t.string}`);e={int:String(Math.floor(n.getTime()/1e3))}}else e=t;return[e,[][Symbol.iterator]()]};default:return Hn}},pp=r=>"prim"in r&&r.prim==="PUSH",Hn=r=>pp(r)?(ee(r),[r,function*(){yield Hn,yield gr(r.args[0])}()]):[r,function*(){for(;;)yield Hn}()];function dp(r,t){const e=new Mr;return e.writeUint8(5),Cn(r,e,t!==void 0?gr(t):Hn),e.buffer}function gp(r,t){return{bytes:Pr(dp(r,t))}}function mp(r){const t=Cr(r.bytes);if(t===null)throw new Error(`can't parse bytes: "${r.bytes}"`);const e=new jr(new Uint8Array(t));return ap(e)}function yp(r){const t=Cr(r.bytes);if(t===null)throw new Error(`can't parse bytes: "${r.bytes}"`);const e=new jr(new Uint8Array(t));return hc(e)}function bp(r){const t=Cr(r.bytes);if(t===null)throw new Error(`can't parse bytes: "${r.bytes}"`);const e=new jr(new Uint8Array(t));return up(e)}class H extends Ft{constructor(t,e,n){super(t,n),this.stackState=e,Object.setPrototypeOf(this,H.prototype)}}function tt(r){return Array.isArray(r)?"pair":r.prim}function Un(r){return"prim"in r?r.args:r}function re(r,t,e=!1){if(tt(r)!==tt(t))throw new M(r,void 0,`types mismatch: ${tt(r)} != ${tt(t)}`);const n=[$r(r),$r(t)];if(n[0].t&&n[1].t&&n[0].t[0]!==n[1].t[0])throw new M(r,void 0,`${tt(r)}: type names mismatch: ${n[0].t[0]} != ${n[1].t[0]}`);if(e&&n[0].f&&n[1].f&&n[0].f[0]!==n[1].f[0])throw new M(r,void 0,`${tt(r)}: field names mismatch: ${n[0].f[0]} != ${n[1].f}`);if(Ve(r)){const i=jt("pair",r),s=jt("pair",t);re(i.args[0],s.args[0],!0),re(i.args[1],s.args[1],!0);return}switch(r.prim){case"option":case"list":case"contract":case"set":case"ticket":re(r.args[0],t.args[0]);break;case"or":re(r.args[0],t.args[0],!0),re(r.args[1],t.args[1],!0);break;case"lambda":case"map":case"big_map":re(r.args[0],t.args[0]),re(r.args[1],t.args[1]);break;case"sapling_state":case"sapling_transaction":if(parseInt(r.args[0].int,10)!==parseInt(t.args[0].int,10))throw new M(r,void 0,`${tt(r)}: type argument mismatch: ${r.args[0].int} != ${t.args[0].int}`)}}function pc(r,t){if(r.length!==t.length)throw new M(r,void 0,`stack length mismatch: ${r.length} != ${t.length}`);for(let e=0;e<r.length;e++)re(r[e],t[e])}function lt(r,t=!1){var e,n,i;if(!Array.isArray(r)){const s=$r(r);if((((e=s.t)===null||e===void 0?void 0:e.length)||0)>1)throw new M(r,void 0,`${r.prim}: at most one type annotation allowed: ${r.annots}`);if(t){if((((n=s.f)===null||n===void 0?void 0:n.length)||0)>1)throw new M(r,void 0,`${r.prim}: at most one field annotation allowed: ${r.annots}`)}else if((((i=s.f)===null||i===void 0?void 0:i.length)||0)>0)throw new M(r,void 0,`${r.prim}: field annotations aren't allowed: ${r.annots}`)}if(Ve(r)){const s=Un(r);for(const o of s)lt(o,!0);return}switch(r.prim){case"option":case"list":case"contract":case"set":lt(r.args[0]);break;case"or":for(const s of r.args)lt(s,!0);break;case"lambda":case"map":case"big_map":lt(r.args[0]),lt(r.args[1])}}function dc(r){if(!Array.isArray(r))return!1;for(const t of r)if(!(Array.isArray(t)&&dc(t)||"prim"in t&&lc(t)))return!1;return!0}function te(r,t,e){if(Ve(t)){if(ec(r)){rs(r);const n=jt("Pair",r),i=jt("pair",t);te(n.args[0],i.args[0],e),te(n.args[1],i.args[1],e);return}throw new M(t,r,`pair expected: ${JSON.stringify(r)}`)}switch(t.prim){case"int":if("int"in r&&es(r.int))return;throw new M(t,r,`integer value expected: ${JSON.stringify(r)}`);case"nat":case"mutez":if("int"in r&&tc(r.int))return;throw new M(t,r,`natural value expected: ${JSON.stringify(r)}`);case"string":if("string"in r)return;throw new M(t,r,`string value expected: ${JSON.stringify(r)}`);case"bytes":case"bls12_381_g1":case"bls12_381_g2":if("bytes"in r&&Cr(r.bytes)!==null)return;throw new M(t,r,`bytes value expected: ${JSON.stringify(r)}`);case"bool":if("prim"in r&&(r.prim==="True"||r.prim==="False"))return;throw new M(t,r,`boolean value expected: ${JSON.stringify(r)}`);case"key_hash":if("string"in r&&je(r.string,"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash")!==null)return;if("bytes"in r)try{yp(r);return}catch{}throw new M(t,r,`key hash expected: ${JSON.stringify(r)}`);case"timestamp":if(("string"in r||"int"in r)&&rc(r)!==null)return;throw new M(t,r,`timestamp expected: ${JSON.stringify(r)}`);case"address":if("string"in r){let n=r.string;const i=r.string.indexOf("%");if(i>=0&&(n=r.string.slice(0,i)),je(n,"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash","ContractHash","TxRollupL2Address","RollupAddress")!==null)return}else if("bytes"in r)try{mp(r);return}catch{}throw new M(t,r,`address expected: ${JSON.stringify(r)}`);case"key":if("string"in r&&je(r.string,"ED25519PublicKey","SECP256K1PublicKey","P256PublicKey")!==null)return;if("bytes"in r)try{bp(r);return}catch{}throw new M(t,r,`public key expected: ${JSON.stringify(r)}`);case"unit":if("prim"in r&&r.prim==="Unit")return;throw new M(t,r,`unit value expected: ${JSON.stringify(r)}`);case"signature":if("bytes"in r||"string"in r&&je(r.string,"ED25519Signature","SECP256K1Signature","P256Signature","GenericSignature")!==null)return;throw new M(t,r,`signature expected: ${JSON.stringify(r)}`);case"chain_id":if(("bytes"in r||"string"in r)&&("string"in r?Za(r.string):Cr(r.bytes))!==null)return;throw new M(t,r,`chain id expected: ${JSON.stringify(r)}`);case"option":if("prim"in r){if(r.prim==="None")return;if(r.prim==="Some"){te(r.args[0],t.args[0],e);return}}throw new M(t,r,`option expected: ${JSON.stringify(r)}`);case"list":case"set":if(rs(r)){for(const n of r)te(n,t.args[0],e);return}throw new M(t,r,`${t.prim} expected: ${JSON.stringify(r)}`);case"or":if("prim"in r){if(r.prim==="Left"){te(r.args[0],t.args[0],e);return}else if(r.prim==="Right"){te(r.args[0],t.args[1],e);return}}throw new M(t,r,`union (or) expected: ${JSON.stringify(r)}`);case"lambda":if(dc(r)){const n=At(r,[t.args[0]],e);if("failed"in n)throw new M(t,r,`function is failed with error type: ${n.failed}`);if(n.length!==1)throw new M(t,r,"function must return a value");re(t.args[1],n[0]);return}throw new M(t,r,`function expected: ${JSON.stringify(r)}`);case"map":case"big_map":if(Array.isArray(r)){for(const n of r){if(!("prim"in n)||n.prim!=="Elt")throw new M(t,r,`map elements expected: ${JSON.stringify(r)}`);te(n.args[0],t.args[0],e),te(n.args[1],t.args[1],e)}return}throw new M(t,r,`${t.prim} expected: ${JSON.stringify(r)}`);case"bls12_381_fr":if("int"in r&&es(r.int)||"bytes"in r&&Cr(r.bytes)!==null)return;throw new M(t,r,`BLS12-381 element expected: ${JSON.stringify(r)}`);case"sapling_state":if(Array.isArray(r))return;throw new M(t,r,`sapling state expected: ${JSON.stringify(r)}`);case"ticket":te(r,{prim:"pair",args:[{prim:"address"},t.args[0],{prim:"nat"}]},e);return;default:throw new M(t,r,`type ${tt(t)} don't have Michelson literal representation`)}}function Ep(r,t,e){let n=t,i=t,s=0;for(const o of r){const c=At(o,i,e);if(n=c,"failed"in c)break;i=c,s++}if("failed"in n&&n.level==0&&(!("prim"in n.failed)||n.failed.prim!=="never")&&s!==r.length-1)throw new H(r,n,"FAIL must appear in a tail position");if((e==null?void 0:e.traceCallback)!==void 0){const o={op:r,in:t,out:n};e.traceCallback(o)}return"failed"in n?{failed:n.failed,level:n.level+1}:n}function At(r,t,e){const n=(e==null?void 0:e.protocol)||Xa;if(Array.isArray(r))return Ep(r,t,e);const i=r;function s(u,...b){if(t.length<b.length+u)throw new H(i,t,`${i.prim}: stack must have at least ${b.length} element(s)`);let d=u;for(const w of b){if(w!==null&&w.length!==0){let O=0;for(;O<w.length&&w[O]!==tt(t[d]);)O++;if(O===w.length)throw new H(i,t,`${i.prim}: stack type mismatch: [${d}] expected to be ${w}, got ${tt(t[d])} instead`)}d++}return t.slice(u,b.length+u)}function o(u){return(...b)=>{try{return u(...b)}catch(d){throw d instanceof Ft?new H(i,t,d.message):d}}}function c(u){return b=>{try{return u(b)}catch(d){throw d instanceof Ft?new H(i,t,d.message):d}}}const l=o($r),m=o(pc),y=o(re),v=c(Ue),P=c(Ss),T=c(Ps),D=c(kr),W=c(ci);function C(u,b){const d=l(i,Object.assign(Object.assign({},b),{emptyFields:u.f!==void 0&&u.f>1,emptyVar:u.v!==void 0&&u.v>1})),w=(O,E,a)=>{if(O&&O.length>(E||0))throw new H(i,t,`${i.prim}: at most ${E||0} ${a} annotations allowed`)};return w(d.f,u.f,"field"),w(d.t,u.t,"type"),w(d.v,u.v,"variable"),d}function L(u,b){const d=u,w=Array.isArray(d)?{prim:"pair",args:d}:d,O=l(w),E=b.v!==void 0||b.t!==void 0||b.f!==void 0?[...(b.v===null?O.v:b.v)||[],...(b.t===null?O.t:b.t)||[],...(b.f===null?O.f:b.f)||[]]:void 0,a=ip(w,["annots"]);return Object.assign(Object.assign({},a),E&&E.length!==0&&{annots:E})}function _(u,b){const d=C({v:1});return L(u,{v:d.v!==void 0?d.v:b!==void 0?[b]:null,t:null})}function nt(u,b,d,w,O){var E,a,f,g;const R=(E=l(b).f)===null||E===void 0?void 0:E[0],N=(a=d.f)===null||a===void 0?void 0:a[w];if(N!==void 0&&N!=="%"&&R!==void 0&&N!==R)throw new H(i,t,`${i.prim}: field names doesn't match: ${N} !== ${R}`);const x=(f=d.v)===null||f===void 0?void 0:f[w],$=(g=l(u).v)===null||g===void 0?void 0:g[0];return L(b,{t:null,v:x?x==="@%"?R?["@"+R.slice(1)]:void 0:x==="@%%"?$?["@"+$.slice(1)+"."+(R?R.slice(1):O)]:R?["@"+R.slice(1)]:void 0:[x]:null})}function B(u,b,d=b){const w=jt("pair",u);if(d===1)return[w.args[0]];if(d===2)return w.args;const O=w.args[1];if(Ve(O))return[w.args[0],...B(O,b,d-1)];throw new H(i,t,`${i.prim}: at least ${b} fields are expected`)}function Ge(u,b,d=b){if(d===0)return u;const w=jt("pair",u);if(d===1)return w.args[0];const O=w.args[1];if(Ve(O))return Ge(O,b,d-2);if(d===2)return O;throw new H(i,t,`${i.prim}: at least ${b+1} fields are expected`)}function Rt(u,b,d,w=d){if(w===0)return b;const O=jt("pair",u);if(w===1)return Object.assign(Object.assign({},O),{args:[b,O.args[1]]});const E=O.args[1];if(Ve(E))return Object.assign(Object.assign({},O),{args:[O.args[0],Rt(E,b,d,w-2)]});if(w===2)return Object.assign(Object.assign({},O),{args:[O.args[0],b]});throw new H(i,t,`${i.prim}: at least ${d+1} fields are expected`)}const ht=(u,b)=>["@"+(u.v?u.v[0].slice(1)+".":"")+b];function h(u,b){return"failed"in u||"failed"in b?"failed"in u?b:u:(m(u,b),u)}const p=(u=>{var b,d,w,O,E;switch(u.prim){case"DUP":{const a=u.args?parseInt(u.args[0].int,10):1;if(a===0)throw new H(u,t,"DUP 0 is forbidden");const f=s(a-1,null)[0];if(tt(f)==="ticket")throw new H(u,t,"ticket can't be DUPed");return[f,...t]}case"SWAP":{const a=s(0,null,null);return C({}),[a[1],a[0],...t.slice(2)]}case"SOME":return[L({prim:"option",args:[s(0,null)[0]]},C({t:1,v:1})),...t.slice(1)];case"UNIT":return[L({prim:"unit"},C({v:1,t:1})),...t];case"PAIR":{const a=u.args?parseInt(u.args[0].int,10):2;if(a<2)throw new H(u,t,`PAIR ${a} is forbidden`);const f=s(0,...new Array(a).fill(null)),g=C({f:a,t:1,v:1},{specialFields:!0}),R=x=>{const $=x.lastIndexOf(".");return x.slice($>0?$+1:1)},N=f.map((x,$)=>{var it;const dt=l(x),q=g.f&&g.f.length>$&&g.f[$]!=="%"?g.f[$]==="%@"?dt.v?["%"+R(((it=dt.v)===null||it===void 0?void 0:it[0])||"")]:void 0:[g.f[$]]:void 0;return L(x,{v:null,t:null,f:q})});return[L({prim:"pair",args:N},{t:g.t,v:g.v}),...t.slice(a)]}case"UNPAIR":{const a=u.args?parseInt(u.args[0].int,10):2;if(a<2)throw new H(u,t,`UNPAIR ${a} is forbidden`);const f=s(0,["pair"])[0],g=C({f:2,v:2},{specialVar:!0});return[...B(f,a).map((N,x)=>nt(f,N,g,x,x===0?"car":"cdr")),...t.slice(1)]}case"CAR":case"CDR":{const a=jt("pair",s(0,["pair"])[0]),f=a.args[u.prim==="CAR"?0:1],g=C({f:1,v:1},{specialVar:!0});return[nt(a,f,g,0,u.prim.toLocaleLowerCase()),...t.slice(1)]}case"CONS":{const a=s(0,null,["list"]);return y(a[0],a[1].args[0]),[_({prim:"list",args:[a[1].args[0]]}),...t.slice(2)]}case"SIZE":return s(0,["string","list","set","map","bytes"]),[_({prim:"nat"}),...t.slice(1)];case"MEM":{const a=s(0,null,["set","map","big_map"]);return v(a[0]),y(a[0],a[1].args[0]),[_({prim:"bool"}),...t.slice(2)]}case"GET":if(u.args){const a=parseInt(u.args[0].int,10),f=s(0,["pair"])[0];return[_(Ge(f,a)),...t.slice(1)]}else{const a=s(0,null,["map","big_map"]);return v(a[0]),y(a[0],a[1].args[0]),[_({prim:"option",args:[a[1].args[1]]}),...t.slice(2)]}case"UPDATE":if(u.args){const a=parseInt(u.args[0].int,10),f=s(0,null,["pair"]);return[_(Rt(f[1],f[0],a)),...t.slice(2)]}else{const a=s(0,null,["bool","option"]);if(v(a[0]),a[1].prim==="bool"){const g=s(2,["set"]);return y(a[0],g[0].args[0]),[_({prim:"set",args:[L(a[0],{t:null})]}),...t.slice(3)]}const f=s(2,["map","big_map"]);return y(a[0],f[0].args[0]),f[0].prim==="map"?[_({prim:"map",args:[L(a[0],{t:null}),L(a[1].args[0],{t:null})]}),...t.slice(3)]:(W(a[1].args[0]),[_({prim:"big_map",args:[L(a[0],{t:null}),L(a[1].args[0],{t:null})]}),...t.slice(3)])}case"GET_AND_UPDATE":{const a=C({v:2}),f=s(0,null,["option"],["map","big_map"]);v(f[0]),y(f[0],f[2].args[0]),y(f[1].args[0],f[2].args[1]);const g=(b=a.v)===null||b===void 0?void 0:b.map(R=>R!=="@"?[R]:void 0);return f[2].prim==="map"?[L({prim:"option",args:[f[2].args[1]]},{v:g==null?void 0:g[0]}),L({prim:"map",args:[L(f[0],{t:null}),L(f[1].args[0],{t:null})]},{v:g==null?void 0:g[1]}),...t.slice(3)]:(W(f[1].args[0]),[L({prim:"option",args:[f[2].args[1]]},{v:g==null?void 0:g[0]}),L({prim:"big_map",args:[L(f[0],{t:null}),L(f[1].args[0],{t:null})]},{v:g==null?void 0:g[1]}),...t.slice(3)])}case"EXEC":{const a=s(0,null,["lambda"]);return y(a[0],a[1].args[0]),[_(a[1].args[1]),...t.slice(2)]}case"APPLY":{const a=s(0,null,["lambda"]);if(T(a[0]),D(a[0]),!Ve(a[1].args[0]))throw new H(u,t,`${u.prim}: function's argument must be a pair: ${tt(a[1].args[0])}`);const f=a[1].args[0];return y(a[0],Un(f)[0]),[_({prim:"lambda",args:[Un(f)[1],a[1].args[1]]}),...t.slice(2)]}case"FAILWITH":{const a=s(0,null)[0];return zr(n,tr.PtEdo2Zk)||P(a),{failed:a,level:0}}case"NEVER":return s(0,["never"]),{failed:{prim:"never"},level:0};case"RENAME":return[_(s(0,null)[0]),...t.slice(1)];case"CONCAT":{const a=s(0,["string","list","bytes"]);if(a[0].prim==="list"){if(tt(a[0].args[0])!=="string"&&tt(a[0].args[0])!=="bytes")throw new H(u,t,`${u.prim}: can't concatenate list of ${tt(a[0].args[0])}'s`);return[_(a[0].args[0]),...t.slice(1)]}const f=s(1,["string","bytes"]);if(a[0].prim!==f[0].prim)throw new H(u,t,`${u.prim}: can't concatenate ${a[0].prim} with ${f[0].prim}`);return[_(f[0]),...t.slice(2)]}case"SLICE":return[_({prim:"option",args:[s(0,["nat"],["nat"],["string","bytes"])[2]]},"@slice"),...t.slice(3)];case"PACK":{const a=s(0,null)[0];return P(a),[_({prim:"bytes"},"@packed"),...t.slice(1)]}case"ADD":{const a=s(0,["nat","int","timestamp","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"],["nat","int","timestamp","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"]);if(a[0].prim==="nat"&&a[1].prim==="int"||a[0].prim==="int"&&a[1].prim==="nat")return[_({prim:"int"}),...t.slice(2)];if(a[0].prim==="int"&&a[1].prim==="timestamp"||a[0].prim==="timestamp"&&a[1].prim==="int")return[_({prim:"timestamp"}),...t.slice(2)];if((a[0].prim==="int"||a[0].prim==="nat"||a[0].prim==="mutez"||a[0].prim==="bls12_381_g1"||a[0].prim==="bls12_381_g2"||a[0].prim==="bls12_381_fr")&&a[0].prim===a[1].prim)return[_(a[0]),...t.slice(2)];throw new H(u,t,`${u.prim}: can't add ${a[0].prim} to ${a[1].prim}`)}case"SUB":{const a=zr(n,tr.PsiThaCa)?s(0,["nat","int","timestamp","mutez"],["nat","int","timestamp","mutez"]):s(0,["nat","int","timestamp"],["nat","int","timestamp"]);if((a[0].prim==="nat"||a[0].prim==="int")&&(a[1].prim==="nat"||a[1].prim==="int")||a[0].prim==="timestamp"&&a[1].prim==="timestamp")return[_({prim:"int"}),...t.slice(2)];if(a[0].prim==="timestamp"&&a[1].prim==="int")return[_({prim:"timestamp"}),...t.slice(2)];if(a[0].prim==="mutez"&&a[1].prim==="mutez")return[_({prim:"mutez"}),...t.slice(2)];throw new H(u,t,`${u.prim}: can't subtract ${a[0].prim} from ${a[1].prim}`)}case"SUB_MUTEZ":return s(0,["mutez"],["mutez"]),[_({prim:"option",args:[{prim:"mutez"}]}),...t.slice(2)];case"MUL":{const a=s(0,["nat","int","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"],["nat","int","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"]);if(a[0].prim==="nat"&&a[1].prim==="int"||a[0].prim==="int"&&a[1].prim==="nat")return[_({prim:"int"}),...t.slice(2)];if(a[0].prim==="nat"&&a[1].prim==="mutez"||a[0].prim==="mutez"&&a[1].prim==="nat")return[_({prim:"mutez"}),...t.slice(2)];if((a[0].prim==="bls12_381_g1"||a[0].prim==="bls12_381_g2"||a[0].prim==="bls12_381_fr")&&a[1].prim==="bls12_381_fr"||(a[0].prim==="nat"||a[0].prim==="int")&&a[0].prim===a[1].prim)return[_(a[0]),...t.slice(2)];if((a[0].prim==="nat"||a[0].prim==="int")&&a[1].prim==="bls12_381_fr"||(a[1].prim==="nat"||a[1].prim==="int")&&a[0].prim==="bls12_381_fr")return[_({prim:"bls12_381_fr"}),...t.slice(2)];throw new H(u,t,`${u.prim}: can't multiply ${a[0].prim} by ${a[1].prim}`)}case"EDIV":{const a=(g,R)=>({prim:"option",args:[{prim:"pair",args:[{prim:g},{prim:R}]}]}),f=s(0,["nat","int","mutez"],["nat","int","mutez"]);if(f[0].prim==="nat"&&f[1].prim==="nat")return[_(a("nat","nat")),...t.slice(2)];if((f[0].prim==="nat"||f[0].prim==="int")&&(f[1].prim==="nat"||f[1].prim==="int"))return[_(a("int","nat")),...t.slice(2)];if(f[0].prim==="mutez"&&f[1].prim==="nat")return[_(a("mutez","mutez")),...t.slice(2)];if(f[0].prim==="mutez"&&f[1].prim==="mutez")return[_(a("nat","mutez")),...t.slice(2)];throw new H(u,t,`${u.prim}: can't euclideally divide ${f[0].prim} by ${f[1].prim}`)}case"ABS":return s(0,["int"]),[_({prim:"nat"}),...t.slice(1)];case"ISNAT":return s(0,["int"]),[_({prim:"option",args:[{prim:"nat"}]}),...t.slice(1)];case"INT":return s(0,["nat","bls12_381_fr"]),[_({prim:"int"}),...t.slice(1)];case"NEG":{const a=s(0,["nat","int","bls12_381_g1","bls12_381_g2","bls12_381_fr"])[0];return a.prim==="nat"||a.prim==="int"?[_({prim:"int"}),...t.slice(1)]:[_(a),...t.slice(1)]}case"LSL":case"LSR":return s(0,["nat"],["nat"]),[_({prim:"nat"}),...t.slice(2)];case"OR":case"XOR":{const a=s(0,["nat","bool"],["nat","bool"]);if(a[0].prim!==a[1].prim)throw new H(u,t,`${u.prim}: both arguments must be of the same type: ${a[0].prim}, ${a[1].prim}`);return[_(a[1]),...t.slice(2)]}case"AND":{const a=s(0,["nat","bool","int"],["nat","bool"]);if((a[0].prim!=="int"||a[1].prim!=="nat")&&a[0].prim!==a[1].prim)throw new H(u,t,`${u.prim}: both arguments must be of the same type: ${a[0].prim}, ${a[1].prim}`);return[_(a[1]),...t.slice(2)]}case"NOT":return s(0,["nat","bool","int"])[0].prim==="bool"?[_({prim:"bool"}),...t.slice(1)]:[_({prim:"int"}),...t.slice(1)];case"COMPARE":{const a=s(0,null,null);return v(a[0]),v(a[1]),[_({prim:"int"}),...t.slice(2)]}case"EQ":case"NEQ":case"LT":case"GT":case"LE":case"GE":return s(0,["int"]),[_({prim:"bool"}),...t.slice(1)];case"SELF":{if((e==null?void 0:e.contract)===void 0)throw new H(u,t,`${u.prim}: contract required`);const a=C({f:1,v:1}),f=ns(e.contract,(d=a.f)===null||d===void 0?void 0:d[0]);if(f===null)throw new H(u,t,`${u.prim}: contract has no entrypoint ${f}`);return[L({prim:"contract",args:[f]},{v:a.v?a.v:["@self"]}),...t]}case"TRANSFER_TOKENS":{const a=s(0,null,["mutez"],["contract"]);return y(a[0],a[2].args[0]),[_({prim:"operation"}),...t.slice(3)]}case"SET_DELEGATE":{const a=s(0,["option"])[0];if(tt(a.args[0])!=="key_hash")throw new H(u,t,`${u.prim}: key hash expected: ${tt(a.args[0])}`);return[_({prim:"operation"}),...t.slice(1)]}case"IMPLICIT_ACCOUNT":return s(0,["key_hash"]),[_({prim:"contract",args:[{prim:"unit"}]}),...t.slice(1)];case"NOW":return[_({prim:"timestamp"},"@now"),...t];case"AMOUNT":return[_({prim:"mutez"},"@amount"),...t];case"BALANCE":return[_({prim:"mutez"},"@balance"),...t];case"CHECK_SIGNATURE":return s(0,["key"],["signature"],["bytes"]),[_({prim:"bool"}),...t.slice(3)];case"BLAKE2B":case"SHA256":case"SHA512":case"KECCAK":case"SHA3":return s(0,["bytes"]),[_({prim:"bytes"}),...t.slice(1)];case"HASH_KEY":return s(0,["key"]),[_({prim:"key_hash"}),...t.slice(1)];case"SOURCE":return[_({prim:"address"},"@source"),...t];case"SENDER":return[_({prim:"address"},"@sender"),...t];case"ADDRESS":{const a=s(0,["contract"])[0],f=C({v:1});return[L({prim:"address",[On]:a},{v:f.v?f.v:ht(l(a),"address")}),...t.slice(1)]}case"SELF_ADDRESS":{const a={prim:"address"};return(e==null?void 0:e.contract)!==void 0&&(a[On]={prim:"contract",args:[we(e.contract,"parameter").args[0]]}),[_(a,"@address"),...t]}case"CHAIN_ID":return[_({prim:"chain_id"}),...t];case"DROP":{C({});const a=u.args!==void 0?parseInt(u.args[0].int,10):1;return s(a-1,null),t.slice(a)}case"DIG":{C({});const a=parseInt(u.args[0].int,10);return[s(a,null)[0],...t.slice(0,a),...t.slice(a+1)]}case"DUG":{C({});const a=parseInt(u.args[0].int,10);return[...t.slice(1,a+1),s(0,null)[0],...t.slice(a+1)]}case"NONE":return lt(u.args[0]),[L({prim:"option",args:[u.args[0]]},C({t:1,v:1})),...t];case"LEFT":case"RIGHT":{const a=s(0,null)[0],f=C({f:2,t:1,v:1},{specialFields:!0}),g=l(a),R=[L(a,{t:null,v:null,f:f.f&&f.f.length>0&&f.f[0]!=="%"?f.f[0]==="%@"?g.v?["%"+g.v[0].slice(1)]:void 0:f.f:void 0}),L(u.args[0],{t:null,f:f.f&&f.f.length>1&&f.f[1]!=="%"?f.f:void 0})];return[L({prim:"or",args:u.prim==="LEFT"?R:[R[1],R[0]]},{t:f.t,v:f.v}),...t.slice(1)]}case"NIL":return lt(u.args[0]),[L({prim:"list",args:[u.args[0]]},C({t:1,v:1})),...t];case"UNPACK":return s(0,["bytes"]),lt(u.args[0]),[_({prim:"option",args:[u.args[0]]},"@unpacked"),...t.slice(1)];case"CONTRACT":{const a=s(0,["address"])[0];lt(u.args[0]);const f=C({v:1,f:1}),g=a[On];if(g!==void 0){const R=ns(g,(w=f.f)===null||w===void 0?void 0:w[0]);if(R===null)throw new H(u,t,`${u.prim}: contract has no entrypoint ${R}`);y(R,u.args[0])}return[L({prim:"option",args:[{prim:"contract",args:[u.args[0]]}]},{v:f.v?f.v:ht(l(a),"contract")}),...t.slice(1)]}case"CAST":{C({});const a=s(0,null)[0];return lt(u.args[0]),y(u.args[0],a),[u.args[0],...t.slice(1)]}case"IF_NONE":{C({});const a=s(0,["option"])[0],f=t.slice(1),g=At(u.args[0],f,e),R=At(u.args[1],[L(a.args[0],{t:null,v:ht(l(a),"some")}),...f],e);return h(g,R)}case"IF_LEFT":{C({});const a=s(0,["or"])[0],f=l(a),g=l(a.args[0]),R=l(a.args[1]),N=t.slice(1),x=At(u.args[0],[L(a.args[0],{t:null,v:ht(f,g.f?g.f[0].slice(1):"left")}),...N],e),$=At(u.args[1],[L(a.args[1],{t:null,v:ht(f,R.f?R.f[0].slice(1):"right")}),...N],e);return h(x,$)}case"IF_CONS":{C({});const a=s(0,["list"])[0],f=l(a),g=t.slice(1),R=At(u.args[0],[L(a.args[0],{t:null,v:ht(f,"hd")}),L(a,{t:null,v:ht(f,"tl")}),...g],e),N=At(u.args[1],g,e);return h(R,N)}case"IF":{C({}),s(0,["bool"]);const a=t.slice(1),f=At(u.args[0],a,e),g=At(u.args[1],a,e);return h(f,g)}case"MAP":{const a=s(0,["list","map","option"])[0],f=t.slice(1),g=a.prim==="map"?{prim:"pair",args:a.args}:a.args[0],R=At(u.args[0],[L(g,{t:null,v:ht(l(a),"elt")}),...f],e);if("failed"in R){if(!("prim"in R.failed)||R.failed.prim!=="never")throw new H(u,t,`${u.prim}: FAIL is not allowed in MAP`);return{failed:R.failed,level:R.level+1}}if(R.length<1)throw new H(u,t,`${u.prim}: function must return a value`);return m(R.slice(1),f),a.prim==="list"?[_({prim:"list",args:[R[0]]}),...f]:a.prim==="map"?[_({prim:"map",args:[a.args[0],R[0]]}),...f]:[_({prim:"option",args:[R[0]]}),...f]}case"ITER":{C({});const a=s(0,["set","list","map"])[0],f=t.slice(1),g=a.prim==="map"?{prim:"pair",args:a.args}:a.args[0],R=At(u.args[0],[L(g,{t:null,v:ht(l(a),"elt")}),...f],e);return"failed"in R?{failed:R.failed,level:R.level+1}:(m(R,f),f)}case"LOOP":{C({}),s(0,["bool"]);const a=t.slice(1),f=At(u.args[0],a,e);return"failed"in f?{failed:f.failed,level:f.level+1}:(m(f,[{prim:"bool"},...a]),a)}case"LOOP_LEFT":{C({});const a=s(0,["or"])[0],f=t.slice(1),g=At(u.args[0],[L(a.args[0],{t:null,v:ht(l(a),"left")}),...f],e);return"failed"in g?{failed:g.failed,level:g.level+1}:(m(g,[a,...f]),[L(a.args[1],{t:null,v:C({v:1}).v}),...f])}case"DIP":{C({});const a=u.args.length===2?parseInt(u.args[0].int,10):1;s(a-1,null);const f=t.slice(0,a),g=t.slice(a),R=u.args.length===2?At(u.args[1],g,e):At(u.args[0],g,e);return"failed"in R?{failed:R.failed,level:R.level+1}:[...f,...R]}case"CREATE_CONTRACT":{const a=C({v:2}),f=s(0,["option"],["mutez"],null);if(tt(f[0].args[0])!=="key_hash")throw new H(u,t,`${u.prim}: key hash expected: ${tt(f[0].args[0])}`);T(f[2])&&(mc(u.args[0]),re(we(u.args[0],"storage").args[0],f[2]));const g=(O=a.v)===null||O===void 0?void 0:O.map(R=>R!=="@"?[R]:void 0);return[L({prim:"operation"},{v:g==null?void 0:g[0]}),L({prim:"address",[On]:{prim:"contract",args:[we(u.args[0],"parameter").args[0]]}},{v:g==null?void 0:g[1]}),...t.slice(3)]}case"PUSH":return lt(u.args[0]),te(u.args[1],u.args[0],Object.assign(Object.assign({},e),{contract:void 0})),[_(u.args[0]),...t];case"EMPTY_SET":return lt(u.args[0]),v(u.args[0]),[L({prim:"set",args:u.args},C({t:1,v:1})),...t];case"EMPTY_MAP":return lt(u.args[0]),v(u.args[0]),lt(u.args[1]),[L({prim:"map",args:u.args},C({t:1,v:1})),...t];case"EMPTY_BIG_MAP":return lt(u.args[0]),v(u.args[0]),lt(u.args[1]),W(u.args[0]),[L({prim:"big_map",args:u.args},C({t:1,v:1})),...t];case"LAMBDA":{lt(u.args[0]),lt(u.args[1]);const a=At(u.args[2],[u.args[0]],Object.assign(Object.assign({},e),{contract:void 0}));if("failed"in a)return{failed:a.failed,level:a.level+1};if(a.length!==1)throw new H(u,t,`${u.prim}: function must return a value`);return y(u.args[1],a[0]),[_({prim:"lambda",args:[u.args[0],u.args[1]]}),...t]}case"LEVEL":return[_({prim:"nat"},"@level"),...t];case"TOTAL_VOTING_POWER":return[_({prim:"nat"}),...t];case"VOTING_POWER":return s(0,["key_hash"]),[_({prim:"nat"}),...t.slice(1)];case"TICKET":{const a=s(0,null,["nat"])[0];return v(a),[L({prim:"ticket",args:[a]},C({t:1,v:1})),...t.slice(2)]}case"JOIN_TICKETS":{const a=jt("pair",s(0,["pair"])[0]);if(tt(a.args[0])!=="ticket")throw new H(u,t,`${u.prim}: ticket expected: ${tt(a.args[0])}`);return y(a.args[0],a.args[1]),[_({prim:"option",args:[L(a.args[0],{t:null})]}),...t.slice(1)]}case"SPLIT_TICKET":{const a=s(0,["ticket"],["pair"]),f=jt("pair",a[1]);if(tt(f.args[0])!=="nat")throw new H(u,t,`${u.prim}: nat expected: ${tt(f.args[0])}`);return y(f.args[0],f.args[1]),[_({prim:"option",args:[{prim:"pair",args:[L(a[0],{t:null}),L(a[0],{t:null})]}]}),...t.slice(2)]}case"READ_TICKET":{const a=C({v:2}),f=s(0,["ticket"])[0],g=(E=a.v)===null||E===void 0?void 0:E.map(R=>R!=="@"?[R]:void 0);return[L({prim:"pair",args:[{prim:"address"},L(f.args[0],{t:null}),{prim:"nat"}]},{v:g==null?void 0:g[0]}),L(f,{v:g==null?void 0:g[1],t:null}),...t.slice(1)]}case"PAIRING_CHECK":{const a=s(0,["list"])[0].args[0];if(!Ve(a))throw new H(u,t,`${u.prim}: pair expected: ${tt(a)}`);const f=jt("pair",a);if(tt(f.args[0])!=="bls12_381_g1")throw new H(u,t,`${u.prim}: bls12_381_g1 expected: ${tt(f.args[0])}`);if(tt(f.args[1])!=="bls12_381_g2")throw new H(u,t,`${u.prim}: bls12_381_g2 expected: ${tt(f.args[1])}`);return[_({prim:"bool"}),...t.slice(1)]}case"SAPLING_EMPTY_STATE":return[L({prim:"sapling_state",args:[u.args[0]]},C({v:1,t:1})),...t];case"SAPLING_VERIFY_UPDATE":{const a=s(0,["sapling_transaction"],["sapling_state"]);if(parseInt(a[0].args[0].int,10)!==parseInt(a[1].args[0].int,10))throw new H(u,t,`${u.prim}: sapling memo size mismatch: ${a[0].args[0].int} != ${a[1].args[0].int}`);return zr(n,tr.PtJakarta)?[_({prim:"option",args:[{prim:"pair",args:[{prim:"int"},L(a[1],{t:null})]}]}),...t.slice(2)]:[_({prim:"option",args:[{prim:"pair",args:[{prim:"bytes"},{prim:"pair",args:[{prim:"int"},L(a[1],{t:null})]}]}]}),...t.slice(2)]}case"OPEN_CHEST":return s(0,["chest_key"],["chest"],["nat"]),[_({prim:"or",args:[{prim:"bytes"},{prim:"bool"}]}),...t.slice(3)];case"VIEW":{const a=s(0,null,["address"]);return D(a[0]),[_({prim:"option",args:[u.args[1]]}),...t.slice(2)]}case"MIN_BLOCK_TIME":return[_({prim:"nat"}),...t];default:throw new Ft(u,`unexpected instruction: ${u.prim}`)}})(i);if((e==null?void 0:e.traceCallback)!==void 0){const u={op:i,in:t,out:p};e.traceCallback(u)}return p}function we(r,t){for(const e of r)if(e.prim===t)return e;throw new Ft(r,`missing contract section: ${t}`)}function vp(r){const t={};for(const e of r)e.prim==="view"&&(t[e.args[0].string]=e);return t}function gc(r){if(Array.isArray(r)){for(const t of r)if("prim"in t&&(t.prim==="parameter"||t.prim==="storage"||t.prim==="code"))return!0}return!1}function ns(r,t){t=t||"%default";const e=Fn(r).find(n=>n[0]===t);return e!==void 0?e[1]:t==="%default"?gc(r)?we(r,"parameter").args[0]:r:null}function wp(r){return Array.isArray(r)||r.prim==="or"}function Fn(r){if(gc(r)){const t=we(r,"parameter"),e=Fn(t.args[0]),n=$r(t);return n.f?[[n.f[0],t.args[0]],...e]:e}if(wp(r)){const t=Un(r),e=n=>{const i=$r(t[n]);if(tt(t[n])==="or"){const s=Fn(t[n]);return i.f?[[i.f[0],t[n]],...s]:s}return i.f?[[i.f[0],t[n]]]:[]};return[...e(0),...e(1)]}return[]}function mc(r,t){const e=(l,m,y,v)=>{lt(l,!0),lt(m);const P={prim:"pair",args:[Object.assign(Object.assign({},l),{annots:["@parameter"]}),Object.assign(Object.assign({},m),{annots:["@storage"]})]},T=At(v,[P],Object.assign(Object.assign({},t),{contract:r}));if("failed"in T)return T;try{pc(T,[y])}catch(D){throw D instanceof Ft?new H(v,T,D.message):D}return T},n=we(r,"parameter").args[0],i=we(r,"storage").args[0],s=we(r,"code").args[0],c=e(n,i,{prim:"pair",args:[{prim:"list",args:[{prim:"operation"}]},i]},s);for(const l of Object.values(vp(r)))e(l.args[1],i,l.args[2],l.args[3]);return c}function yc(r,t,e){lt(t),te(r,t,e||null)}function Ap(r,t,e){for(const n of t)lt(n);if((e==null?void 0:e.contract)!==void 0)for(const n of["parameter","storage"]){const i=we(e.contract,n).args[0];lt(i)}return At(r,t,e||null)}function _p(r,t,e){try{return yc(r,t,e),!0}catch{return!1}}class Ts{constructor(t,e){this.contract=t,this.ctx=Object.assign({contract:t},e),this.output=mc(t,this.ctx)}static parse(t,e){const n=new yr(e),i=typeof t=="string"?n.parseScript(t):n.parseJSON(t);if(i===null)throw new Kf("empty contract");if(uc(i))return new Ts(i,e)}static parseTypeExpression(t,e){const n=new yr(e),i=typeof t=="string"?n.parseScript(t):n.parseJSON(t);if(i===null)throw new qf("empty type expression");if(He(i)&&lt(i))return i;throw void 0}static parseDataExpression(t,e){const n=new yr(e),i=typeof t=="string"?n.parseScript(t):n.parseJSON(t);if(i===null)throw new zf("empty data expression");if(dr(i))return i;throw void 0}section(t){return we(this.contract,t)}entryPoints(){return Fn(this.contract)}entryPoint(t){return ns(this.contract,t)}assertDataValid(t,e){yc(t,e,this.ctx)}isDataValid(t,e){return _p(t,e,this.ctx)}assertParameterValid(t,e){const n=this.entryPoint(t||void 0);if(n===null)throw new Wf(t==null?void 0:t.toString());this.assertDataValid(e,n)}isParameterValid(t,e){try{return this.assertParameterValid(t,e),!0}catch{return!1}}functionType(t,e){return Ap(t,e,this.ctx)}}new Ts([{prim:"parameter",args:[{prim:"unit"}]},{prim:"storage",args:[{prim:"unit"}]},{prim:"code",args:[[{prim:"CAR"},{prim:"NIL",args:[{prim:"operation"}]},{prim:"PAIR"}]]}]);const Fo=r=>r.reduce((t,e)=>t+e.toString(16).padStart(2,"0"),""),J=(r,t=8)=>r.toString(16).padStart(t,"0"),ui=31;var A;(function(r){r.SECRET="secret",r.RAW="raw",r.TZ1="tz1",r.BRANCH="branch",r.ZARITH="zarith",r.PUBLIC_KEY="public_key",r.PKH="pkh",r.DELEGATE="delegate",r.SCRIPT="script",r.BALLOT_STATEMENT="ballotStmt",r.PROPOSAL="proposal",r.PROPOSAL_ARR="proposalArr",r.INT32="int32",r.INT16="int16",r.PARAMETERS="parameters",r.ADDRESS="address",r.VALUE="value",r.MANAGER="manager",r.BLOCK_PAYLOAD_HASH="blockPayloadHash",r.ENTRYPOINT="entrypoint",r.OPERATION="operation",r.OP_ACTIVATE_ACCOUNT="activate_account",r.OP_DELEGATION="delegation",r.OP_TRANSACTION="transaction",r.OP_ORIGINATION="origination",r.OP_BALLOT="ballot",r.OP_ENDORSEMENT="endorsement",r.OP_SEED_NONCE_REVELATION="seed_nonce_revelation",r.OP_REVEAL="reveal",r.OP_PROPOSALS="proposals",r.OP_REGISTER_GLOBAL_CONSTANT="register_global_constant",r.OP_TRANSFER_TICKET="transfer_ticket",r.OP_TX_ROLLUP_ORIGINATION="tx_rollup_origination",r.OP_TX_ROLLUP_SUBMIT_BATCH="tx_rollup_submit_batch",r.BURN_LIMIT="burn_limit",r.TX_ROLLUP_ORIGINATION_PARAM="tx_rollup_origination_param",r.TX_ROLLUP_ID="tx_rollup_id",r.TX_ROLLUP_BATCH_CONTENT="tx_rollup_batch_content"})(A||(A={}));const $e={"00":"parameter","01":"storage","02":"code","03":"False","04":"Elt","05":"Left","06":"None","07":"Pair","08":"Right","09":"Some","0a":"True","0b":"Unit","0c":"PACK","0d":"UNPACK","0e":"BLAKE2B","0f":"SHA256",10:"SHA512",11:"ABS",12:"ADD",13:"AMOUNT",14:"AND",15:"BALANCE",16:"CAR",17:"CDR",18:"CHECK_SIGNATURE",19:"COMPARE","1a":"CONCAT","1b":"CONS","1c":"CREATE_ACCOUNT","1d":"CREATE_CONTRACT","1e":"IMPLICIT_ACCOUNT","1f":"DIP",20:"DROP",21:"DUP",22:"EDIV",23:"EMPTY_MAP",24:"EMPTY_SET",25:"EQ",26:"EXEC",27:"FAILWITH",28:"GE",29:"GET","2a":"GT","2b":"HASH_KEY","2c":"IF","2d":"IF_CONS","2e":"IF_LEFT","2f":"IF_NONE",30:"INT",31:"LAMBDA",32:"LE",33:"LEFT",34:"LOOP",35:"LSL",36:"LSR",37:"LT",38:"MAP",39:"MEM","3a":"MUL","3b":"NEG","3c":"NEQ","3d":"NIL","3e":"NONE","3f":"NOT",40:"NOW",41:"OR",42:"PAIR",43:"PUSH",44:"RIGHT",45:"SIZE",46:"SOME",47:"SOURCE",48:"SENDER",49:"SELF","4a":"STEPS_TO_QUOTA","4b":"SUB","4c":"SWAP","4d":"TRANSFER_TOKENS","4e":"SET_DELEGATE","4f":"UNIT",50:"UPDATE",51:"XOR",52:"ITER",53:"LOOP_LEFT",54:"ADDRESS",55:"CONTRACT",56:"ISNAT",57:"CAST",58:"RENAME",59:"bool","5a":"contract","5b":"int","5c":"key","5d":"key_hash","5e":"lambda","5f":"list",60:"map",61:"big_map",62:"nat",63:"option",64:"or",65:"pair",66:"set",67:"signature",68:"string",69:"bytes","6a":"mutez","6b":"timestamp","6c":"unit","6d":"operation","6e":"address","6f":"SLICE",70:"DIG",71:"DUG",72:"EMPTY_BIG_MAP",73:"APPLY",74:"chain_id",75:"CHAIN_ID",76:"LEVEL",77:"SELF_ADDRESS",78:"never",79:"NEVER","7a":"UNPAIR","7b":"VOTING_POWER","7c":"TOTAL_VOTING_POWER","7d":"KECCAK","7e":"SHA3","7f":"PAIRING_CHECK",80:"bls12_381_g1",81:"bls12_381_g2",82:"bls12_381_fr",83:"sapling_state",84:"sapling_transaction",85:"SAPLING_EMPTY_STATE",86:"SAPLING_VERIFY_UPDATE",87:"ticket",88:"TICKET",89:"READ_TICKET","8a":"SPLIT_TICKET","8b":"JOIN_TICKETS","8c":"GET_AND_UPDATE","8d":"chest","8e":"chest_key","8f":"OPEN_CHEST",90:"VIEW",91:"view",92:"constant",93:"SUB_MUTEZ"},Op=(()=>{const r={};return Object.keys($e).forEach(t=>{r[$e[t]]=t}),r})(),is={4:"activate_account",107:"reveal",110:"delegation",108:"transaction",109:"origination",6:"ballot",21:"endorsement",1:"seed_nonce_revelation",5:"proposals",111:"register_global_constant",150:"tx_rollup_origination",151:"tx_rollup_submit_batch",158:"transfer_ticket"},Go=(()=>{const r={};return Object.keys(is).forEach(t=>{const e=typeof t=="string"?parseInt(t,10):t;r[is[e]]=J(e,2)}),r})(),Gn={"00":"default","01":"root","02":"do","03":"set_delegate","04":"remove_delegate"},Kn=(()=>{const r={};return Object.keys(Gn).forEach(t=>{r[Gn[t]]=t}),r})();class Rp extends Error{constructor(t){super(t),this.message=t,this.name="InvalidBlockHashError"}}class Ko extends Error{constructor(t){super(t),this.message=t,this.name="InvalidOperationSchemaError"}}class Is extends Error{constructor(t){super(`Oversized entrypoint: ${t}. The maximum length of entrypoint is ${ui}`),this.entrypoint=t,this.name="OversizedEntryPointError"}}class Sp extends Error{constructor(t){super(`The ballot value '${t}' is invalid`),this.ballotValue=t,this.name="InvalidBallotValueError"}}class Pp extends Error{constructor(t){super(`Failed to decode ballot value ${t}`),this.ballotValue=t,this.name="DecodeBallotValueError"}}class bc extends Error{constructor(t){super(`The hex string '${t}' is invalid`),this.hexString=t,this.name="InvalidHexStringError"}}class Ec extends Error{constructor(t){super(`Failed to encode michelson value '${t}'`),this.value=t,this.name="UnexpectedMichelsonValueError"}}class vc extends Error{constructor(t){super(t),this.message=t,this.name="OperationDecodingError"}}class Tp extends Error{constructor(t){super(t),this.message=t,this.name="OperationEncodingError"}}class Ip extends Error{constructor(t){super(`The operation '${t}' is unsupported`),this.op=t,this.name="UnsupportedOperationError"}}class xt{constructor(t,e=0){this.arr=t,this.offset=e}static fromHexString(t){const e=t.toLowerCase();if(/^(([a-f]|\d){2})*$/.test(e)){const n=new Uint8Array((e.match(/([a-z]|\d){2}/g)||[]).map(i=>parseInt(i,16)));return new xt(n)}else throw new bc(e)}consume(t){const e=this.arr.subarray(this.offset,this.offset+t);return this.offset+=t,e}get(t){return this.arr[this.offset+t]}length(){return this.arr.length-this.offset}}const wc=r=>"prim"in r,Ac=r=>"bytes"in r&&typeof r.bytes=="string",_c=r=>"string"in r&&typeof r.string=="string",Oc=r=>"int"in r&&typeof r.int=="string",Np=r=>{const t=wr(r.code),e=wr(r.storage);return`${J(t.length/2,8)}${t}${J(e.length/2,8)}${e}`},xp=r=>{const t=Pt(r),e=Pt(r);return{code:ir(new xt(t)),storage:ir(new xt(e))}},wr=r=>{if(Array.isArray(r)){const t=r.map(n=>wr(n)).join(""),e=t.length/2;return`02${J(e)}${t}`}else{if(wc(r))return Lp(r);if(Ac(r))return Rc(r);if(_c(r))return Pc(r);if(Oc(r))return Ic(r)}throw new Ec(r)},ir=r=>{const t=r.consume(1);switch(t[0]){case 10:return Sc(r);case 1:return Tc(r);case 0:return Nc(r);case 2:{const e=new xt(Pt(r)),n=[];for(;e.length()>0;)n.push(ir(e));return n}default:return Cp(r,t)}},Pt=(r,t=4)=>{const e=r.consume(t),n=parseInt(Buffer.from(e).toString("hex"),16);return r.consume(n)},Rc=r=>{if(!/^([A-Fa-f0-9]{2})*$/.test(r.bytes))throw new bc(r.bytes);const t=r.bytes.length/2;return`0a${J(t)}${r.bytes}`},Sc=r=>{const t=Pt(r);return{bytes:Buffer.from(t).toString("hex")}},Pc=r=>{const t=Buffer.from(r.string,"utf8").toString("hex"),e=t.length/2;return`01${J(e)}${t}`},Tc=r=>{const t=Pt(r);return{string:Buffer.from(t).toString("utf8")}},Ic=({int:r})=>{const t=new G(r,10),e=t.toString(2)[0]==="-"?"1":"0",n=t.toString(2).replace(/-/g,""),i=n.length<=6?6:(n.length-6)%7?n.length+7-(n.length-6)%7:n.length,o=n.padStart(i,"0").match(/\d{6,7}/g).reverse();return o[0]=e+o[0],`00${o.map((l,m)=>parseInt((m===o.length-1?"0":"1")+l,2).toString(16).padStart(2,"0")).join("")}`},Nc=r=>{let t=r.consume(1)[0];const e=[],n=1<<7;for(;t&n;)e.push(t),t=r.consume(1)[0];e.push(t);const i=!!(1<<6&e[0]);e[0]=e[0]&127;const s=e.map((c,l)=>c.toString(2).slice(l===0?-6:-7).padStart(l===0?6:7,"0")).reverse();let o=new G(s.join(""),2);return i&&(o=o.times(-1)),{int:o.toFixed()}},Lp=r=>{const t=+Array.isArray(r.annots),e=Array.isArray(r.args)?r.args.length:0,n=J(Math.min(2*e+t+3,9),2),i=Op[r.prim];let s=(r.args||[]).map(c=>wr(c)).join("");const o=Array.isArray(r.annots)?xc(r.annots):"";return r.prim==="LAMBDA"&&e&&(s=J(s.length/2)+s+J(0)),(r.prim==="pair"||r.prim==="Pair")&&e>2&&(s=o===""?J(s.length/2)+s+J(0):J(s.length/2)+s),r.prim==="view"&&r.args&&(s=J(s.length/2)+s+J(0)),`${n}${i}${s}${o}`},Cp=(r,t)=>{const e=(t[0]-3)%2===1;let n=Math.floor((t[0]-3)/2);const i=r.consume(1)[0].toString(16).padStart(2,"0"),s={prim:$e[i]};if($e[i]==="LAMBDA"&&r.consume(4),$e[i]==="view")return n!=0?Mp(r,s):s;let o,c;($e[i]==="pair"||$e[i]==="Pair")&&n>2&&(o=Bp(r),n=0,c=qn(r));const l=new Array(n).fill(0).map(()=>ir(r));return $e[i]==="LAMBDA"&&r.consume(4),o?s.args=o:l.length&&(s.args=l),c&&c[0]!==""?s.annots=c:e&&(s.annots=qn(r)),s},Mp=(r,t)=>(r.consume(4),t.args=new Array(4).fill(0).map(()=>ir(r)),r.consume(4),t),Bp=r=>{const t=new xt(Pt(r)),e=[];for(;t.length()>0;)e.push(ir(t));return e},xc=r=>{const t=r.map(n=>Buffer.from(n,"utf8").toString("hex")).join("20"),e=t.length/2;return`${J(e)}${t}`},qn=r=>{const t=r.consume(4),e=parseInt(Buffer.from(t).toString("hex"),16),n=r.consume(e);return Buffer.from(n).toString("hex").split("20").map(s=>Buffer.from(s,"hex").toString("utf8"))},Xt=r=>t=>cu(Buffer.from(ia(t,us[r]))),Zt=r=>t=>{const e=t.consume(uu[r]);return lu(e,us[r])},Dp=Zt(j.TZ1),$p=Zt(j.B),Ns=r=>{const t=r.consume(1);if(t[0]===0)return Zt(j.TZ1)(r);if(t[0]===1)return Zt(j.TZ2)(r);if(t[0]===2)return Zt(j.TZ3)(r)},kp=Xt(j.B),jp=Xt(j.TZ1),qo=r=>r?"ff":"00",Lc=r=>Xt(j.P)(r),Cc=r=>Zt(j.P)(r),Vp=r=>{const t=[];for(r.consume(4);r.length()>0;)t.push(Cc(r));return t},Hp=r=>J(32*r.length)+r.map(t=>Lc(t)).join(""),Up=r=>{switch(r){case"yay":return"00";case"nay":return"01";case"pass":return"02";default:throw new Sp(r)}},Fp=r=>{const t=r.consume(1);switch(t[0]){case 0:return"yay";case 1:return"nay";case 2:return"pass";default:throw new Pp(t[0].toString())}},Gp=r=>r?qo(!0)+xs(r):qo(!1),Kp=r=>{const t=parseInt(String(r),10),e=[];for(let n=0;n<4;n++){const i=(4-(n+1))*8;e.push((t&255<<i)>>i)}return Buffer.from(e).toString("hex")},qp=r=>{const t=r.consume(4);let e=0;for(let n=0;n<t.length;n++)e=e|t[n]<<(t.length-(n+1))*8;return e},zp=r=>{const t=parseInt(String(r),10),e=[];for(let n=0;n<2;n++){const i=(2-(n+1))*8;e.push((t&255<<i)>>i)}return Buffer.from(e).toString("hex")},Wp=r=>{const t=r.consume(2);let e=0;for(let n=0;n<t.length;n++)e=e|t[n]<<(t.length-(n+1))*8;return e},Yp=r=>r.consume(1)[0]===255,Jp=r=>{if(Yp(r))return Ns(r)},xs=r=>{switch(r.substr(0,3)){case j.TZ1:return"00"+Xt(j.TZ1)(r);case j.TZ2:return"01"+Xt(j.TZ2)(r);case j.TZ3:return"02"+Xt(j.TZ3)(r);default:throw new hs(r)}},Xp=r=>{switch(r.substr(0,4)){case j.EDPK:return"00"+Xt(j.EDPK)(r);case j.SPPK:return"01"+Xt(j.SPPK)(r);case j.P2PK:return"02"+Xt(j.P2PK)(r);default:throw new oa(r)}},Zp=r=>{switch(r.substr(0,3)){case j.TZ1:case j.TZ2:case j.TZ3:return"00"+xs(r);case j.KT1:return"01"+Xt(j.KT1)(r)+"00";default:throw new bt(r)}},Qp=r=>{switch(r.consume(1)[0]){case 0:return Zt(j.EDPK)(r);case 1:return Zt(j.SPPK)(r);case 2:return Zt(j.P2PK)(r);default:throw new oa(r.toString())}},td=r=>{switch(r.consume(1)[0]){case 0:return Ns(r);case 1:{const e=Zt(j.KT1)(r);return r.consume(1),e}default:throw new bt(r.toString())}},Mc=r=>{const t=[];let e=new G(r,10);if(e.isNaN())throw new TypeError(`Invalid zarith number ${r}`);for(;;)if(e.lt(128)){e.lt(16)&&t.push("0"),t.push(e.toString(16));break}else{let n=e.mod(128);e=e.minus(n),e=e.dividedBy(128),n=n.plus(128),t.push(n.toString(16))}return t.join("")},Bc=r=>{let t=0;for(;t<r.length()&&(r.get(t)&128)!==0;)t+=1;let e=new G(0);for(let n=t;n>=0;n-=1){const i=r.get(n)&127;e=e.multipliedBy(128),e=e.plus(i)}return r.consume(t+1),new G(e).toString()},Dc=r=>{const t=J(r.consume(1)[0],2);if(t in Gn)return Gn[t];{const e=Pt(r,1),n=Buffer.from(e).toString("utf8");if(n.length>ui)throw new Is(n);return n}},ed=r=>{if(r.consume(1)[0]!==0){const e=Dc(r),n=Pt(r),i=ir(new xt(n));return{entrypoint:e,value:i}}},rd=r=>{if(r in Kn)return`${Kn[r]}`;if(r.length>ui)throw new Is(r);return`ff${wr({string:r}).slice(8)}`},nd=r=>{if(!r||r.entrypoint==="default"&&"prim"in r.value&&r.value.prim==="Unit")return"00";const t=rd(r.entrypoint),e=wr(r.value),n=(e.length/2).toString(16).padStart(8,"0");return`ff${t}${n}${e}`},id=r=>{const t=wr(r);return`${J(t.length/2)}${t}`},sd=r=>{const t=Pt(r);return ir(new xt(t))},od=Xt(j.VH),ad=Zt(j.VH),li={branch:A.BRANCH,contents:[A.OPERATION]},cn={pkh:A.TZ1,secret:A.SECRET},un={source:A.PKH,fee:A.ZARITH,counter:A.ZARITH,gas_limit:A.ZARITH,storage_limit:A.ZARITH,public_key:A.PUBLIC_KEY},ln={source:A.PKH,fee:A.ZARITH,counter:A.ZARITH,gas_limit:A.ZARITH,storage_limit:A.ZARITH,delegate:A.DELEGATE},hn={source:A.PKH,fee:A.ZARITH,counter:A.ZARITH,gas_limit:A.ZARITH,storage_limit:A.ZARITH,amount:A.ZARITH,destination:A.ADDRESS,parameters:A.PARAMETERS},fn={source:A.PKH,fee:A.ZARITH,counter:A.ZARITH,gas_limit:A.ZARITH,storage_limit:A.ZARITH,balance:A.ZARITH,delegate:A.DELEGATE,script:A.SCRIPT},pn={source:A.PKH,period:A.INT32,proposal:A.PROPOSAL,ballot:A.BALLOT_STATEMENT},dn={slot:A.INT16,level:A.INT32,round:A.INT32,block_payload_hash:A.BLOCK_PAYLOAD_HASH},gn={level:A.INT32,nonce:A.RAW},mn={source:A.PKH,period:A.INT32,proposals:A.PROPOSAL_ARR},yn={source:A.PKH,fee:A.ZARITH,counter:A.ZARITH,gas_limit:A.ZARITH,storage_limit:A.ZARITH,value:A.VALUE},$c=r=>t=>{if(!(t.kind in r)||!(t.kind in Go))throw new nr(t.kind);return Go[t.kind]+r[t.kind](t)},kc=r=>t=>{const e=t.consume(1),n=is[e[0]];if(n===void 0)throw new Ip(e[0].toString());const i=r[n](t);if(typeof i!="object")throw new vc("Decoded invalid operation");return Object.assign({kind:n},i)},at=r=>t=>e=>Object.keys(t).reduce((i,s)=>{const o=t[s];if(e&&Array.isArray(o)){const c=r[o[0]],l=e[s];if(!Array.isArray(l))throw new Tp(`Expected value to be Array ${JSON.stringify(l)}`);return i+l.reduce((m,y)=>m+c(y),"")}else{const c=r[o];return i+c(e[s])}},""),ct=r=>t=>e=>Object.keys(t).reduce((i,s)=>{const o=t[s];if(Array.isArray(o)){const c=r[o[0]],l=[],m=e.length();for(;e.length()>0;)if(l.push(c(e)),m===e.length())throw new vc("Unable to decode value");return Object.assign(Object.assign({},i),{[s]:l})}else{const c=r[o],l=c(e);return typeof l<"u"?Object.assign(Object.assign({},i),{[s]:l}):Object.assign({},i)}},{}),st={[A.SECRET]:r=>Fo(r.consume(20)),[A.RAW]:r=>Fo(r.consume(32)),[A.TZ1]:Dp,[A.BRANCH]:$p,[A.ZARITH]:Bc,[A.PUBLIC_KEY]:Qp,[A.PKH]:Ns,[A.DELEGATE]:Jp,[A.INT32]:qp,[A.SCRIPT]:xp,[A.BALLOT_STATEMENT]:Fp,[A.PROPOSAL]:Cc,[A.PROPOSAL_ARR]:Vp,[A.PARAMETERS]:ed,[A.ADDRESS]:td,[A.VALUE]:sd,[A.INT16]:Wp,[A.BLOCK_PAYLOAD_HASH]:ad};st[A.OPERATION]=kc(st);st[A.OP_ACTIVATE_ACCOUNT]=r=>ct(st)(cn)(r);st[A.OP_DELEGATION]=r=>ct(st)(ln)(r);st[A.OP_TRANSACTION]=r=>ct(st)(hn)(r);st[A.OP_ORIGINATION]=r=>ct(st)(fn)(r);st[A.OP_BALLOT]=r=>ct(st)(pn)(r);st[A.OP_ENDORSEMENT]=r=>ct(st)(dn)(r);st[A.OP_SEED_NONCE_REVELATION]=r=>ct(st)(gn)(r);st[A.OP_PROPOSALS]=r=>ct(st)(mn)(r);st[A.OP_REVEAL]=r=>ct(st)(un)(r);st[A.OP_REGISTER_GLOBAL_CONSTANT]=r=>ct(st)(yn)(r);st[A.MANAGER]=ct(st)(li);const ot={[A.SECRET]:r=>r,[A.RAW]:r=>r,[A.TZ1]:jp,[A.BRANCH]:kp,[A.ZARITH]:Mc,[A.PUBLIC_KEY]:Xp,[A.PKH]:xs,[A.DELEGATE]:Gp,[A.SCRIPT]:Np,[A.BALLOT_STATEMENT]:Up,[A.PROPOSAL]:Lc,[A.PROPOSAL_ARR]:Hp,[A.INT32]:Kp,[A.PARAMETERS]:nd,[A.ADDRESS]:Zp,[A.VALUE]:id,[A.INT16]:zp,[A.BLOCK_PAYLOAD_HASH]:od};ot[A.OPERATION]=$c(ot);ot[A.OP_ACTIVATE_ACCOUNT]=r=>at(ot)(cn)(r);ot[A.OP_DELEGATION]=r=>at(ot)(ln)(r);ot[A.OP_TRANSACTION]=r=>at(ot)(hn)(r);ot[A.OP_ORIGINATION]=r=>at(ot)(fn)(r);ot[A.OP_BALLOT]=r=>at(ot)(pn)(r);ot[A.OP_ENDORSEMENT]=r=>at(ot)(dn)(r);ot[A.OP_SEED_NONCE_REVELATION]=r=>at(ot)(gn)(r);ot[A.OP_PROPOSALS]=r=>at(ot)(mn)(r);ot[A.OP_REVEAL]=r=>at(ot)(un)(r);ot[A.OP_REGISTER_GLOBAL_CONSTANT]=r=>at(ot)(yn)(r);ot[A.MANAGER]=at(ot)(li);const Ls={source:A.PKH,fee:A.ZARITH,counter:A.ZARITH,gas_limit:A.ZARITH,storage_limit:A.ZARITH,ticket_contents:A.VALUE,ticket_ty:A.VALUE,ticket_ticketer:A.ADDRESS,ticket_amount:A.ZARITH,destination:A.ADDRESS,entrypoint:A.ENTRYPOINT},Cs={source:A.PKH,fee:A.ZARITH,counter:A.ZARITH,gas_limit:A.ZARITH,storage_limit:A.ZARITH,tx_rollup_origination:A.TX_ROLLUP_ORIGINATION_PARAM},Ms={source:A.PKH,fee:A.ZARITH,counter:A.ZARITH,gas_limit:A.ZARITH,storage_limit:A.ZARITH,rollup:A.TX_ROLLUP_ID,content:A.TX_ROLLUP_BATCH_CONTENT,burn_limit:A.BURN_LIMIT},jc={activate_account:cn,reveal:un,delegation:ln,transaction:hn,origination:fn,ballot:pn,endorsement:dn,seed_nonce_revelation:gn,proposals:mn,register_global_constant:yn,transfer_ticket:Ls,tx_rollup_origination:Cs,tx_rollup_submit_batch:Ms},cd=(r,t)=>t.filter(e=>!r.includes(e)),ud=(r,t)=>r.filter(e=>e!==t),ld=r=>Object.keys(jc).includes(r),hd=r=>{const t=r.kind,e=Object.keys(r),n=ud(e,"kind"),i=Object.keys(jc[t]);return cd(n,i)};var Qr;(function(r){r.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",r.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",r.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",r.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",r.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",r.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA",r.PsFLorena="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",r.PtGRANADs="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",r.PtHangz2="PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx",r.Psithaca2="Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A",r.PtJakart2="PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY",r.ProtoALpha="ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK"})(Qr||(Qr={}));const zo={Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd:4,PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU:5,PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS:5,PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb:6,PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo:7,PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA:8,PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i:9,PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV:10,PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx:11,Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A:12,PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY:13,ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK:14};function fd(r,t){return zo[r]<zo[t]}const We=Object.assign(Object.assign({},$e),{84:"sapling_transaction_deprecated",94:"tx_rollup_l2_address",95:"MIN_BLOCK_TIME",96:"sapling_transaction"}),pd=(()=>{const r={};return Object.keys(We).forEach(t=>{r[We[t]]=t}),r})(),dd=r=>{const t=sr(r.code),e=sr(r.storage);return`${J(t.length/2,8)}${t}${J(e.length/2,8)}${e}`},gd=r=>{const t=Pt(r),e=Pt(r);return{code:or(new xt(t)),storage:or(new xt(e))}},sr=r=>{if(Array.isArray(r)){const t=r.map(n=>sr(n)).join(""),e=t.length/2;return`02${J(e)}${t}`}else{if(wc(r))return md(r);if(Ac(r))return Rc(r);if(_c(r))return Pc(r);if(Oc(r))return Ic(r)}throw new Ec("Unexpected value")},or=r=>{const t=r.consume(1);switch(t[0]){case 10:return Sc(r);case 1:return Tc(r);case 0:return Nc(r);case 2:{const e=new xt(Pt(r)),n=[];for(;e.length()>0;)n.push(or(e));return n}default:return yd(r,t)}},md=r=>{const t=+Array.isArray(r.annots),e=Array.isArray(r.args)?r.args.length:0,n=J(Math.min(2*e+t+3,9),2),i=pd[r.prim];let s=(r.args||[]).map(c=>sr(c)).join("");const o=Array.isArray(r.annots)?xc(r.annots):"";return r.prim==="LAMBDA"&&e&&(s=J(s.length/2)+s+J(0)),(r.prim==="pair"||r.prim==="Pair")&&e>2&&(s=o===""?J(s.length/2)+s+J(0):J(s.length/2)+s),r.prim==="view"&&r.args&&(s=J(s.length/2)+s+J(0)),`${n}${i}${s}${o}`},yd=(r,t)=>{const e=(t[0]-3)%2===1;let n=Math.floor((t[0]-3)/2);const i=r.consume(1)[0].toString(16).padStart(2,"0"),s={prim:We[i]};if(We[i]==="LAMBDA"&&r.consume(4),We[i]==="view")return n!=0?bd(r,s):s;let o,c;(We[i]==="pair"||We[i]==="Pair")&&n>2&&(o=Ed(r),n=0,c=qn(r));const l=new Array(n).fill(0).map(()=>or(r));return We[i]==="LAMBDA"&&r.consume(4),o?s.args=o:l.length&&(s.args=l),c&&c[0]!==""?s.annots=c:e&&(s.annots=qn(r)),s},bd=(r,t)=>(r.consume(4),t.args=new Array(4).fill(0).map(()=>or(r)),r.consume(4),t),Ed=r=>{const t=new xt(Pt(r)),e=[];for(;t.length()>0;)e.push(or(t));return e},vd=r=>{if(r.consume(1)[0]!==0){const e=Dc(r),n=Pt(r),i=or(new xt(n));return{entrypoint:e,value:i}}},wd=r=>{const t=Pt(r);return or(new xt(t))},Ad=r=>{if(r in Kn)return`${Kn[r]}`;if(r.length>ui)throw new Is(r);return`ff${sr({string:r}).slice(8)}`},_d=r=>`${sr({string:r}).slice(2)}`,Od=r=>{const t=Pt(r);return Buffer.from(t).toString("utf8")},Rd=r=>{if(!r||r.entrypoint==="default"&&"prim"in r.value&&r.value.prim==="Unit")return"00";const t=Ad(r.entrypoint),e=sr(r.value),n=(e.length/2).toString(16).padStart(8,"0");return`ff${t}${n}${e}`},Sd=r=>{const t=sr(r);return`${J(t.length/2)}${t}`},Pd=r=>"",Td=r=>({}),Id=Xt(j.TXR1),Nd=Zt(j.TXR1),xd=r=>`${J(r.length/2)}${r}`,Ld=r=>{const t=Pt(r);return Buffer.from(t).toString("hex")},Cd=r=>r?`ff${Mc(r)}`:"00",Md=r=>{const t=r.consume(1);if(Buffer.from(t).toString("hex")!=="00")return Bc(r)},X=Object.assign(Object.assign({},ot),{[A.SCRIPT]:dd,[A.PARAMETERS]:Rd,[A.VALUE]:Sd,[A.ENTRYPOINT]:_d,[A.TX_ROLLUP_ORIGINATION_PARAM]:Pd,[A.TX_ROLLUP_ID]:Id,[A.TX_ROLLUP_BATCH_CONTENT]:xd,[A.BURN_LIMIT]:Cd});X[A.OPERATION]=$c(X);X[A.OP_ACTIVATE_ACCOUNT]=r=>at(X)(cn)(r);X[A.OP_DELEGATION]=r=>at(X)(ln)(r);X[A.OP_TRANSACTION]=r=>at(X)(hn)(r);X[A.OP_ORIGINATION]=r=>at(X)(fn)(r);X[A.OP_BALLOT]=r=>at(X)(pn)(r);X[A.OP_ENDORSEMENT]=r=>at(X)(dn)(r);X[A.OP_SEED_NONCE_REVELATION]=r=>at(X)(gn)(r);X[A.OP_PROPOSALS]=r=>at(X)(mn)(r);X[A.OP_REVEAL]=r=>at(X)(un)(r);X[A.OP_REGISTER_GLOBAL_CONSTANT]=r=>at(X)(yn)(r);X[A.OP_TRANSFER_TICKET]=r=>at(X)(Ls)(r);X[A.OP_TX_ROLLUP_ORIGINATION]=r=>at(X)(Cs)(r);X[A.OP_TX_ROLLUP_SUBMIT_BATCH]=r=>at(X)(Ms)(r);X[A.MANAGER]=at(X)(li);const Z=Object.assign(Object.assign({},st),{[A.SCRIPT]:gd,[A.PARAMETERS]:vd,[A.VALUE]:wd,[A.ENTRYPOINT]:Od,[A.TX_ROLLUP_ORIGINATION_PARAM]:Td,[A.TX_ROLLUP_ID]:Nd,[A.TX_ROLLUP_BATCH_CONTENT]:Ld,[A.BURN_LIMIT]:Md});Z[A.OPERATION]=kc(Z);Z[A.OP_ACTIVATE_ACCOUNT]=r=>ct(Z)(cn)(r);Z[A.OP_DELEGATION]=r=>ct(Z)(ln)(r);Z[A.OP_TRANSACTION]=r=>ct(Z)(hn)(r);Z[A.OP_ORIGINATION]=r=>ct(Z)(fn)(r);Z[A.OP_BALLOT]=r=>ct(Z)(pn)(r);Z[A.OP_ENDORSEMENT]=r=>ct(Z)(dn)(r);Z[A.OP_SEED_NONCE_REVELATION]=r=>ct(Z)(gn)(r);Z[A.OP_PROPOSALS]=r=>ct(Z)(mn)(r);Z[A.OP_REVEAL]=r=>ct(Z)(un)(r);Z[A.OP_REGISTER_GLOBAL_CONSTANT]=r=>ct(Z)(yn)(r);Z[A.OP_TRANSFER_TICKET]=r=>ct(Z)(Ls)(r);Z[A.OP_TX_ROLLUP_ORIGINATION]=r=>ct(Z)(Cs)(r);Z[A.OP_TX_ROLLUP_SUBMIT_BATCH]=r=>ct(Z)(Ms)(r);Z[A.MANAGER]=ct(Z)(li);const Bd=Qr.Psithaca2;function Dd(r,t){return t===Qr.Psithaca2||fd(t,Qr.Psithaca2)?{encoder:ot[r],decoder:e=>{const n=xt.fromHexString(e);return st[r](n)}}:{encoder:X[r],decoder:e=>{const n=xt.fromHexString(e);return Z[r](n)}}}class Vc{constructor(t=Bd){this.protocolHash=t,this.codec=Dd(A.MANAGER,this.protocolHash)}forge(t){if(hu(t.branch)!==U.VALID)throw new Rp(`The block hash ${t.branch} is invalid`);for(const n of t.contents){if(!ld(n.kind))throw new nr(n.kind);const i=hd(n);if(i.length===1){if(n.kind==="delegation"&&i[0]==="delegate")continue;if(n.kind==="origination"&&i[0]==="delegate")continue;if(n.kind==="transaction"&&i[0]==="parameters")continue;if(n.kind==="tx_rollup_submit_batch"&&i[0]==="burn_limit")continue;throw new Ko(`Missing properties: ${i.join(", ").toString()}`)}else if(i.length>1)throw new Ko(`Missing properties: ${i.join(", ").toString()}`)}const e=this.codec.encoder(t).toLowerCase();return Promise.resolve(e)}parse(t){return Promise.resolve(this.codec.decoder(t))}}const Wg=new Vc;function hr(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e}function S(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function c(y){try{m(n.next(y))}catch(v){o(v)}}function l(y){try{m(n.throw(y))}catch(v){o(v)}}function m(y){y.done?s(y.value):i(y.value).then(c,l)}m((n=n.apply(r,t||[])).next())})}class $d{constructor(t){this.context=t}inject(t){return this.context.rpc.injectOperation(t)}}class Rn extends Error{constructor(){super("No signer has been configured. Please configure one by calling setProvider({signer}) on your TezosToolkit instance."),this.name="UnconfiguredSignerError"}}class ss{publicKey(){return S(this,void 0,void 0,function*(){throw new Rn})}publicKeyHash(){return S(this,void 0,void 0,function*(){throw new Rn})}secretKey(){return S(this,void 0,void 0,function*(){throw new Rn})}sign(t,e){return S(this,void 0,void 0,function*(){throw new Rn})}}function Hc(r){return new yt(t=>(r.on("data",e=>{t.next(e)}),r.on("error",e=>{t.error(e)}),r.on("close",()=>{t.complete()}),()=>{r.close()}))}var ar;(function(r){r[r.DELEGATION=10600]="DELEGATION",r[r.ORIGINATION=10600]="ORIGINATION",r[r.TRANSFER=10600]="TRANSFER",r[r.REVEAL=1100]="REVEAL"})(ar||(ar={}));var cr;(function(r){r[r.DELEGATION=1257]="DELEGATION",r[r.ORIGINATION=1e4]="ORIGINATION",r[r.TRANSFER=1e4]="TRANSFER",r[r.REVEAL=374]="REVEAL"})(cr||(cr={}));var ur;(function(r){r[r.DELEGATION=0]="DELEGATION",r[r.ORIGINATION=257]="ORIGINATION",r[r.TRANSFER=257]="TRANSFER",r[r.REVEAL=0]="REVEAL"})(ur||(ur={}));var It;(function(r){r.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",r.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",r.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",r.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",r.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",r.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA",r.PsFLorena="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",r.PtGRANADs="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",r.PtHangz2="PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx",r.PsiThaCa="PsiThaCaT47Zboaw71QWScM8sXeMM7bbQFncK9FLqYc6EKdpjVP",r.Psithaca2="Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A",r.PtJakart2="PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY",r.ProtoALpha="ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK"})(It||(It={}));It.Pt24m4xi,It.PsBABY5H,It.PsBabyM1,It.PsCARTHA,It.PsDELPH1,It.PtEdo2Zk,It.PsFLorena,It.PtGRANADs,It.PtHangz2,It.PsiThaCa,It.Psithaca2,It.PtJakart2,It.ProtoALpha;var Wo;(function(r){r.MAINNET="NetXdQprcVkpaWU",r.CARTHAGENET="NetXjD3HPJJjmcd",r.DELPHINET="NetXm8tYqnMWky1",r.EDONET="NetXSgo1ZT2DRUG",r.FLORENCENET="NetXxkAx4woPLyu",r.GRANADANET="NetXz969SFaFn8k",r.HANGZHOUNET="NetXZSsxBpMQeAT",r.ITHACANET="NetXbhmtAbMukLc",r.ITHACANET2="NetXnHfVqm9iesp",r.JAKARTANET2="NetXLH1uAxK7CCh"})(Wo||(Wo={}));const kd=6,jd=3;function Yo(r){switch(r){case"tz":return kd;case"mtz":return jd;case"mutez":default:return 0}}function Bs(r="mutez",t="mutez",e){const n=new G(e);return n.isNaN()?e:n.multipliedBy(Math.pow(10,Yo(r))).dividedBy(Math.pow(10,Yo(t)))}class Uc extends Error{constructor(t,e,n){super(`${t} Received ${n.length} arguments while expecting one of the following signatures (${JSON.stringify(e)})`),this.smartContractMethodName=t,this.sigs=e,this.args=n,this.name="Invalid parameters error"}}class Vd extends Error{constructor(t){super(`Since Babylon delegation source can no longer be a contract address ${t}. Please use the smart contract abstraction to set your delegate.`),this.source=t,this.name="Invalid delegation source error"}}class zn extends Error{constructor(t,e){super(t),this.message=t,this.data=e,this.name="InvalidCodeParameter"}}class Fc extends Error{constructor(t,e){super(t),this.message=t,this.data=e,this.name="InvalidInitParameter"}}class Hd extends Error{constructor(t,e,n,i){super(`Unable to encode the parameter of the view: ${t}. Received ${n} as parameter while expecting one of the following signatures (${JSON.stringify(e)})`),this.smartContractViewName=t,this.sigs=e,this.args=n,this.originalError=i,this.name="Invalid view parameters error",this.cause=i}}class Jo extends Error{constructor(t,e,n,i){super(t),this.message=t,this.viewName=e,this.failWith=n,this.originalError=i,this.name="ViewSimulationError"}}const Ud=r=>{if(Fd(r.body)){const t=JSON.parse(r.body);if(Array.isArray(t)&&"with"in t[t.length-1])return t[t.length-1].with}},Fd=r=>{try{JSON.parse(r)}catch{return!1}return!0};class Xo extends Error{constructor(t){super(`${t} Please configure the context of the view execution in the executeView method.`),this.info=t,this.name="InvalidViewSimulationContext"}}class Gd extends Error{constructor(t){super(t),this.message=t,this.name="RevealOperationError"}}class Kd extends Error{constructor(t){super(t),this.message=t,this.name="OriginationParameterError"}}const Wn=({code:r,init:t,balance:e="0",delegate:n,storage:i,fee:s=cr.ORIGINATION,gasLimit:o=ar.ORIGINATION,storageLimit:c=ur.ORIGINATION,mutez:l=!1})=>S(void 0,void 0,void 0,function*(){if(i!==void 0&&t!==void 0)throw new Kd("Storage and Init cannot be set a the same time. Please either use storage or init but not both.");if(!Array.isArray(r))throw new zn("Wrong code parameter type, expected an array",r);let m;if(i!==void 0){const P=r.find(D=>"prim"in D&&D.prim==="storage");if((P==null?void 0:P.args)===void 0)throw new zn("The storage section is missing from the script",r);m=new Ht(P.args[0]).Encode(i)}else if(t!==void 0&&typeof t=="object")m=t;else throw new Fc("Wrong init parameter type, expected JSON Michelson",t);const y={code:r,storage:m},v={kind:I.ORIGINATION,fee:s,gas_limit:o,storage_limit:c,balance:l?e.toString():Bs("tz","mutez",e).toString(),script:y};return n&&(v.delegate=n),v}),Yn=({to:r,amount:t,parameter:e,fee:n=cr.TRANSFER,gasLimit:i=ar.TRANSFER,storageLimit:s=ur.TRANSFER,mutez:o=!1})=>S(void 0,void 0,void 0,function*(){return{kind:I.TRANSACTION,fee:n,gas_limit:i,storage_limit:s,amount:o?t.toString():Bs("tz","mutez",t).toString(),destination:r,parameters:e}}),Jn=({delegate:r,source:t,fee:e=cr.DELEGATION,gasLimit:n=ar.DELEGATION,storageLimit:i=ur.DELEGATION})=>S(void 0,void 0,void 0,function*(){return{kind:I.DELEGATION,source:t,fee:e,gas_limit:n,storage_limit:i,delegate:r}}),Gc=({fee:r=cr.DELEGATION,gasLimit:t=ar.DELEGATION,storageLimit:e=ur.DELEGATION},n)=>S(void 0,void 0,void 0,function*(){return{kind:I.DELEGATION,fee:r,gas_limit:t,storage_limit:e,delegate:n}}),tn=({fee:r=cr.REVEAL,gasLimit:t=ar.REVEAL,storageLimit:e=ur.REVEAL},n,i)=>S(void 0,void 0,void 0,function*(){return{kind:I.REVEAL,fee:r,public_key:i,source:n,gas_limit:t,storage_limit:e}}),Xn=({value:r,source:t,fee:e,gasLimit:n,storageLimit:i})=>S(void 0,void 0,void 0,function*(){return{kind:I.REGISTER_GLOBAL_CONSTANT,value:r,fee:e,gas_limit:n,storage_limit:i,source:t}}),Zn=({source:r,fee:t,gasLimit:e,storageLimit:n})=>S(void 0,void 0,void 0,function*(){return{kind:I.TX_ROLLUP_ORIGINATION,fee:t,gas_limit:e,storage_limit:n,source:r,tx_rollup_origination:{}}}),Qn=({content:r,rollup:t,source:e,fee:n,gasLimit:i,storageLimit:s})=>S(void 0,void 0,void 0,function*(){return{kind:I.TX_ROLLUP_SUBMIT_BATCH,fee:n,gas_limit:i,storage_limit:s,source:e,content:r,rollup:t}}),Ki=(r,t)=>Object.assign(Object.assign({},r),{kind:t}),Zo=(r,t)=>{if(Array.isArray(r)){const e=r.find(n=>n.kind===t);if(e&&qd(e,t))return e}},qd=(r,t)=>r.kind===t,Kc=r=>["transaction","delegation","origination","reveal","register_global_constant","tx_rollup_origination","tx_rollup_submit_batch"].indexOf(r.kind)!==-1,os=r=>["transaction","delegation","origination","register_global_constant","tx_rollup_origination","tx_rollup_submit_batch"].indexOf(r.kind)!==-1,Ds=r=>"metadata"in r,Fr=r=>Ds(r)&&"operation_result"in r.metadata,zd=r=>Ds(r)&&"internal_operation_results"in r.metadata,Wd=r=>"with"in r;class qc extends Error{constructor(t,e){super(),this.errors=t,this.errorDetails=e,this.name="TezosOperationError";const n=t[t.length-1];this.id=n.id,this.kind=n.kind,this.message=`(${this.kind}) ${this.id}`,Wd(n)&&(n.with.string?this.message=n.with.string:n.with.int?this.message=n.with.int:this.message=JSON.stringify(n.with))}}class Yd extends Error{constructor(t){super("Preapply returned an unexpected result"),this.result=t,this.name="TezosPreapplyFailureError"}}const Ae=r=>{const t=Array.isArray(r)?r:[r],e=[];for(let n=0;n<t.length;n++)for(let i=0;i<t[n].contents.length;i++){const s=t[n].contents[i];Fr(s)&&(e.push(Object.assign({fee:s.fee},s.metadata.operation_result)),Array.isArray(s.metadata.internal_operation_results)&&s.metadata.internal_operation_results.forEach(o=>e.push(o.result)))}return e},Hr=(r,t="failed")=>{const e=Array.isArray(r)?r:[r];let n=[];for(let i=0;i<e.length;i++)for(let s=0;s<e[i].contents.length;s++){const o=e[i].contents[s];if(Ds(o)&&(Fr(o)&&o.metadata.operation_result.status===t&&(n=n.concat(o.metadata.operation_result.errors||[])),zd(o)&&Array.isArray(o.metadata.internal_operation_results)))for(const c of o.metadata.internal_operation_results)"result"in c&&c.result.status===t&&(n=n.concat(c.result.errors||[]))}return n};class Jd extends Error{constructor(t){super(t),this.message=t,this.name="OriginationOperationError"}}class zc extends Error{constructor(t){super(t),this.message=t,this.name="InvalidConfirmationCountError"}}class Xd extends Error{constructor(t){super(t),this.message=t,this.name="ConfirmationUndefinedError"}}class Zd extends Error{constructor(t){super(t),this.message=t,this.name="InvalidFilterExpressionError"}}class Fe{constructor(t,e,n,i){if(this.hash=t,this.raw=e,this.results=n,this.context=i,this._pollingConfig$=new kn(1),this.currentHead$=this._pollingConfig$.pipe(Er(s=>Va(()=>Hc(this.context.stream.subscribeBlock("head"))).pipe(Ga(s.timeout*1e3,ws(new Error("Confirmation polling timed out"))))),Xr({refCount:!0})),this.confirmed$=this.currentHead$.pipe(br(s=>{for(let o=3;o>=0;o--)s.operations[o].forEach(c=>{c.hash===this.hash&&(this._foundAt=s.header.level)});if(s.header.level-this._foundAt>=0)return this._foundAt}),jn(s=>s!==void 0),ke(),Xr()),this._foundAt=Number.POSITIVE_INFINITY,aa(this.hash)!==U.VALID)throw new ca(this.hash);this.confirmed$.pipe(ke(),Os(()=>nn(Ca))).subscribe()}get includedInBlock(){return this._foundAt}get revealOperation(){return Array.isArray(this.results)&&this.results.find(t=>t.kind==="reveal")}get revealStatus(){return this.revealOperation?this.revealOperation.metadata.operation_result.status:"unknown"}get status(){return this.results.map(t=>Fr(t)?t.metadata.operation_result.status:"unknown")[0]||"unknown"}confirmation(t,e){return S(this,void 0,void 0,function*(){if(typeof t<"u"&&t<1)throw new zc("Confirmation count must be at least 1");const{defaultConfirmationCount:n,confirmationPollingTimeoutSecond:i}=this.context.config;this._pollingConfig$.next({timeout:e||i});const s=t!==void 0?t:n;return new Promise((o,c)=>{this.confirmed$.pipe(Er(()=>this.currentHead$),jn(l=>l.header.level-this._foundAt>=s-1),ke()).subscribe(l=>{o(this._foundAt+(s-1))},c)})})}}class Qd extends Fe{constructor(t,e,n,i,s,o){super(t,i,s,o),this.params=e,this.source=n}sumProp(t,e){return t.reduce((n,i)=>e in i?Number(i[e])+n:n,0)}get status(){return this.results.filter(t=>Wc.indexOf(t.kind)!==-1).map(t=>Fr(t)?t.metadata.operation_result.status:"unknown")[0]||"unknown"}get fee(){return this.sumProp(this.params,"fee")}get gasLimit(){return this.sumProp(this.params,"gas_limit")}get storageLimit(){return this.sumProp(this.params,"storage_limit")}get consumedGas(){return String(this.sumProp(Ae({contents:this.results}),"consumed_gas"))}get storageDiff(){return String(this.sumProp(Ae({contents:this.results}),"paid_storage_size_diff"))}get errors(){return Hr({contents:this.results})}}class hi{constructor(t){this.context=t}get rpc(){return this.context.rpc}get signer(){return this.context.signer}isRevealOpNeeded(t,e){return S(this,void 0,void 0,function*(){return!(!(yield this.isAccountRevealRequired(e))||!this.isRevealRequiredForOpType(t))})}isAccountRevealRequired(t){return S(this,void 0,void 0,function*(){return!(yield this.context.readProvider.isAccountRevealed(t,"head"))})}isRevealRequiredForOpType(t){let e=!1;for(const n of t)os(n)&&(e=!0);return e}prepareOperation({operation:t,source:e},n){return S(this,void 0,void 0,function*(){const i={};let s=[];const o=this.context.readProvider.getBlockHash("head~2"),c=this.context.readProvider.getNextProtocol("head");Array.isArray(t)?s=[...t]:s=[t];const l=n||(yield this.signer.publicKeyHash());let m=Promise.resolve(void 0);for(let _=0;_<s.length;_++)if(os(s[_])||s[_].kind==="reveal"){m=this.context.readProvider.getCounter(l,"head");break}const[y,v,P]=yield Promise.all([o,c,m]),T=parseInt(P||"0",10);(!i[l]||i[l]<T)&&(i[l]=T);const D=_=>({counter:`${++i[l]}`,fee:typeof _.fee>"u"?"0":`${_.fee}`,gas_limit:typeof _.gas_limit>"u"?"0":`${_.gas_limit}`,storage_limit:typeof _.storage_limit>"u"?"0":`${_.storage_limit}`}),W=_=>({source:typeof _.source>"u"?e||l:_.source}),L=(_=>_.map(nt=>{switch(nt.kind){case I.ACTIVATION:return Object.assign({},nt);case I.ORIGINATION:return Object.assign(Object.assign(Object.assign(Object.assign({},nt),{balance:typeof nt.balance<"u"?`${nt.balance}`:"0"}),W(nt)),D(nt));case I.TRANSACTION:{const B=Object.assign(Object.assign(Object.assign(Object.assign({},nt),{amount:typeof nt.amount<"u"?`${nt.amount}`:"0"}),W(nt)),D(nt));if(B.source.toLowerCase().startsWith("kt1"))throw new ua(`KT1 addresses are not supported as source since ${It.PsBabyM1}`);return B}case I.REVEAL:case I.DELEGATION:case I.REGISTER_GLOBAL_CONSTANT:case I.TX_ROLLUP_ORIGINATION:case I.TX_ROLLUP_SUBMIT_BATCH:return Object.assign(Object.assign(Object.assign({},nt),W(nt)),D(nt));default:throw new nr(nt.kind)}}))(s);return{opOb:{branch:y,contents:L,protocol:v},counter:T}})}forge({opOb:{branch:t,contents:e,protocol:n},counter:i}){return S(this,void 0,void 0,function*(){return{opbytes:yield this.context.forger.forge({branch:t,contents:e}),opOb:{branch:t,contents:e,protocol:n},counter:i}})}simulate(t){return S(this,void 0,void 0,function*(){return{opResponse:yield this.rpc.runOperation(t),op:t,context:this.context.clone()}})}estimate(t,e){var{fee:n,gasLimit:i,storageLimit:s}=t,o=hr(t,["fee","gasLimit","storageLimit"]);return S(this,void 0,void 0,function*(){let c=n,l=i,m=s;if(n===void 0||i===void 0||s===void 0){const y=yield e(Object.assign({fee:n,gasLimit:i,storageLimit:s},o));c===void 0&&(c=y.suggestedFeeMutez),l===void 0&&(l=y.gasLimit),m===void 0&&(m=y.storageLimit)}return{fee:c,gasLimit:l,storageLimit:m}})}signAndInject(t){return S(this,void 0,void 0,function*(){const e=yield this.signer.sign(t.opbytes,new Uint8Array([3]));t.opbytes=e.sbytes,t.opOb.signature=e.prefixSig;const n=[],i=yield this.rpc.preapplyOperations([t.opOb]);if(!Array.isArray(i))throw new Yd(i);for(let o=0;o<i.length;o++)for(let c=0;c<i[o].contents.length;c++)n.push(i[o].contents[c]);const s=Hr(i);if(s.length)throw new qc(s,"Error occurred during validation simulation of operation");return{hash:yield this.context.injector.inject(t.opbytes),forgedBytes:t,opResponse:n,context:this.context.clone()}})}}const Wc=[I.ACTIVATION,I.ORIGINATION,I.TRANSACTION,I.DELEGATION];class Yc extends hi{constructor(t,e){super(t),this.estimator=e,this.operations=[]}withTransfer(t){if(pt(t.to)!==U.VALID)throw new bt(t.to);return this.operations.push(Object.assign({kind:I.TRANSACTION},t)),this}withContractCall(t){return this.withTransfer(t.toTransferParams())}withDelegation(t){if(t.source&&pt(t.source)!==U.VALID)throw new bt(t.source);if(t.delegate&&pt(t.delegate)!==U.VALID)throw new bt(t.delegate);return this.operations.push(Object.assign({kind:I.DELEGATION},t)),this}withActivation({pkh:t,secret:e}){if(ls(t)!==U.VALID)throw new hs(t);return this.operations.push({kind:I.ACTIVATION,pkh:t,secret:e}),this}withOrigination(t){return this.operations.push(Object.assign({kind:I.ORIGINATION},t)),this}withRegisterGlobalConstant(t){return this.operations.push(Object.assign({kind:I.REGISTER_GLOBAL_CONSTANT},t)),this}withTxRollupOrigination(t){return this.operations.push(Object.assign({kind:I.TX_ROLLUP_ORIGINATION},t)),this}withTxRollupSubmitBatch(t){return this.operations.push(Object.assign({kind:I.TX_ROLLUP_SUBMIT_BATCH},t)),this}getRPCOp(t){return S(this,void 0,void 0,function*(){switch(t.kind){case I.TRANSACTION:return Yn(Object.assign({},t));case I.ORIGINATION:return Wn(yield this.context.parser.prepareCodeOrigination(Object.assign({},t)));case I.DELEGATION:return Jn(Object.assign({},t));case I.ACTIVATION:return Object.assign({},t);case I.REGISTER_GLOBAL_CONSTANT:return Xn(Object.assign({},t));case I.TX_ROLLUP_ORIGINATION:return Zn(Object.assign({},t));case I.TX_ROLLUP_SUBMIT_BATCH:return Qn(Object.assign({},t));default:throw new nr(t.kind)}})}with(t){for(const e of t)switch(e.kind){case I.TRANSACTION:this.withTransfer(e);break;case I.ORIGINATION:this.withOrigination(e);break;case I.DELEGATION:this.withDelegation(e);break;case I.ACTIVATION:this.withActivation(e);break;case I.REGISTER_GLOBAL_CONSTANT:this.withRegisterGlobalConstant(e);break;case I.TX_ROLLUP_ORIGINATION:this.withTxRollupOrigination(e);break;case I.TX_ROLLUP_SUBMIT_BATCH:this.withTxRollupSubmitBatch(e);break;default:throw new nr(e.kind)}return this}send(t){return S(this,void 0,void 0,function*(){const e=yield this.signer.publicKeyHash(),n=yield this.signer.publicKey(),i=yield this.estimator.batch(this.operations),s=yield this.isRevealOpNeeded(this.operations,e);let o=s?1:0;const c=[];for(const W of this.operations){if(Kc(W)){const C=yield this.estimate(W,()=>S(this,void 0,void 0,function*(){return i[o]}));c.push(yield this.getRPCOp(Object.assign(Object.assign({},W),C)))}else c.push(Object.assign({},W));o++}if(s){const W={kind:I.REVEAL},C=yield this.estimate(W,()=>S(this,void 0,void 0,function*(){return i[0]}));c.unshift(yield tn(Object.assign({},C),e,n))}const l=t&&t.source||e,m=yield this.prepareOperation({operation:c,source:l}),y=yield this.forge(m),{hash:v,context:P,forgedBytes:T,opResponse:D}=yield this.signAndInject(y);return new Qd(v,c,l,T,D,P)})}}class tg{constructor(t,e){this.context=t,this.estimator=e}batch(t){const e=new Yc(this.context,this.estimator);return Array.isArray(t)&&e.with(t),e}}const eg=(r,{ALLOCATION_BURN:t,ORIGINATION_BURN:e}={ALLOCATION_BURN:257,ORIGINATION_BURN:257})=>{const n=Ae({contents:r});let i=new G(0),s=new G(0),o=new G(0),c=new G(0),l=new G(0),m=new G(0);return n.forEach(y=>{o=o.plus(y.fee||0),c=c.plus(Array.isArray(y.originated_contracts)?y.originated_contracts.length*e:0),l=l.plus("allocated_destination_contract"in y?t:0),i=i.plus(y.consumed_gas||0),m=m.plus("paid_storage_size_diff"in y&&Number(y.paid_storage_size_diff)||0)}),s=s.plus(l).plus(c).plus(m),{totalFee:o,totalGas:i,totalStorage:s,totalAllocationBurn:l,totalOriginationBurn:c,totalPaidStorageDiff:m,totalStorageBurn:new G(s.multipliedBy(1e3))}};class rg extends Error{constructor(){super("Taquito missed a block while waiting for operation confirmation and was not able to find the operation"),this.name="MissedBlockDuringConfirmationError"}}const ng=60;class bn{constructor(t,e,n){if(this.opHash=t,this.context=e,this._newHead$=n,this._operationResult=new kn(1),this._includedInBlock=new kn(1),this._included=!1,this.newHead$=this._newHead$.pipe(Zi(i=>{if(!this._included&&this.lastHead&&i.header.level-this.lastHead.header.level>1)throw new rg;this.lastHead=i}),Xr({bufferSize:1,refCount:!0})),this.confirmed$=this.newHead$.pipe(br(i=>{for(const s of i.operations)for(const o of s)if(o.hash===this.opHash)return this._included=!0,this._includedInBlock.next(i),this._operationResult.next(o.contents),i}),jn(i=>typeof i<"u"),ke(),Xr({bufferSize:1,refCount:!0})),aa(this.opHash)!==U.VALID)throw new ca(this.opHash);this.confirmed$.pipe(ke(),Os(()=>nn(void 0))).subscribe()}operationResults(){return S(this,void 0,void 0,function*(){return this._operationResult.pipe(ke()).toPromise()})}receipt(){return S(this,void 0,void 0,function*(){return eg(yield this.operationResults())})}getCurrentConfirmation(){return S(this,void 0,void 0,function*(){return this._included?Ao([this._includedInBlock,Ar(this.context.readProvider.getBlock("head"))]).pipe(br(([t,e])=>e.header.level-t.header.level+1),ke()).toPromise():0})}isInCurrentBranch(t="head"){return S(this,void 0,void 0,function*(){if(!this._included)return!0;const e=yield this.context.readProvider.getBlockLevel(t),n=yield this._includedInBlock.pipe(ke()).toPromise(),i=e-n.header.level;if(i<=0)return!0;const s=Math.min(n.header.level+i,n.header.level+ng);return new Set(yield this.context.readProvider.getLiveBlocks(s)).has(n.hash)})}confirmationObservable(t){if(typeof t<"u"&&t<1)throw new zc("Confirmation count must be at least 1");const{defaultConfirmationCount:e}=this.context.config,n=t!==void 0?t:e;if(n===void 0)throw new Xd("Default confirmation count can not be undefined!");return Ao([this._includedInBlock,this.newHead$]).pipe(Ua(([,i],[,s])=>i.hash===s.hash),br(([i,s])=>({block:s,expectedConfirmation:n,currentConfirmation:s.header.level-i.header.level+1,completed:s.header.level-i.header.level>=n-1,isInCurrentBranch:()=>this.isInCurrentBranch(s.hash)})),jh(({completed:i})=>!i,!0))}confirmation(t){return this.confirmationObservable(t).toPromise()}}class ig extends bn{constructor(t,e,n){super(t,e,n),this.opHash=t,this.context=e}revealOperation(){return S(this,void 0,void 0,function*(){return(yield this.operationResults()).find(e=>e.kind===I.REVEAL)})}status(){return S(this,void 0,void 0,function*(){return this._included?(yield this.operationResults()).filter(e=>Wc.indexOf(e.kind)!==-1).map(e=>Fr(e)?e.metadata.operation_result.status:"unknown")[0]||"unknown":"pending"})}}class sg extends bn{constructor(t,e,n){super(t,e,n),this.opHash=t,this.context=e}revealOperation(){return S(this,void 0,void 0,function*(){return(yield this.operationResults()).find(e=>e.kind===I.REVEAL)})}delegationOperation(){return S(this,void 0,void 0,function*(){return(yield this.operationResults()).find(e=>e.kind===I.DELEGATION)})}status(){return S(this,void 0,void 0,function*(){if(!this._included)return"pending";const t=yield this.delegationOperation();return t?t.metadata.operation_result.status:"unknown"})}}class og extends bn{constructor(t,e,n){super(t,e,n),this.opHash=t,this.context=e}originationOperation(){return S(this,void 0,void 0,function*(){const t=yield this.operationResults();return Zo(t,I.ORIGINATION)})}revealOperation(){return S(this,void 0,void 0,function*(){const t=yield this.operationResults();return Zo(t,I.REVEAL)})}status(){return S(this,void 0,void 0,function*(){if(!this._included)return"pending";const t=yield this.originationOperation();return t?t.metadata.operation_result.status:"unknown"})}contract(){return S(this,void 0,void 0,function*(){const t=yield this.originationOperation(),e=((t==null?void 0:t.metadata.operation_result.originated_contracts)||[])[0];return this.context.wallet.at(e)})}}class ag extends bn{constructor(t,e,n){super(t,e,n),this.opHash=t,this.context=e}revealOperation(){return S(this,void 0,void 0,function*(){return(yield this.operationResults()).find(e=>e.kind===I.REVEAL)})}transactionOperation(){return S(this,void 0,void 0,function*(){return(yield this.operationResults()).find(e=>e.kind===I.TRANSACTION)})}status(){return S(this,void 0,void 0,function*(){if(!this._included)return"pending";const t=yield this.transactionOperation();return t?t.metadata.operation_result.status:"unknown"})}}const cg=(r,t,e)=>r.pipe(Ga(t.config.confirmationPollingTimeoutSecond*1e3,ws(new Error("Confirmation polling timed out")),e),Xr({refCount:!0,scheduler:e}));class ug{constructor(t){this.context=t,this.sharedHeadObs=Va(()=>Hc(this.context.stream.subscribeBlock("head")))}createNewHeadObservable(){return S(this,void 0,void 0,function*(){return cg(this.sharedHeadObs,this.context)})}createPastBlockWalker(t,e=1){return Ar(this.context.readProvider.getBlock(t)).pipe(Er(n=>e===1?nn(n):ch(n.header.level,e-1).pipe(Ch(n),Ha(i=>S(this,void 0,void 0,function*(){return this.context.readProvider.getBlock(typeof i=="number"?i:i.header.level)})))))}createHeadObservableFromConfig({blockIdentifier:t}){return S(this,void 0,void 0,function*(){const e=[];return t&&e.push(this.createPastBlockWalker(t)),e.push(yield this.createNewHeadObservable()),Xi(...e)})}createOperation(t,e={}){return S(this,void 0,void 0,function*(){return new bn(t,this.context.clone(),yield this.createHeadObservableFromConfig(e))})}createBatchOperation(t,e={}){return S(this,void 0,void 0,function*(){return new ig(t,this.context.clone(),yield this.createHeadObservableFromConfig(e))})}createTransactionOperation(t,e={}){return S(this,void 0,void 0,function*(){return new ag(t,this.context.clone(),yield this.createHeadObservableFromConfig(e))})}createDelegationOperation(t,e={}){return S(this,void 0,void 0,function*(){return new sg(t,this.context.clone(),yield this.createHeadObservableFromConfig(e))})}createOriginationOperation(t,e={}){return S(this,void 0,void 0,function*(){return new og(t,this.context.clone(),yield this.createHeadObservableFromConfig(e))})}}class lg extends hi{constructor(t){super(t)}getBalance(t){return S(this,void 0,void 0,function*(){if(pt(t)!==U.VALID)throw new bt(t);return this.context.readProvider.getBalance(t,"head")})}getDelegate(t){return S(this,void 0,void 0,function*(){if(pt(t)!==U.VALID)throw new bt(t);return this.context.readProvider.getDelegate(t,"head")})}activate(t,e){return S(this,void 0,void 0,function*(){if(ls(t)!==U.VALID)throw new hs(t);const n={kind:I.ACTIVATION,pkh:t,secret:e},i=yield this.prepareOperation({operation:[n],source:t}),s=yield this.forge(i),o=`${s.opbytes}00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000`;return new Fe(yield this.rpc.injectOperation(o),Object.assign(Object.assign({},s),{opbytes:o}),[],this.context.clone())})}}const Sn=100,hg=1,fg=.1,Qo=100;class Yt{constructor(t,e,n,i,s=Sn){this._milligasLimit=t,this._storageLimit=e,this.opSize=n,this.minimalFeePerStorageByteMutez=i,this.baseFeeMutez=s}get burnFeeMutez(){return this.roundUp(Number(this.storageLimit)*Number(this.minimalFeePerStorageByteMutez))}get storageLimit(){const t=Math.max(Number(this._storageLimit),0);return t>0?t:0}get gasLimit(){return this.roundUp(Number(this._milligasLimit)/1e3+Qo)}get operationFeeMutez(){return(Number(this._milligasLimit)/1e3+Qo)*fg+Number(this.opSize)*hg}roundUp(t){return Math.ceil(Number(t))}get minimalFeeMutez(){return this.roundUp(Sn+this.operationFeeMutez)}get suggestedFeeMutez(){return this.roundUp(this.operationFeeMutez+Sn*2)}get usingBaseFeeMutez(){return Math.max(Number(this.baseFeeMutez),Sn)+this.roundUp(this.operationFeeMutez)}get totalCost(){return this.minimalFeeMutez+this.burnFeeMutez}get consumedMilligas(){return Number(this._milligasLimit)}static createEstimateInstanceFromProperties(t){let e=0,n=0,i=0,s=0,o;return t.forEach(c=>{e+=c.milligasLimit,n+=c.storageLimit,i+=c.opSize,s=Math.max(c.minimalFeePerStorageByteMutez,s),c.baseFeeMutez&&(o=o?o+c.baseFeeMutez:c.baseFeeMutez)}),new Yt(e,n,i,s,o)}static createArrayEstimateInstancesFromProperties(t){return t.map(e=>new Yt(e.milligasLimit,e.storageLimit,e.opSize,e.minimalFeePerStorageByteMutez,e.baseFeeMutez))}}class ta extends Error{constructor(){super("Unable to estimate the reveal operation, the public key is unknown"),this.name="Reveal Estimate Error"}}const zt=(r,t)=>({fee:typeof r.fee>"u"?t.fee:r.fee,gasLimit:typeof r.gasLimit>"u"?t.gasLimit:r.gasLimit,storageLimit:typeof r.storageLimit>"u"?t.storageLimit:r.storageLimit}),pg="edsigtkpiSSschcaCt9pUVrpNPf7TTcgvgDEDD6NCEHMy8NNQJCGnMfLZzYoQj74yLjo9wx6MPVV29CvVzgi7qEcEUok3k7AuMg";class dg extends hi{constructor(){super(...arguments),this.ALLOCATION_STORAGE=257,this.ORIGINATION_STORAGE=257,this.OP_SIZE_REVEAL=128}getKeys(){return S(this,void 0,void 0,function*(){const t=this.context.isAnySignerConfigured();return{publicKeyHash:t?yield this.signer.publicKeyHash():yield this.context.walletProvider.getPKH(),publicKey:t?yield this.signer.publicKey():void 0}})}getAccountLimits(t,e,n){return S(this,void 0,void 0,function*(){const i=yield this.context.readProvider.getBalance(t,"head"),{hard_gas_limit_per_operation:s,hard_gas_limit_per_block:o,hard_storage_limit_per_operation:c,cost_per_byte:l}=e;return{fee:0,gasLimit:n?Math.floor(this.ajustGasForBatchOperation(o,s,n).toNumber()):s.toNumber(),storageLimit:Math.floor(G.min(i.dividedBy(l),c).toNumber())}})}ajustGasForBatchOperation(t,e,n){return G.min(e,t.div(n+1))}getEstimationPropertiesFromOperationContent(t,e,n,i){const s=Ae({contents:[t]});let o=0,c=0,l=0;return s.forEach(m=>{l+="originated_contracts"in m&&typeof m.originated_contracts<"u"?m.originated_contracts.length*this.ORIGINATION_STORAGE:0,l+="allocated_destination_contract"in m?this.ALLOCATION_STORAGE:0,o+=Number(m.consumed_gas)||0,c+=Number(m.consumed_milligas)||0,l+="paid_storage_size_diff"in m&&Number(m.paid_storage_size_diff)||0,l+="storage_size"in m&&"global_address"in m&&Number(m.storage_size)||0,l+="originated_rollup"in m?i:0}),o!==0&&c===0&&(c=o*1e3),Kc(t)?{milligasLimit:c||0,storageLimit:Number(l||0),opSize:e,minimalFeePerStorageByteMutez:n.toNumber()}:{milligasLimit:0,storageLimit:0,opSize:e,minimalFeePerStorageByteMutez:n.toNumber(),baseFeeMutez:0}}prepareEstimate(t,e,n){return S(this,void 0,void 0,function*(){const i=yield this.prepareOperation(t,n),{opbytes:s,opOb:{branch:o,contents:c}}=yield this.forge(i),l={operation:{branch:o,contents:c,signature:pg},chain_id:yield this.context.readProvider.getChainId()},{opResponse:m}=yield this.simulate(l),{cost_per_byte:y,tx_rollup_origination_size:v}=e,P=[...Hr(m,"backtracked"),...Hr(m)];if(P.length)throw new qc(P,"Error occurred during estimation");let T=1;return Array.isArray(t.operation)&&t.operation.length>1&&(T=m.contents[0].kind==="reveal"?t.operation.length-1:t.operation.length),m.contents.map(D=>this.getEstimationPropertiesFromOperationContent(D,D.kind==="reveal"?this.OP_SIZE_REVEAL/2:s.length/2/T,y,v!=null?v:0))})}originate(t){var{fee:e,storageLimit:n,gasLimit:i}=t,s=hr(t,["fee","storageLimit","gasLimit"]);return S(this,void 0,void 0,function*(){const{publicKeyHash:o}=yield this.getKeys(),c=yield this.context.readProvider.getProtocolConstants("head"),l=yield this.getAccountLimits(o,c),m=yield Wn(yield this.context.parser.prepareCodeOrigination(Object.assign(Object.assign({},s),zt({fee:e,storageLimit:n,gasLimit:i},l)))),y=yield this.isRevealOpNeeded([m],o),v=y?yield this.addRevealOp([m],o):m,P=yield this.prepareEstimate({operation:v,source:o},c,o);return y&&P.shift(),Yt.createEstimateInstanceFromProperties(P)})}transfer(t){var{fee:e,storageLimit:n,gasLimit:i}=t,s=hr(t,["fee","storageLimit","gasLimit"]);return S(this,void 0,void 0,function*(){if(pt(s.to)!==U.VALID)throw new bt(s.to);if(s.source&&pt(s.source)!==U.VALID)throw new bt(s.source);const o=(yield this.getKeys()).publicKeyHash,c=yield this.context.readProvider.getProtocolConstants("head"),l=yield this.getAccountLimits(o,c),m=yield Yn(Object.assign(Object.assign({},s),zt({fee:e,storageLimit:n,gasLimit:i},l))),y=yield this.isRevealOpNeeded([m],o),v=y?yield this.addRevealOp([m],o):m,P=yield this.prepareEstimate({operation:v,source:o},c,o);return y&&P.shift(),Yt.createEstimateInstanceFromProperties(P)})}setDelegate(t){var{fee:e,gasLimit:n,storageLimit:i}=t,s=hr(t,["fee","gasLimit","storageLimit"]);return S(this,void 0,void 0,function*(){if(s.source&&pt(s.source)!==U.VALID)throw new bt(s.source);if(s.delegate&&pt(s.delegate)!==U.VALID)throw new bt(s.delegate);const o=(yield this.getKeys()).publicKeyHash,c=s.source||o,l=yield this.context.readProvider.getProtocolConstants("head"),m=yield this.getAccountLimits(c,l),y=yield Jn(Object.assign(Object.assign({},s),zt({fee:e,storageLimit:i,gasLimit:n},m))),v=yield this.isRevealOpNeeded([y],o),P=v?yield this.addRevealOp([y],o):y,T=yield this.prepareEstimate({operation:P,source:o},l,o);return v&&T.shift(),Yt.createEstimateInstanceFromProperties(T)})}batch(t){return S(this,void 0,void 0,function*(){const{publicKeyHash:e}=yield this.getKeys();let n=[];const i=yield this.context.readProvider.getProtocolConstants("head"),s=yield this.getAccountLimits(e,i,t.length);for(const l of t)switch(l.kind){case I.TRANSACTION:n.push(yield Yn(Object.assign(Object.assign({},l),zt(l,s))));break;case I.ORIGINATION:n.push(yield Wn(yield this.context.parser.prepareCodeOrigination(Object.assign(Object.assign({},l),zt(l,s)))));break;case I.DELEGATION:n.push(yield Jn(Object.assign(Object.assign({},l),zt(l,s))));break;case I.ACTIVATION:n.push(Object.assign(Object.assign({},l),s));break;case I.REGISTER_GLOBAL_CONSTANT:n.push(yield Xn(Object.assign(Object.assign({},l),zt(l,s))));break;case I.TX_ROLLUP_ORIGINATION:n.push(yield Zn(Object.assign(Object.assign({},l),zt(l,s))));break;case I.TX_ROLLUP_SUBMIT_BATCH:n.push(yield Qn(Object.assign(Object.assign({},l),zt(l,s))));break;default:throw new nr(t.kind)}n=(yield this.isRevealOpNeeded(n,e))?yield this.addRevealOp(n,e):n;const c=yield this.prepareEstimate({operation:n,source:e},i,e);return Yt.createArrayEstimateInstancesFromProperties(c)})}registerDelegate(t){return S(this,void 0,void 0,function*(){const e=(yield this.getKeys()).publicKeyHash,n=yield this.context.readProvider.getProtocolConstants("head"),i=yield this.getAccountLimits(e,n),s=yield Gc(Object.assign(Object.assign({},t),i),e),o=yield this.isRevealOpNeeded([s],e),c=o?yield this.addRevealOp([s],e):s,l=yield this.prepareEstimate({operation:c,source:e},n,e);return o&&l.shift(),Yt.createEstimateInstanceFromProperties(l)})}reveal(t){return S(this,void 0,void 0,function*(){const{publicKeyHash:e,publicKey:n}=yield this.getKeys();if(!n)throw new ta;if(yield this.isAccountRevealRequired(e)){const i=yield this.context.readProvider.getProtocolConstants("head"),s=yield this.getAccountLimits(e,i),o=yield tn(Object.assign(Object.assign({},t),s),e,n),c=yield this.prepareEstimate({operation:o,source:e},i,e);return Yt.createEstimateInstanceFromProperties(c)}})}registerGlobalConstant(t){var{fee:e,storageLimit:n,gasLimit:i}=t,s=hr(t,["fee","storageLimit","gasLimit"]);return S(this,void 0,void 0,function*(){const o=(yield this.getKeys()).publicKeyHash,c=yield this.context.readProvider.getProtocolConstants("head"),l=yield this.getAccountLimits(o,c),m=yield Xn(Object.assign(Object.assign({},s),zt({fee:e,storageLimit:n,gasLimit:i},l))),y=yield this.isRevealOpNeeded([m],o),v=y?yield this.addRevealOp([m],o):m,P=yield this.prepareEstimate({operation:v,source:o},c,o);return y&&P.shift(),Yt.createEstimateInstanceFromProperties(P)})}txRollupOriginate(t){return S(this,void 0,void 0,function*(){t=t||{};const{fee:e,storageLimit:n,gasLimit:i}=t,s=hr(t,["fee","storageLimit","gasLimit"]),o=(yield this.getKeys()).publicKeyHash,c=yield this.context.readProvider.getProtocolConstants("head"),l=yield this.getAccountLimits(o,c),m=yield Zn(Object.assign(Object.assign({},s),zt({fee:e,storageLimit:n,gasLimit:i},l))),y=yield this.isRevealOpNeeded([m],o),v=y?yield this.addRevealOp([m],o):m,P=yield this.prepareEstimate({operation:v,source:o},c,o);return y&&P.shift(),Yt.createEstimateInstanceFromProperties(P)})}txRollupSubmitBatch(t){return S(this,void 0,void 0,function*(){const{fee:e,storageLimit:n,gasLimit:i}=t,s=hr(t,["fee","storageLimit","gasLimit"]),o=(yield this.getKeys()).publicKeyHash,c=yield this.context.readProvider.getProtocolConstants("head"),l=yield this.getAccountLimits(o,c),m=yield Qn(Object.assign(Object.assign({},s),zt({fee:e,storageLimit:n,gasLimit:i},l))),y=yield this.isRevealOpNeeded([m],o),v=y?yield this.addRevealOp([m],o):m,P=yield this.prepareEstimate({operation:v,source:o},c,o);return y&&P.shift(),Yt.createEstimateInstanceFromProperties(P)})}addRevealOp(t,e){return S(this,void 0,void 0,function*(){const{publicKey:n}=yield this.getKeys();if(!n)throw new ta;return t.unshift(yield tn(Object.assign({fee:cr.REVEAL,gasLimit:ar.REVEAL,storageLimit:ur.REVEAL}),e,yield this.signer.publicKey())),t})}}class ea extends Fe{constructor(t,e,n,i,s,o){super(t,i,s,o),this.params=e,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="delegation"),e=t&&t.metadata&&t.metadata.operation_result;return e||void 0}get status(){const t=this.operationResults;return t?t.status:"unknown"}get delegate(){return this.delegate}get isRegisterOperation(){return this.delegate===this.source}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get consumedGas(){const t=this.operationResults&&this.operationResults.consumed_gas;return t||void 0}get errors(){return this.operationResults&&this.operationResults.errors}}class gg extends Fe{constructor(t,e,n,i,s,o){super(t,n,i,s),this.params=e,this.contractProvider=o;const c=this.operationResults&&this.operationResults.originated_contracts;Array.isArray(c)&&(this.contractAddress=c[0])}get status(){const t=this.operationResults;return t?t.status:"unknown"}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="origination"),e=t&&Fr(t)&&t.metadata.operation_result;return e||void 0}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get consumedGas(){const t=this.operationResults&&this.operationResults.consumed_gas;return t||void 0}get storageDiff(){const t=this.operationResults&&this.operationResults.paid_storage_size_diff;return t||void 0}get storageSize(){const t=this.operationResults&&this.operationResults.storage_size;return t||void 0}get errors(){return this.operationResults&&this.operationResults.errors}contract(t,e){return S(this,void 0,void 0,function*(){if(!this.contractAddress)throw new Jd("No contract was originated in this operation");return yield this.confirmation(t,e),this.contractProvider.at(this.contractAddress)})}}class mg extends Fe{constructor(t,e,n,i,s,o){super(t,i,s,o),this.params=e,this.source=n,this.globalConstantHash=this.operationResults&&this.operationResults.global_address}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="register_global_constant"),e=t&&t.metadata&&t.metadata.operation_result;return e||void 0}get status(){const t=this.operationResults;return t?t.status:"unknown"}get registeredExpression(){return this.params.value}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get errors(){return this.operationResults&&this.operationResults.errors}}class yg extends Fe{constructor(t,e,n,i,s,o){super(t,i,s,o),this.params=e,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(e=>e.kind==="reveal");return t?[t]:[]}get status(){const e=this.operationResults[0];return e?e.metadata.operation_result.status:"unknown"}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get publicKey(){return this.params.public_key}sumProp(t,e){return t.reduce((n,i)=>e in i?Number(i[e])+n:n,0)}get consumedGas(){return String(this.sumProp(Ae({contents:this.operationResults}),"consumed_gas"))}get storageDiff(){return String(this.sumProp(Ae({contents:this.operationResults}),"paid_storage_size_diff"))}get storageSize(){return String(this.sumProp(Ae({contents:this.operationResults}),"storage_size"))}get errors(){return Hr({contents:this.operationResults})}}class bg extends Fe{constructor(t,e,n,i,s,o){super(t,i,s,o),this.params=e,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(e=>e.kind==="transaction");return t?[t]:[]}get status(){const e=this.operationResults[0];return e?e.metadata.operation_result.status:"unknown"}get amount(){return new G(this.params.amount)}get destination(){return this.params.destination}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}sumProp(t,e){return t.reduce((n,i)=>e in i?Number(i[e])+n:n,0)}get consumedGas(){return String(this.sumProp(Ae({contents:this.operationResults}),"consumed_gas"))}get storageDiff(){return String(this.sumProp(Ae({contents:this.operationResults}),"paid_storage_size_diff"))}get storageSize(){return String(this.sumProp(Ae({contents:this.operationResults}),"storage_size"))}get errors(){return Hr({contents:this.operationResults})}}class Eg{constructor(t,e,n,i,s,o=!0,c=!1){this.provider=t,this.address=e,this.parameterSchema=n,this.name=i,this.args=s,this.isMultipleEntrypoint=o,this.isAnonymous=c}validateArgs(t,e,n){const i=e.ExtractSignatures();if(!i.find(s=>s.length===t.length))throw new Uc(n,i,t)}get schema(){return this.isAnonymous?this.parameterSchema.ExtractSchema()[this.name]:this.parameterSchema.ExtractSchema()}getSignature(){if(this.isAnonymous){const t=this.parameterSchema.ExtractSignatures().find(e=>e[0]===this.name);if(t)return t.shift(),t}else{const t=this.parameterSchema.ExtractSignatures();return t.length==1?t[0]:t}}send(t={}){return this.provider instanceof fi?this.provider.transfer(this.toTransferParams(t)).send():this.provider.transfer(this.toTransferParams(t))}toTransferParams({fee:t,gasLimit:e,storageLimit:n,source:i,amount:s=0,mutez:o=!1}={}){return{to:this.address,amount:s,fee:t,mutez:o,source:i,gasLimit:e,storageLimit:n,parameter:{entrypoint:this.isMultipleEntrypoint?this.name:Nr,value:this.isAnonymous?this.parameterSchema.Encode(this.name,...this.args):this.parameterSchema.Encode(...this.args)}}}}class vg{constructor(t,e){this.walletProvider=t,this.context=e,this.operations=[]}withTransfer(t){if(pt(t.to)!==U.VALID)throw new bt(t.to);return this.operations.push(Object.assign({kind:I.TRANSACTION},t)),this}withContractCall(t){return this.withTransfer(t.toTransferParams())}withDelegation(t){if(t.delegate&&pt(t.delegate)!==U.VALID)throw new bt(t.delegate);return this.operations.push(Object.assign({kind:I.DELEGATION},t)),this}withOrigination(t){return this.operations.push(Object.assign({kind:I.ORIGINATION},t)),this}mapOperation(t){return S(this,void 0,void 0,function*(){switch(t.kind){case I.TRANSACTION:return this.walletProvider.mapTransferParamsToWalletParams(()=>S(this,void 0,void 0,function*(){return t}));case I.ORIGINATION:return this.walletProvider.mapOriginateParamsToWalletParams(()=>S(this,void 0,void 0,function*(){return this.context.parser.prepareCodeOrigination(Object.assign({},t))}));case I.DELEGATION:return this.walletProvider.mapDelegateParamsToWalletParams(()=>S(this,void 0,void 0,function*(){return t}));default:throw new nr(t.kind)}})}with(t){for(const e of t)switch(e.kind){case I.TRANSACTION:this.withTransfer(e);break;case I.ORIGINATION:this.withOrigination(e);break;case I.DELEGATION:this.withDelegation(e);break;default:throw new nr(e.kind)}return this}send(){return S(this,void 0,void 0,function*(){const t=[];for(const n of this.operations)t.push(yield this.mapOperation(n));const e=yield this.walletProvider.sendOperations(t);return this.context.operationFactory.createBatchOperation(e)})}}class fi{constructor(t){this.context=t,this.walletCommand=e=>({send:e})}get walletProvider(){return this.context.walletProvider}pkh({forceRefetch:t}={}){return S(this,void 0,void 0,function*(){return(!this._pkh||t)&&(this._pkh=yield this.walletProvider.getPKH()),this._pkh})}originate(t){return this.walletCommand(()=>S(this,void 0,void 0,function*(){const e=yield this.walletProvider.mapOriginateParamsToWalletParams(()=>this.context.parser.prepareCodeOrigination(Object.assign({},t))),n=yield this.walletProvider.sendOperations([e]);return this.context.operationFactory.createOriginationOperation(n)}))}setDelegate(t){if(t.delegate&&pt(t.delegate)!==U.VALID)throw new bt(t.delegate);return this.walletCommand(()=>S(this,void 0,void 0,function*(){const e=yield this.walletProvider.mapDelegateParamsToWalletParams(()=>S(this,void 0,void 0,function*(){return t})),n=yield this.walletProvider.sendOperations([e]);return this.context.operationFactory.createDelegationOperation(n)}))}registerDelegate(){return this.walletCommand(()=>S(this,void 0,void 0,function*(){const t=yield this.walletProvider.mapDelegateParamsToWalletParams(()=>S(this,void 0,void 0,function*(){return{delegate:yield this.pkh()}})),e=yield this.walletProvider.sendOperations([t]);return this.context.operationFactory.createDelegationOperation(e)}))}transfer(t){if(pt(t.to)!==U.VALID)throw new bt(t.to);return this.walletCommand(()=>S(this,void 0,void 0,function*(){const e=yield this.walletProvider.mapTransferParamsToWalletParams(()=>S(this,void 0,void 0,function*(){return t})),n=yield this.walletProvider.sendOperations([e]);return this.context.operationFactory.createTransactionOperation(n)}))}batch(t){const e=new vg(this.walletProvider,this.context);return Array.isArray(t)&&e.with(t),e}at(t,e=n=>n){return S(this,void 0,void 0,function*(){if(xr(t)!==U.VALID)throw new Pn(t);const n=this.context.withExtensions().rpc,i=this.context.withExtensions().readProvider,s=yield i.getScript(t,"head"),o=yield i.getEntrypoints(t),c=new Xc(t,s,this,this.context.contract,o,n,i);return e(c,this.context)})}}class Jc{constructor(t){this.context=t}getPKH(){return S(this,void 0,void 0,function*(){return this.context.signer.publicKeyHash()})}mapTransferParamsToWalletParams(t){return S(this,void 0,void 0,function*(){return Ki(yield t(),I.TRANSACTION)})}mapOriginateParamsToWalletParams(t){return S(this,void 0,void 0,function*(){return Ki(yield t(),I.ORIGINATION)})}mapDelegateParamsToWalletParams(t){return S(this,void 0,void 0,function*(){return Ki(yield t(),I.DELEGATION)})}sendOperations(t){return S(this,void 0,void 0,function*(){return(yield this.context.batch.batch(t).send()).hash})}}class wg{constructor(t,e,n,i,s="unit",o=!0,c=!1){this.provider=t,this.address=e,this.parameterSchema=n,this.name=i,this.args=s,this.isMultipleEntrypoint=o,this.isAnonymous=c}getSignature(){return this.isAnonymous?this.parameterSchema.ExtractSchema()[this.name]:this.parameterSchema.ExtractSchema()}send(t={}){return this.provider instanceof fi?this.provider.transfer(this.toTransferParams(t)).send():this.provider.transfer(this.toTransferParams(t))}toTransferParams({fee:t,gasLimit:e,storageLimit:n,source:i,amount:s=0,mutez:o=!1}={}){return{to:this.address,amount:s,fee:t,mutez:o,source:i,gasLimit:e,storageLimit:n,parameter:{entrypoint:this.isMultipleEntrypoint?this.name:Nr,value:this.isAnonymous?this.parameterSchema.EncodeObject({[this.name]:this.args}):this.parameterSchema.EncodeObject(this.args)}}}}const Ag=(r,t,e,n,i,s,o,c,l,m="0")=>({script:[{prim:"parameter",args:[{prim:"pair",args:[r,e]}]},{prim:"storage",args:[{prim:"option",args:[t]}]},{prim:"code",args:[[{prim:"CAR"},n,{prim:"SOME"},{prim:"NIL",args:[{prim:"operation"}]},{prim:"PAIR"}]]}],storage:{prim:"None"},input:{prim:"Pair",args:[i,s]},amount:m,balance:o,chain_id:c,source:l});class _g{constructor(t,e,n,i,s,o="Unit"){this._rpc=t,this._readProvider=e,this._contractAddress=n,this._smartContractViewSchema=i,this._contractStorageType=s,this._args=o}getSignature(){return{parameter:this._smartContractViewSchema.extractArgsSchema(),result:this._smartContractViewSchema.extractResultSchema()}}executeView(t){return S(this,void 0,void 0,function*(){this.verifyContextExecution(t);const e=(yield this._readProvider.getBalance(this._contractAddress,"head")).toString(),n=yield this._readProvider.getChainId(),i=yield this._readProvider.getStorage(this._contractAddress,"head");return this.executeViewAndDecodeResult(Ag(this._smartContractViewSchema.viewArgsType,this._smartContractViewSchema.viewReturnType,this._contractStorageType,this.adaptViewCodeToContext(this._smartContractViewSchema.instructions,t.viewCaller,e),this.transformArgsToMichelson(),i,e,n,t.source))})}verifyContextExecution(t){if(t.source&&pt(t.source)!==U.VALID)throw new Xo(`The source account who initialized the view execution is invalid: ${t.source}.`);if(!t.viewCaller||pt(t.viewCaller)!==U.VALID)throw new Xo(`The contract which is the caller of view is invalid: ${t.viewCaller}.`)}transformArgsToMichelson(){try{return this._smartContractViewSchema.encodeViewArgs(this._args)}catch(t){throw new Hd(this._smartContractViewSchema.viewName,this.getSignature(),this._args,t)}}adaptViewCodeToContext(t,e,n){const i={BALANCE:[{prim:"PUSH",args:[{prim:"mutez"},{int:n}]}],SENDER:[{prim:"PUSH",args:[{prim:"address"},{string:e}]}],SELF_ADDRESS:[{prim:"PUSH",args:[{prim:"address"},{string:this._contractAddress}]}],AMOUNT:[{prim:"PUSH",args:[{prim:"mutez"},{int:"0"}]}]};return t.forEach((s,o)=>{s.prim in i&&(t[o]=Object(i)[s.prim]),s.args&&s.args.length!==0?this.adaptViewCodeToContext(s.args,e,n):Array.isArray(s)&&this.adaptViewCodeToContext(s,e,n)}),t}executeViewAndDecodeResult(t){return S(this,void 0,void 0,function*(){let e;try{e=(yield this._rpc.runCode(t)).storage}catch(n){const i=Ud(n);throw i?new Jo(`The simulation of the on-chain view named ${this._smartContractViewSchema.viewName} failed with: ${JSON.stringify(i)}`,this._smartContractViewSchema.viewName,i,n):n}if(!e.args)throw new Jo(`View simulation failed with an invalid result: ${e}`,this._smartContractViewSchema.viewName);return this._smartContractViewSchema.decodeViewResult(e.args[0])})}}class Og{constructor(t,e){this.provider=t,this.contractAddress=e}createContractMethodFlatParams(t,e,n,i=!0,s=!1){return new Eg(this.provider,this.contractAddress,t,e,n,i,s)}createContractMethodObjectParam(t,e,n,i=!0,s=!1){return new wg(this.provider,this.contractAddress,t,e,n,i,s)}createContractViewObjectParam(t,e,n,i,s){return new _g(t,e,this.contractAddress,n,i,s)}}const Nr="default";class Rg{constructor(t,e,n,i,s,o,c){this.currentContract=t,this.name=e,this.callbackParametersSchema=n,this.parameterSchema=i,this.args=s,this.rpc=o,this.readProvider=c}read(t){return S(this,void 0,void 0,function*(){if(xr(t!=null?t:"")==U.VALID)throw new ua("Since version 12, the lambda view no longer depends on a lambda contract. The read method no longer accepts a contract address as a parameter.");if(t&&sa(t)!==U.VALID)throw new pu(t);const e=this.parameterSchema.Encode(...this.args),n=yield this.rpc.runView({contract:this.currentContract.address,entrypoint:this.name,input:e,chain_id:t||(yield this.readProvider.getChainId())});return this.callbackParametersSchema.Execute(n.data)})}}const Sg=(r,t,e)=>{const n=t.ExtractSignatures();if(!n.find(i=>i.length===r.length))throw new Uc(e,n,r)},Pg=r=>{let t=!1;if("prim"in r&&r.prim==="pair"&&r.args){const e=r.args[r.args.length-1];"prim"in e&&e.prim==="contract"&&(t=!0)}return t};class Xc{constructor(t,e,n,i,s,o,c){this.address=t,this.script=e,this.storageProvider=i,this.entrypoints=s,this.rpc=o,this.readProvider=c,this.methods={},this.methodsObject={},this.views={},this.contractViews={},this.contractMethodFactory=new Og(n,t),this.schema=Ht.fromRPCResponse({script:this.script}),this.parameterSchema=Ir.fromRPCResponse({script:this.script}),this.viewSchema=Rs.fromRPCResponse({script:this.script}),this.viewSchema.length!==0&&this._initializeOnChainViews(this,o,this.readProvider,this.viewSchema),this._initializeMethods(this,this.entrypoints.entrypoints,this.rpc,this.readProvider)}_initializeMethods(t,e,n,i){const s=this.parameterSchema,o=Object.keys(e);if(s.isMultipleEntryPoint)o.forEach(l=>{const m=new Ir(e[l]);if(this.methods[l]=function(...y){return t.contractMethodFactory.createContractMethodFlatParams(m,l,y)},this.methodsObject[l]=function(y){return t.contractMethodFactory.createContractMethodObjectParam(m,l,y)},Pg(e[l])){const y=function(...v){const P=e[l].args[0],T=new Ir(P),D=e[l].args[1].args[0],W=new Ir(D);return Sg(v,T,l),new Rg(t,l,W,T,v,n,i)};this.views[l]=y}}),Object.keys(s.ExtractSchema()).filter(l=>Object.keys(e).indexOf(l)===-1).forEach(l=>{this.methods[l]=function(...m){return t.contractMethodFactory.createContractMethodFlatParams(s,l,m,!1,!0)},this.methodsObject[l]=function(m){return t.contractMethodFactory.createContractMethodObjectParam(s,l,m,!1,!0)}});else{const c=this.parameterSchema;this.methods[Nr]=function(...l){return t.contractMethodFactory.createContractMethodFlatParams(c,Nr,l,!1)},this.methodsObject[Nr]=function(l){return t.contractMethodFactory.createContractMethodObjectParam(c,Nr,l,!1)}}}_initializeOnChainViews(t,e,n,i){const s=this.schema.val;i.forEach(o=>{this.contractViews[o.viewName]=function(c){return t.contractMethodFactory.createContractViewObjectParam(e,n,o,s,c)}})}storage(){return this.storageProvider.getStorage(this.address,this.schema)}bigMap(t){return this.storageProvider.getBigMapKey(this.address,t,this.schema)}}class Tg{constructor(t,e,n){this.id=t,this.schema=e,this.provider=n}get(t,e){return S(this,void 0,void 0,function*(){try{return yield this.provider.getBigMapKeyByID(this.id.toString(),t,this.schema,e)}catch(n){if(n instanceof si&&n.status===Yr.NOT_FOUND)return;throw n}})}getMultipleValues(t,e,n=5){return S(this,void 0,void 0,function*(){return this.provider.getBigMapKeysByID(this.id.toString(),t,this.schema,e,n)})}toJSON(){return this.id.toString()}toString(){return this.id.toString()}}class Ig{constructor(t,e){this.id=t,this.provider=e}getSaplingDiff(t){return S(this,void 0,void 0,function*(){return this.provider.getSaplingDiffByID(this.id.toString(),t)})}getId(){return this.id.toString()}}const ra=r=>({big_map:(t,e)=>{if(!t||!("int"in t)||t.int===void 0)return{};{const n=new Ht(e);return new Tg(new G(t.int),n,r)}},sapling_state:t=>!t||!("int"in t)||t.int===void 0?{}:new Ig(new G(t.int),r)});class Ng extends Fe{constructor(t,e,n,i,s,o){super(t,i,s,o),this.params=e,this.source=n,this.originatedRollup=this.operationResults&&this.operationResults.originated_rollup}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="tx_rollup_origination"),e=t&&t.metadata&&t.metadata.operation_result;return e||void 0}get status(){const t=this.operationResults;return t?t.status:"unknown"}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get errors(){return this.operationResults&&this.operationResults.errors}}class xg extends Fe{constructor(t,e,n,i,s,o){super(t,i,s,o),this.params=e,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="tx_rollup_submit_batch"),e=t&&t.metadata&&t.metadata.operation_result;return e||void 0}get status(){const t=this.operationResults;return t?t.status:"unknown"}get content(){return this.params.content}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get errors(){return this.operationResults&&this.operationResults.errors}}class Lg extends hi{constructor(t,e){super(t),this.estimator=e,this.contractProviderTypeSymbol=Symbol.for("taquito--provider-type-symbol")}getStorage(t,e){return S(this,void 0,void 0,function*(){if(xr(t)!==U.VALID)throw new Pn(t);const n=yield this.context.readProvider.getScript(t,"head");e||(e=n);let i;return Ht.isSchema(e)?i=e:i=Ht.fromRPCResponse({script:e}),i.Execute(n.storage,ra(this))})}getBigMapKey(t,e,n){return S(this,void 0,void 0,function*(){if(xr(t)!==U.VALID)throw new Pn(t);n||(n=(yield this.rpc.getContract(t)).script);let i;Ht.isSchema(n)?i=n:i=Ht.fromRPCResponse({script:n});const s=i.EncodeBigMapKey(e),o=yield this.rpc.getBigMapKey(t,s);return i.ExecuteOnBigMapValue(o)})}getBigMapKeyByID(t,e,n,i){return S(this,void 0,void 0,function*(){const{key:s,type:o}=n.EncodeBigMapKey(e),{packed:c}=yield this.context.packer.packData({data:s,type:o}),l=fu(c),m=i?yield this.context.readProvider.getBigMapValue({id:t.toString(),expr:l},i):yield this.context.readProvider.getBigMapValue({id:t.toString(),expr:l},"head");return n.ExecuteOnBigMapValue(m,ra(this))})}getBigMapKeysByID(t,e,n,i,s=5){return S(this,void 0,void 0,function*(){const o=yield this.getBlockForRequest(e,i),c=new Vt;let l=0,m=[];for(;l<e.length;){const v=e.slice(l,l+s).map(P=>this.getBigMapValueOrUndefined(P,t,n,o));m=[...m,...yield Promise.all(v)],l+=s}for(let y=0;y<m.length;y++)c.set(e[y],m[y]);return c})}getBlockForRequest(t,e){return S(this,void 0,void 0,function*(){return t.length===1||typeof e<"u"?e:yield this.context.readProvider.getBlockLevel("head")})}getBigMapValueOrUndefined(t,e,n,i){return S(this,void 0,void 0,function*(){try{return yield this.getBigMapKeyByID(e,t,n,i)}catch(s){if(s instanceof si&&s.status===Yr.NOT_FOUND)return;throw s}})}getSaplingDiffByID(t,e){return S(this,void 0,void 0,function*(){return e?yield this.context.readProvider.getSaplingDiffById({id:t.toString()},e):yield this.context.readProvider.getSaplingDiffById({id:t.toString()},"head")})}addRevealOperationIfNeeded(t,e){return S(this,void 0,void 0,function*(){if(os(t)){const n=[t],i=yield this.signer.publicKey(),s=yield this.estimator.reveal();if(s){const o={kind:I.REVEAL},c=yield this.estimate(o,()=>S(this,void 0,void 0,function*(){return s}));return n.unshift(yield tn(Object.assign({},c),e,i)),n}}return t})}originate(t){return S(this,void 0,void 0,function*(){const e=yield this.estimate(t,this.estimator.originate.bind(this.estimator)),n=yield this.signer.publicKeyHash(),i=yield Wn(yield this.context.parser.prepareCodeOrigination(Object.assign(Object.assign({},t),e))),s=yield this.addRevealOperationIfNeeded(i,n),o=yield this.prepareOperation({operation:s,source:n}),c=yield this.forge(o),{hash:l,context:m,forgedBytes:y,opResponse:v}=yield this.signAndInject(c);return new gg(l,i,y,v,m,this)})}setDelegate(t){return S(this,void 0,void 0,function*(){if(t.source&&pt(t.source)!==U.VALID)throw new bt(t.source);if(t.delegate&&pt(t.delegate)!==U.VALID)throw new bt(t.delegate);if(/kt1/i.test(t.source))throw new Vd(t.source);const e=yield this.estimate(t,this.estimator.setDelegate.bind(this.estimator)),n=yield this.signer.publicKeyHash(),i=yield Jn(Object.assign(Object.assign({},t),e)),s=t.source||n,o=yield this.addRevealOperationIfNeeded(i,n),c=yield this.prepareOperation({operation:o,source:s}),l=yield this.forge(c),{hash:m,context:y,forgedBytes:v,opResponse:P}=yield this.signAndInject(l);return new ea(m,i,s,v,P,y)})}registerDelegate(t){return S(this,void 0,void 0,function*(){const e=yield this.estimate(t,this.estimator.registerDelegate.bind(this.estimator)),n=yield this.signer.publicKeyHash(),i=yield Gc(Object.assign(Object.assign({},t),e),n),s=yield this.addRevealOperationIfNeeded(i,n),o=yield this.prepareOperation({operation:s}),c=yield this.forge(o),{hash:l,context:m,forgedBytes:y,opResponse:v}=yield this.signAndInject(c);return new ea(l,i,n,y,v,m)})}transfer(t){return S(this,void 0,void 0,function*(){if(pt(t.to)!==U.VALID)throw new bt(t.to);if(t.source&&pt(t.source)!==U.VALID)throw new bt(t.source);const e=yield this.signer.publicKeyHash(),n=yield this.estimate(t,this.estimator.transfer.bind(this.estimator)),i=yield Yn(Object.assign(Object.assign({},t),n)),s=t.source||e,o=yield this.addRevealOperationIfNeeded(i,e),c=yield this.prepareOperation({operation:o,source:t.source}),l=yield this.forge(c),{hash:m,context:y,forgedBytes:v,opResponse:P}=yield this.signAndInject(l);return new bg(m,i,s,v,P,y)})}reveal(t){return S(this,void 0,void 0,function*(){const e=yield this.signer.publicKeyHash(),n=yield this.estimator.reveal(t);if(n){const i=yield this.estimate(t,()=>S(this,void 0,void 0,function*(){return n})),s=yield tn(Object.assign({},i),e,yield this.signer.publicKey()),o=yield this.prepareOperation({operation:s,source:e}),c=yield this.forge(o),{hash:l,context:m,forgedBytes:y,opResponse:v}=yield this.signAndInject(c);return new yg(l,s,e,y,v,m)}else throw new Gd(`The publicKeyHash '${e}' has already been revealed.`)})}registerGlobalConstant(t){return S(this,void 0,void 0,function*(){const e=yield this.signer.publicKeyHash(),n=yield this.estimate(t,this.estimator.registerGlobalConstant.bind(this.estimator)),i=yield Xn(Object.assign(Object.assign({},t),n)),s=yield this.addRevealOperationIfNeeded(i,e),o=yield this.prepareOperation({operation:s,source:e}),c=yield this.forge(o),{hash:l,context:m,forgedBytes:y,opResponse:v}=yield this.signAndInject(c);return new mg(l,i,e,y,v,m)})}txRollupOriginate(t){return S(this,void 0,void 0,function*(){const e=yield this.signer.publicKeyHash(),n=yield this.estimate(t||{},this.estimator.txRollupOriginate.bind(this.estimator)),i=yield Zn(Object.assign(Object.assign({},t),n)),s=yield this.addRevealOperationIfNeeded(i,e),o=yield this.prepareOperation({operation:s,source:e}),c=yield this.forge(o),{hash:l,context:m,forgedBytes:y,opResponse:v}=yield this.signAndInject(c);return new Ng(l,i,e,y,v,m)})}txRollupSubmitBatch(t){return S(this,void 0,void 0,function*(){const e=yield this.signer.publicKeyHash(),n=yield this.estimate(t,this.estimator.txRollupSubmitBatch.bind(this.estimator)),i=yield Qn(Object.assign(Object.assign({},t),n)),s=yield this.addRevealOperationIfNeeded(i,e),o=yield this.prepareOperation({operation:s,source:e}),c=yield this.forge(o),{hash:l,context:m,forgedBytes:y,opResponse:v}=yield this.signAndInject(c);return new xg(l,i,e,y,v,m)})}at(t,e=n=>n){return S(this,void 0,void 0,function*(){if(xr(t)!==U.VALID)throw new Pn(t);const n=this.context.withExtensions().rpc,i=this.context.withExtensions().readProvider,s=yield i.getScript(t,"head"),o=yield i.getEntrypoints(t),c=new Xc(t,s,this,this,o,n,i);return e(c,this.context)})}batch(t){const e=new Yc(this.context,this.estimator);return Array.isArray(t)&&e.with(t),e}}class Cg{constructor(t){this.context=t}getNextProto(){return S(this,void 0,void 0,function*(){if(!this.context.proto){const t=yield this.context.readProvider.getNextProtocol("head");this.context.proto=t}return this.context.proto})}parseScript(t){return S(this,void 0,void 0,function*(){return new yr({protocol:yield this.getNextProto()}).parseScript(t)})}parseMichelineExpression(t){return S(this,void 0,void 0,function*(){return new yr({protocol:yield this.getNextProto()}).parseMichelineExpression(t)})}parseJSON(t){return S(this,void 0,void 0,function*(){return new yr({protocol:yield this.getNextProto()}).parseJSON(t)})}prepareCodeOrigination(t){return S(this,void 0,void 0,function*(){const e=t;if(e.code=yield this.formatCodeParam(t.code),t.init)e.init=yield this.formatInitParam(t.init);else if(t.storage){const n=e.code.find(o=>"prim"in o&&o.prim==="storage");if(!(n!=null&&n.args))throw new zn("The storage section is missing from the script",t.code);const i=new Ht(n.args[0]),s=yield this.findGlobalConstantsHashAndValue(i);if(Object.keys(s).length!==0){const c=new yr({expandGlobalConstant:s}).parseJSON(n.args[0]),l=new Ht(c);e.init=l.Encode(t.storage)}else e.init=i.Encode(t.storage);delete e.storage}return e})}formatCodeParam(t){return S(this,void 0,void 0,function*(){let e;if(typeof t=="string"){const n=yield this.parseScript(t);if(n===null)throw new zn("Invalid code parameter",t);e=n}else{const n=yield this.parseJSON(t),i=["parameter","storage","code"];e=n.sort((s,o)=>i.indexOf(s.prim)-i.indexOf(o.prim))}return e})}formatInitParam(t){return S(this,void 0,void 0,function*(){let e;if(typeof t=="string"){const n=yield this.parseMichelineExpression(t);if(n===null)throw new Fc("Invalid init parameter",t);e=n}else e=yield this.parseJSON(t);return e})}findGlobalConstantsHashAndValue(t){return S(this,void 0,void 0,function*(){const e=t.findToken("constant"),n={};if(e.length!==0)for(const i of e){const s=i.tokenVal.args;if(s){const o=s[0];if(o.string){const c=o.string,l=yield this.context.globalConstantsProvider.getGlobalConstantByHash(c);Object.assign(n,{[c]:l})}}}return n})}}class Zc{constructor(t){this.context=t}packData(t){return S(this,void 0,void 0,function*(){return this.context.rpc.packData(t)})}}class Mg extends Error{constructor(){super("No globalThis constants provider has been configured. Please configure one by calling setGlobalConstantsProvider({globalConstantsProvider}) on your TezosToolkit instance."),this.name="UnconfiguredGlobalConstantsProviderError"}}class Qc{getGlobalConstantByHash(t){return S(this,void 0,void 0,function*(){throw new Mg})}}class tu{constructor(t){this.context=t}getBalance(t,e){return S(this,void 0,void 0,function*(){return this.context.rpc.getBalance(t,{block:String(e)})})}getDelegate(t,e){return S(this,void 0,void 0,function*(){return this.context.rpc.getDelegate(t,{block:String(e)})})}getNextProtocol(t){return S(this,void 0,void 0,function*(){return(yield this.context.rpc.getProtocols({block:String(t)})).next_protocol})}getProtocolConstants(t){return S(this,void 0,void 0,function*(){const{time_between_blocks:e,minimal_block_delay:n,hard_gas_limit_per_operation:i,hard_gas_limit_per_block:s,hard_storage_limit_per_operation:o,cost_per_byte:c,tx_rollup_origination_size:l}=yield this.context.rpc.getConstants({block:String(t)});return{time_between_blocks:e,minimal_block_delay:n,hard_gas_limit_per_operation:i,hard_gas_limit_per_block:s,hard_storage_limit_per_operation:o,cost_per_byte:c,tx_rollup_origination_size:l}})}getScript(t,e){return S(this,void 0,void 0,function*(){const{script:n}=yield this.context.rpc.getContract(t,{block:String(e)});return n})}getStorage(t,e){return S(this,void 0,void 0,function*(){return this.context.rpc.getStorage(t,{block:String(e)})})}getBlockHash(t){return S(this,void 0,void 0,function*(){const{hash:e}=yield this.context.rpc.getBlockHeader({block:String(t)});return e})}getBlockLevel(t){return S(this,void 0,void 0,function*(){const{level:e}=yield this.context.rpc.getBlockHeader({block:String(t)});return e})}getCounter(t,e){return S(this,void 0,void 0,function*(){const{counter:n}=yield this.context.rpc.getContract(t,{block:String(e)});return n||"0"})}getBlockTimestamp(t){return S(this,void 0,void 0,function*(){const{timestamp:e}=yield this.context.rpc.getBlockHeader({block:String(t)});return e})}getBigMapValue(t,e){return S(this,void 0,void 0,function*(){return this.context.rpc.getBigMapExpr(t.id,t.expr,{block:String(e)})})}getSaplingDiffById(t,e){return S(this,void 0,void 0,function*(){return this.context.rpc.getSaplingDiffById(t.id,{block:String(e)})})}getEntrypoints(t){return S(this,void 0,void 0,function*(){return this.context.rpc.getEntrypoints(t)})}getChainId(){return S(this,void 0,void 0,function*(){return this.context.rpc.getChainId()})}isAccountRevealed(t,e){return S(this,void 0,void 0,function*(){const n=yield this.context.rpc.getManagerKey(t,{block:String(e)});return n&&typeof n=="object"?!!n.key:!!n})}getBlock(t){return S(this,void 0,void 0,function*(){return this.context.rpc.getBlock({block:String(t)})})}getLiveBlocks(t){return this.context.rpc.getLiveBlocks({block:String(t)})}}const Bg=(r,t)=>r.hash===t.opHash,Dg=(r,t)=>{switch(r.kind){case"endorsement":return"metadata"in r&&r.metadata.delegate===t.source;case"activate_account":return"metadata"in r&&r.pkh===t.source;default:return"source"in r&&r.source===t.source}},$g=(r,t)=>"kind"in r&&r.kind===t.kind,kg=(r,t)=>{switch(r.kind){case"delegation":return r.delegate===t.destination;case"origination":if("metadata"in r&&"operation_result"in r.metadata&&"originated_contracts"in r.metadata.operation_result&&Array.isArray(r.metadata.operation_result.originated_contracts))return r.metadata.operation_result.originated_contracts.some(e=>e===t.destination);break;case"transaction":return r.destination===t.destination;default:return!1}},jg=(r,t)=>"opHash"in t?Bg(r,t):"source"in t?Dg(r,t):"kind"in t?$g(r,t):"destination"in t?kg(r,t):!1,Vg=(r,t)=>{if(Array.isArray(t.and))return t.and.every(e=>as(r,e));if(Array.isArray(t.or))return t.or.some(e=>as(r,e));throw new Zd("Filter expression must contain either and/or property")},as=(r,t)=>{const e=[];return Array.isArray(t)?e.push(...t):e.push(t),e.every(n=>"and"in n||"or"in n?Vg(r,n):jg(r,n))};class na extends Error{constructor(t){super(t),this.message=t,this.name="UnsupportedEventError"}}class qi{constructor(t,e=!1,n=Fa()){this.shouldRetry=e,this.operatorFunction=n,this.errorListeners=[],this.messageListeners=[],this.closeListeners=[],this.completed$=new Br,t.pipe(Dh(this.completed$),Zi(i=>{this.call(this.messageListeners,i)},i=>{this.call(this.errorListeners,i)},()=>{this.call(this.closeListeners)}),this.shouldRetry?n:Zi(),Os(()=>sh)).subscribe()}call(t,e){for(const n of t)try{n(e)}catch(i){console.error(i)}}remove(t,e){const n=t.indexOf(e);n!==-1&&t.splice(n,1)}on(t,e){switch(t){case"data":this.messageListeners.push(e);break;case"error":this.errorListeners.push(e);break;case"close":this.closeListeners.push(e);break;default:throw new na(`Trying to register on an unsupported event: ${t}`)}}off(t,e){switch(t){case"data":this.remove(this.messageListeners,e);break;case"error":this.remove(this.errorListeners,e);break;case"close":this.remove(this.closeListeners,e);break;default:throw new na(`Trying to unregister on an unsupported event: ${t}`)}}close(){this.completed$.next()}}const Hg={shouldObservableSubscriptionRetry:!1,observableSubscriptionRetryFunction:Fa()},Ug=r=>Ar(r.rpc.getBlock()).pipe(ke()),Fg=r=>Ha(t=>new yt(e=>{for(const n of t.operations)for(const i of n)for(const s of i.contents)as(Object.assign({hash:i.hash},s),r)&&e.next(Object.assign({hash:i.hash},s));e.complete()}));class cs{constructor(t,e={}){this.context=t,this._config$=new Na(Object.assign(Object.assign({},Hg),e)),this.timer$=this._config$.pipe(So("pollingIntervalMilliseconds"),Er(n=>n?Oo(0,n):Ar(this.getConfirmationPollingInterval()).pipe(Er(i=>Oo(0,i))))),this.newBlock$=this.timer$.pipe(Er(()=>Ug(this.context)),Eh("hash"),Ih(),Ia())}get config(){return this._config$.getValue()}getConfirmationPollingInterval(){return S(this,void 0,void 0,function*(){if(!this.config.pollingIntervalMilliseconds)try{const n=yield this.context.readProvider.getProtocolConstants("head"),s=(n.minimal_block_delay?n.minimal_block_delay.multipliedBy(1e3):n.time_between_blocks?n.time_between_blocks[0].multipliedBy(1e3):new G(5e3)).dividedBy(3);this.config.pollingIntervalMilliseconds=s.toNumber()===0?1e3:s.toNumber()}catch{return 5e3}return this.config.pollingIntervalMilliseconds})}subscribeBlock(t){return new qi(this.newBlock$,this.config.shouldObservableSubscriptionRetry,this.config.observableSubscriptionRetryFunction)}subscribe(t){return new qi(this.newBlock$.pipe(So("hash")),this.config.shouldObservableSubscriptionRetry,this.config.observableSubscriptionRetryFunction)}subscribeOperation(t){return new qi(this.newBlock$.pipe(Fg(t)),this.config.shouldObservableSubscriptionRetry,this.config.observableSubscriptionRetryFunction)}}class eu{constructor(t){this.context=t}getNextProto(){return S(this,void 0,void 0,function*(){if(!this.context.proto){const t=yield this.context.readProvider.getNextProtocol("head");this.context.proto=t}return this.context.proto})}forge({branch:t,contents:e}){return S(this,void 0,void 0,function*(){return new Vc(yield this.getNextProto()).forge({branch:t,contents:e})})}}const Gg={defaultConfirmationCount:1,confirmationPollingTimeoutSecond:180};class ti{constructor(t,e=new ss,n,i=new Na(Object.assign({},Gg)),s,o,c,l,m,y,v,P){this._rpc=t,this._signer=e,this._proto=n,this._config=i,this.providerDecorator=[],this.tz=new lg(this),this.estimate=new dg(this),this.contract=new Lg(this,this.estimate),this.batch=new tg(this,this.estimate),this.wallet=new fi(this),this.withExtensions=()=>{let T=this.clone();return this.providerDecorator.forEach(D=>{T=D(T)}),T},typeof this._rpc=="string"?this._rpcClient=new Nn(this._rpc):this._rpcClient=this._rpc,this._forger=s||new eu(this),this._injector=o||new $d(this),this.operationFactory=new ug(this),this._walletProvider=l||new Jc(this),this._parser=m||new Cg(this),this._packer=c||new Zc(this),this._globalConstantsProvider=y||new Qc,this._readProvider=v||new tu(this),this._stream=P||new cs(this)}get config(){return this._config.getValue()}set config(t){this._config.next(Object.assign({},t))}setPartialConfig(t){this._config.next(Object.assign(Object.assign({},this._config.getValue()),t))}get rpc(){return this._rpcClient}set rpc(t){this._rpcClient=t}get injector(){return this._injector}set injector(t){this._injector=t}get forger(){return this._forger}set forger(t){this._forger=t}get signer(){return this._signer}set signer(t){this._signer=t}get walletProvider(){return this._walletProvider}set walletProvider(t){this._walletProvider=t}set proto(t){this._proto=t}get proto(){return this._proto}get parser(){return this._parser}set parser(t){this._parser=t}get packer(){return this._packer}set packer(t){this._packer=t}get globalConstantsProvider(){return this._globalConstantsProvider}set globalConstantsProvider(t){this._globalConstantsProvider=t}get readProvider(){return this._readProvider}set readProvider(t){this._readProvider=t}get stream(){return this._stream}set stream(t){this._stream=t}isAnyProtocolActive(t=[]){return S(this,void 0,void 0,function*(){if(this._proto)return t.includes(this._proto);{const e=yield this.readProvider.getNextProtocol("head");return t.includes(e)}})}isAnySignerConfigured(){return!(this.signer instanceof ss)}clone(){return new ti(this.rpc,this.signer,this.proto,this._config,this.forger,this._injector,this.packer,this._walletProvider,this._parser,this._globalConstantsProvider,this._readProvider,this._stream)}registerProviderDecorator(t){this.providerDecorator.push(t)}}const Kg={commitHash:"6d90b3d5e616a6e9b9ad9dd8453b5068e7396fff",version:"13.0.1"};class Yg{constructor(t){this.context=t}forge({branch:t,contents:e}){return this.context.rpc.forgeOperations({branch:t,contents:e})}}class Jg{packData(t){return S(this,void 0,void 0,function*(){const{bytes:e}=gp(t.data,t.type);return{packed:e}})}}class Xg{constructor(t){this._rpc=t,this._options={},this.format=Bs,typeof this._rpc=="string"?this._rpcClient=new Nn(this._rpc):this._rpcClient=this._rpc,this._context=new ti(t),this._wallet=new fi(this._context),this.setProvider({rpc:this._rpcClient}),this.batch=this._context.batch.batch.bind(this._context.batch)}setProvider({rpc:t,stream:e,signer:n,protocol:i,config:s,forger:o,wallet:c,packer:l,globalConstantsProvider:m,readProvider:y}){this.setRpcProvider(t),this.setStreamProvider(e),this.setSignerProvider(n),this.setForgerProvider(o),this.setWalletProvider(c),this.setPackerProvider(l),this.setGlobalConstantsProvider(m),this.setReadProvider(y),this._context.proto=i,s&&this._context.setPartialConfig(s)}setSignerProvider(t){!this._options.signer&&typeof t>"u"?(this._context.signer=new ss,this._options.signer=t):typeof t<"u"&&(this._context.signer=t,this._options.signer=t)}setRpcProvider(t){typeof t=="string"?this._rpcClient=new Nn(t):t===void 0||(this._rpcClient=t),this._options.rpc=this._rpcClient,this._context.rpc=this._rpcClient}setForgerProvider(t){if(typeof t<"u")this._options.forger=t,this._context.forger=t;else if(this._options.forger===void 0){const e=this.getFactory(eu)();this._options.forger=e,this._context.forger=e}}setStreamProvider(t){if(typeof t=="string"){const e=new cs(new ti(new Nn(t)));this._options.stream=e,this._context.stream=e}else if(typeof t<"u")this._options.stream=t,this._context.stream=t;else if(this._options.stream===void 0){const e=this.getFactory(cs)();this._options.stream=e,this._context.stream=e}}setWalletProvider(t){if(!this._options.wallet&&typeof t>"u"){const e=this.getFactory(Jc)();this._options.wallet=e,this._context.walletProvider=e}else typeof t<"u"&&(this._options.wallet=t,this._context.walletProvider=t)}setPackerProvider(t){if(!this._options.packer&&typeof t>"u"){const e=this.getFactory(Zc)();this._context.packer=e,this._options.packer=e}else typeof t<"u"&&(this._context.packer=t,this._options.packer=t)}setGlobalConstantsProvider(t){if(!this._options.globalConstantsProvider&&typeof t>"u"){const e=new Qc;this._context.globalConstantsProvider=e,this._options.globalConstantsProvider=e}else typeof t<"u"&&(this._context.globalConstantsProvider=t,this._options.globalConstantsProvider=t)}setReadProvider(t){const e=typeof t>"u"?this.getFactory(tu)():t;this._options.readProvider=e,this._context.readProvider=e}get tz(){return this._context.tz}get contract(){return this._context.contract}get wallet(){return this._wallet}get operation(){return this._context.operationFactory}get estimate(){return this._context.estimate}get stream(){return this._context.stream}get rpc(){return this._context.rpc}get signer(){return this._context.signer}get globalConstants(){return this._context.globalConstantsProvider}addExtension(t){Array.isArray(t)?t.forEach(e=>e.configureContext(this._context)):t.configureContext(this._context)}getFactory(t){return(...e)=>new t(this._context,...e)}getVersionInfo(){return Kg}}export{hl as H,Jg as M,Yg as R,Ht as S,Xg as T,Wn as a,Jn as b,Yn as c,Wg as l};
